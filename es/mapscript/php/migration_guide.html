
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta charset="utf-8" />
    <title>PHP MapScript Migration Guide &#8212; MapServer 7.4.3 documentation</title>
    <link rel="stylesheet" href="../../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/translations.js"></script>
    
    <link rel="shortcut icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="Sobre este documento" href="../../about.html" />
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="By Example" href="by_example.html" />
    <link rel="prev" title="PHP MapScript API" href="phpmapscript.html" /> 
  </head><body>

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../../mapscript/php/migration_guide.html"><img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../../ar/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../../de/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../../el/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        <img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" width="18px" height="13px"/>
        
          
            <a href="../../../fr/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
          
        
        
          
            <a href="../../../id/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../../it/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        
          
            <a href="../../../ja/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
          
        
        
          
            <a href="../../../nl_NL/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
          
        
        
          
            <a href="../../../pl/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../../ru/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../../sq/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../../tr/mapscript/php/migration_guide.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="by_example.html" title="By Example"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="phpmapscript.html" title="PHP MapScript API"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../documentation.html" >MapServer 7.4.3 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >MapScript</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">PHP MapScript</a> &#187;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="php-mapscript-migration-guide">
<span id="php-migration-guide"></span><h1><a class="toc-backref" href="#table-of-contents">PHP MapScript Migration Guide</a><a class="headerlink" href="#php-mapscript-migration-guide" title="Enlazar permanentemente con este título">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Alan Boudreault</p>
</dd>
<dt class="field-even">Contact</dt>
<dd class="field-even"><p>aboudreault at mapgears.com</p>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Jeff McKenna</p>
</dd>
<dt class="field-even">Contact</dt>
<dd class="field-even"><p>jmckenna at gatewaygeomatics.com</p>
</dd>
<dt class="field-odd">Last updated</dt>
<dd class="field-odd"><p>2019-05-25</p>
</dd>
</dl>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#php-mapscript-migration-guide" id="id1">PHP MapScript Migration Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#migrating-to-7-4-s-new-swig-api-and-php-7" id="id3">Migrating to 7.4’s new SWIG API and PHP 7</a></p></li>
<li><p><a class="reference internal" href="#migrating-5-6-to-6-0" id="id4">Migrating 5.6 to 6.0</a></p>
<ul>
<li><p><a class="reference internal" href="#php-version-required" id="id5">PHP Version Required</a></p></li>
<li><p><a class="reference internal" href="#error-reporting" id="id6">Error Reporting</a></p></li>
<li><p><a class="reference internal" href="#manipulating-objects" id="id7">Manipulating Objects</a></p></li>
<li><p><a class="reference internal" href="#class-properties" id="id8">Class Properties</a></p></li>
<li><p><a class="reference internal" href="#class-methods" id="id9">Class Methods</a></p></li>
<li><p><a class="reference internal" href="#layerobj" id="id10">layerObj</a></p></li>
<li><p><a class="reference internal" href="#mapobj" id="id11">mapObj</a></p></li>
<li><p><a class="reference internal" href="#referencemapobj" id="id12">referenceMapObj</a></p></li>
<li><p><a class="reference internal" href="#shapefileobj" id="id13">shapeFileObj</a></p></li>
<li><p><a class="reference internal" href="#labelcacheobj" id="id14">labelCacheObj</a></p></li>
<li><p><a class="reference internal" href="#methods-that-now-return-ms-success-ms-failure" id="id15">Methods that now return MS_SUCCESS/MS_FAILURE</a></p></li>
<li><p><a class="reference internal" href="#methods-that-now-return-null-on-failure" id="id16">Methods that now return NULL on failure</a></p></li>
<li><p><a class="reference internal" href="#methods-that-now-return-an-empty-array" id="id17">Methods that now return an empty array</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#table-of-contents">Introduction</a><a class="headerlink" href="#introduction" title="Enlazar permanentemente con este título">¶</a></h2>
<p>This document describes the changes that must be made to PHP MapScript
applications when migrating from one MapServer version to another (i.e. backwards
incompatibilities), as well as information on some of the new features.</p>
</div>
<div class="section" id="migrating-to-7-4-s-new-swig-api-and-php-7">
<h2><a class="toc-backref" href="#table-of-contents">Migrating to 7.4’s new SWIG API and PHP 7</a><a class="headerlink" href="#migrating-to-7-4-s-new-swig-api-and-php-7" title="Enlazar permanentemente con este título">¶</a></h2>
<p>As of the MapServer 7.4.0 release, users are recommended to switch to
MapServer’s new <a class="reference internal" href="../mapscript.html#swig"><span class="std std-ref">SWIG</span></a> API support of PHP 7+ (reason for
recommendation: as we saw with the breaking PHP 7 changes,
managing PHP through SWIG will be easier on the MapServer maintainers in
the long run).  Some important SWIG notes:</p>
<ul>
<li><p>you will require at least <a class="reference external" href="http://www.swig.org/download.html">SWIG-3.0.11</a>
(but 4.0.0 is recommended).</p></li>
<li><p>if you notice any missing functions that were available in the old native PHP MapScript API,
first please check the <a class="reference internal" href="../mapscript.html#swig"><span class="std std-ref">SWIG API</span></a> reference document for an alternative function to use,
and if there is nothing similar available then <a class="reference external" href="https://github.com/mapserver/mapserver/issues">file a ticket</a>
for each function that you require.</p></li>
<li><p>all of your PHP scripts (that leverage MapServer objects and functions) must now always
first include the generated <code class="docutils literal notranslate"><span class="pre">mapscript.php</span></code> file containing MapServer constants:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">required</span> <span class="n">SWIG</span> <span class="n">include</span> <span class="p">(</span><span class="n">contains</span> <span class="n">MapServer</span> <span class="n">constants</span> <span class="k">for</span> <span class="n">PHP7</span><span class="p">)</span>
<span class="n">include</span><span class="p">(</span><span class="s2">&quot;C:/ms4w/apps/phpmapscriptng-swig/include/mapscript.php&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>take note of the change in how to declare your new objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// open map
$oMap = new mapObj(&quot;C:/ms4w/apps/phpmapscriptng-swig/sample.map&quot;);
</pre></div>
</div>
<p>instead of the former way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// open map
$oMap = ms_newMapObj(&quot;C:/ms4w/apps/phpmapscript/sample.map&quot;);
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="migrating-5-6-to-6-0">
<h2><a class="toc-backref" href="#table-of-contents">Migrating 5.6 to 6.0</a><a class="headerlink" href="#migrating-5-6-to-6-0" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="php-version-required">
<h3><a class="toc-backref" href="#table-of-contents">PHP Version Required</a><a class="headerlink" href="#php-version-required" title="Enlazar permanentemente con este título">¶</a></h3>
<p>PHP 5.2.0 or more recent is required. The support for earlier versions
has been dropped.</p>
</div>
<div class="section" id="error-reporting">
<h3><a class="toc-backref" href="#table-of-contents">Error Reporting</a><a class="headerlink" href="#error-reporting" title="Enlazar permanentemente con este título">¶</a></h3>
<p>PHP MapScript now uses exceptions for error reports. All errors are
catchable. There are no more fatal errors reported via the standard
uncatchable PHP system (Only Warnings).</p>
</div>
<div class="section" id="manipulating-objects">
<h3><a class="toc-backref" href="#table-of-contents">Manipulating Objects</a><a class="headerlink" href="#manipulating-objects" title="Enlazar permanentemente con este título">¶</a></h3>
<ul class="simple">
<li><p>Object properties can be set like all other PHP objects.</p></li>
</ul>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">$map-&gt;scaledenom = 25000;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>The set/setProperty methods are still available.</p>
</div>
<ul class="simple">
<li><p>Objects can be created with the PHP «new» operator.</p></li>
</ul>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">$myShape = ms_newShapeObj(MS_SHAPE_LINE); // or</span>
<span class="x">$myShape = new shapeObj(MS_SHAPE_LINE);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>All object constructors throw an exception on failure.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><em>ms_newSymbolObj()</em> and <em>new symbolObj()</em> are different</p>
<ul class="simple">
<li><p>ms_newSymbolObj() returns the id of the new/existing symbol.</p></li>
<li><p>new symbolObj() returns the symbolObj. You don’t need to get it with getSymbolObjectById().</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Cloneable objects should be cloned with the PHP clone keyword. There is no more clone methods.</p></li>
</ul>
</div>
<div class="section" id="class-properties">
<h3><a class="toc-backref" href="#table-of-contents">Class Properties</a><a class="headerlink" href="#class-properties" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Class properties that have been removed:</p>
<blockquote>
<div><ul class="simple">
<li><p>classObj: maxscale, minscale</p></li>
<li><p>layerObj: labelsizeitem, labelangleitem, labelmaxscale, labelminscale, maxscale, minscale, symbolscale, transparency</p></li>
<li><p>legendObj: interlace, transparent</p></li>
<li><p>mapObj: imagetype, imagequality, interlace, scale, transparent</p></li>
<li><p>scalebarObj: interlace, transparent</p></li>
<li><p>symbolObj: gap, stylelength</p></li>
<li><p>webObj: minscale, maxscale</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="class-methods">
<h3><a class="toc-backref" href="#table-of-contents">Class Methods</a><a class="headerlink" href="#class-methods" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Class methods that have been removed:</p>
<blockquote>
<div><ul class="simple">
<li><p>imageObj: free</p></li>
<li><p>layerObj: getFilter, getShape</p></li>
<li><p>lineObj: free</p></li>
<li><p>pointObj: free</p></li>
<li><p>projectionObj: free</p></li>
<li><p>rectObj: free</p></li>
<li><p>shapeObj: union_geos</p></li>
<li><p>symbolObj: getstylearray</p></li>
<li><p>classObj: clone</p></li>
<li><p>styleObj: clone</p></li>
<li><p>mapObj: clone</p></li>
<li><p>outputFormatObj: getformatoption, setformatoption</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="layerobj">
<h3><a class="toc-backref" href="#table-of-contents">layerObj</a><a class="headerlink" href="#layerobj" title="Enlazar permanentemente con este título">¶</a></h3>
<p>layerObj-&gt;clearProcessing() method now returns void.</p>
</div>
<div class="section" id="mapobj">
<h3><a class="toc-backref" href="#table-of-contents">mapObj</a><a class="headerlink" href="#mapobj" title="Enlazar permanentemente con este título">¶</a></h3>
<p>mapObj-&gt;queryByIndex(): default behavior for the addToQuery parameter was not ok, now it is.</p>
</div>
<div class="section" id="referencemapobj">
<h3><a class="toc-backref" href="#table-of-contents">referenceMapObj</a><a class="headerlink" href="#referencemapobj" title="Enlazar permanentemente con este título">¶</a></h3>
<p>referenceMapObj has new properties: marker, markername, markersize, maxboxsize, minboxsize.</p>
</div>
<div class="section" id="shapefileobj">
<h3><a class="toc-backref" href="#table-of-contents">shapeFileObj</a><a class="headerlink" href="#shapefileobj" title="Enlazar permanentemente con este título">¶</a></h3>
<p>shapeFileObj is automatically closed/writed on destroy. (At the end of the script or with an explicit free(), unset())</p>
</div>
<div class="section" id="labelcacheobj">
<h3><a class="toc-backref" href="#table-of-contents">labelCacheObj</a><a class="headerlink" href="#labelcacheobj" title="Enlazar permanentemente con este título">¶</a></h3>
<p>To free the cache, you’ll have to call the method freeCache() rather than
free().</p>
</div>
<div class="section" id="methods-that-now-return-ms-success-ms-failure">
<h3><a class="toc-backref" href="#table-of-contents">Methods that now return MS_SUCCESS/MS_FAILURE</a><a class="headerlink" href="#methods-that-now-return-ms-success-ms-failure" title="Enlazar permanentemente con este título">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>layerObj: setProcessing, addFeature, draw</p></li>
<li><p>mapObj: moveLayerUp, moveLayerDown, zoomRectangle, zoomScale, setProjection, setWKTProjection, setLayersDrawingOrder</p></li>
<li><p>outputFormatObj: validate</p></li>
<li><p>scalebarObj: setImageColor</p></li>
<li><p>symbolObj: setPoints, setPattern</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="methods-that-now-return-null-on-failure">
<h3><a class="toc-backref" href="#table-of-contents">Methods that now return NULL on failure</a><a class="headerlink" href="#methods-that-now-return-null-on-failure" title="Enlazar permanentemente con este título">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>classObj: clone</p></li>
<li><p>mapObj: clone, draw, drawQuery getLayerByName, getProjection</p></li>
<li><p>layerObj: nextShape, getExtent</p></li>
<li><p>styleObj: clone</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="methods-that-now-return-an-empty-array">
<h3><a class="toc-backref" href="#table-of-contents">Methods that now return an empty array</a><a class="headerlink" href="#methods-that-now-return-an-empty-array" title="Enlazar permanentemente con este título">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>layerObj: getItems, getProcessing, getGridIntersectionCoordinates</p></li>
<li><p>mapObj: getLayersIndexByGroup, getAllGroupNames, getLayersDrawingOrder, getAllLayerNames</p></li>
<li><p>symbolObj: getPatternArray</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../../development/index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">PHP MapScript Migration Guide</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#migrating-to-7-4-s-new-swig-api-and-php-7">Migrating to 7.4’s new SWIG API and PHP 7</a></li>
<li><a class="reference internal" href="#migrating-5-6-to-6-0">Migrating 5.6 to 6.0</a><ul>
<li><a class="reference internal" href="#php-version-required">PHP Version Required</a></li>
<li><a class="reference internal" href="#error-reporting">Error Reporting</a></li>
<li><a class="reference internal" href="#manipulating-objects">Manipulating Objects</a></li>
<li><a class="reference internal" href="#class-properties">Class Properties</a></li>
<li><a class="reference internal" href="#class-methods">Class Methods</a></li>
<li><a class="reference internal" href="#layerobj">layerObj</a></li>
<li><a class="reference internal" href="#mapobj">mapObj</a></li>
<li><a class="reference internal" href="#referencemapobj">referenceMapObj</a></li>
<li><a class="reference internal" href="#shapefileobj">shapeFileObj</a></li>
<li><a class="reference internal" href="#labelcacheobj">labelCacheObj</a></li>
<li><a class="reference internal" href="#methods-that-now-return-ms-success-ms-failure">Methods that now return MS_SUCCESS/MS_FAILURE</a></li>
<li><a class="reference internal" href="#methods-that-now-return-null-on-failure">Methods that now return NULL on failure</a></li>
<li><a class="reference internal" href="#methods-that-now-return-an-empty-array">Methods that now return an empty array</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="by_example.html" title="By Example"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="phpmapscript.html" title="PHP MapScript API"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../documentation.html" >MapServer 7.4.3 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >MapScript</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >PHP MapScript</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../../copyright.html">Derechos de autor</a> 2020, Open Source Geospatial Foundation.
      Actualizado por última vez en 2020-03-14.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.3.
    </div>
  </body>
</html>