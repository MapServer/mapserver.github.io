<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MS RFC 96: Time Dimension Support in MapCache Tilesets &mdash; MapServer 7.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="MapServer 7.0.0 documentation" href="../../index.html" />
    <link rel="up" title="Request for Comments" href="index.html" />
    <link rel="next" title="MS RFC 97: Dynamic creation of higher zoom levels tiles" href="ms-rfc-97.html" />
    <link rel="prev" title="MS RFC 95: Support for lists in expression parser" href="ms-rfc-95.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../faq.html" title="FAQ">FAQ</a> |
      <a href="../../download.html" title="Download">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        
        
          <a href="../../uk/development/rfc/ms-rfc-96.html"><img src="../../_static/flagicons/uk.png" alt="uk" title="uk" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-97.html" title="MS RFC 97: Dynamic creation of higher zoom levels tiles"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-95.html" title="MS RFC 95: Support for lists in expression parser"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ms-rfc-96-time-dimension-support-in-mapcache-tilesets">
<span id="rfc96"></span><h1>MS RFC 96: Time Dimension Support in MapCache Tilesets<a class="headerlink" href="#ms-rfc-96-time-dimension-support-in-mapcache-tilesets" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">2013/04/04</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Thomas Bonfort</td>
</tr>
<tr class="field-odd field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:thomas&#46;bonfort&#37;&#52;&#48;gmail&#46;com">thomas<span>&#46;</span>bonfort<span>&#64;</span>gmail<span>&#46;</span>com</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Stephan Meißl</td>
</tr>
<tr class="field-odd field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:stephan&#37;&#52;&#48;meissl&#46;name">stephan<span>&#64;</span>meissl<span>&#46;</span>name</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Status:</th><td class="field-body">Adopted</td>
</tr>
<tr class="field-odd field"><th class="field-name">Version:</th><td class="field-body">MapCache 1.2</td>
</tr>
</tbody>
</table>
<div class="section" id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This RFC proposes to add time dimension support in MapCache. This
allows MapCache to answer WMTS and WMS requests including in the
TIME parameter both timestamps or time intervals.</p>
<p>One of the motivating use cases is to efficiently serve potentially
big archives of Earth Observation data via WMTS and WMS. Only one
layer per sensor or satellite needs to be configured and single
acquisitions can still be selected using the time of acquisition in
the TIME parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...&amp;</span><span class="n">TIME</span><span class="o">=</span><span class="mi">2010</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">22</span><span class="n">T10</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mo">01</span><span class="n">Z</span><span class="o">&amp;...</span>
</pre></div>
</div>
<img alt="../../_images/mapcache-time-point.png" src="../../_images/mapcache-time-point.png" />
<p>In the same way it is also possible to view all acquisitions within
a given time interval:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">...&amp;</span><span class="n">TIME</span><span class="o">=</span><span class="mi">2010</span><span class="o">-</span><span class="mo">07</span><span class="o">/</span><span class="mi">2010</span><span class="o">-</span><span class="mi">08</span><span class="o">&amp;...</span>
</pre></div>
</div>
<img alt="../../_images/mapcache-time-interval.png" src="../../_images/mapcache-time-interval.png" />
<p>For service providers it is additionally important to be able to add
new acquisitions to the cache as they become available at the
configured source without the need to restart the web server.</p>
</div>
<div class="section" id="proposed-solution">
<h2>2. Proposed solution<a class="headerlink" href="#proposed-solution" title="Permalink to this headline">¶</a></h2>
<p>To obtain the behavior detailed in the previous paragraph, MapCache needs to be
extended to support the notion of timestamps for a given tileset:</p>
<ul class="simple">
<li>A database of some sort is used to query the available timestamps for a
tileset.  The actual population of this database is not managed by mapcache,
and is left to the server administrator whenever a new timestamp is added to
the source data.</li>
<li>Given an incoming request with a specified <code class="docutils literal"><span class="pre">TIME=xxx</span></code> component, MapCache
must be able to query the said database to extract the individual timestamp
entries. Once the timestamps have been extracted, processing consists in
vertically assembling the tiles corresponding to the individual timestamps in
order to return a single composited tile to the client.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This functionality will only be activated and usable for WMS and WMTS
requests. Other specifications do not provision the usage of dimensions.</p>
</div>
<div class="section" id="example">
<h3>2.1 Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Suppose that the database given for a tileset contains the timestamps
<code class="docutils literal"><span class="pre">2011-12-15</span></code>, <code class="docutils literal"><span class="pre">2012-01-15</span></code>, and <code class="docutils literal"><span class="pre">2012-02-15</span></code>, i.e. there are three
different datasets that where captured on the 15th of December, January and
February.</p>
<p>For a request containing the time dimension <code class="docutils literal"><span class="pre">TIME=2012</span></code>, these are the steps
that are accomplished:</p>
<ul class="simple">
<li>The database is queried for timestamps that span <code class="docutils literal"><span class="pre">2012-01-01</span></code> to
<code class="docutils literal"><span class="pre">2012-12-31</span></code>. The database returns the two valid timestamps <code class="docutils literal"><span class="pre">2012-01-15</span></code>
and <code class="docutils literal"><span class="pre">2012-02-15</span></code></li>
<li>Mapcache creates a request that will ask for the vertical merging of the
tileset with two different <code class="docutils literal"><span class="pre">TIME</span></code> dimensions</li>
<li>Mapcache queries the cache for the tile with the <code class="docutils literal"><span class="pre">2012-01-15</span></code> dimension. If
the tile is not found in the cache, the &lt;source&gt; renders the given metatile
having been passed a <code class="docutils literal"><span class="pre">TIME=2012-01-15</span></code> URL parameter.</li>
<li>Mapcache queries the cache for the tile with the <code class="docutils literal"><span class="pre">2012-02-15</span></code> dimension.</li>
<li>Mapcache assembles these two tiles</li>
<li>Mapcache returns a single tile to the client, consisting of the vertical
assembly of the two tiles, and therefore containing the data of the <code class="docutils literal"><span class="pre">2012</span></code>
time series.</li>
</ul>
</div>
<div class="section" id="storing-and-retrieving-timestamp-entries">
<h3>2.2 Storing and Retrieving Timestamp entries<a class="headerlink" href="#storing-and-retrieving-timestamp-entries" title="Permalink to this headline">¶</a></h3>
<p>While the available timestamps for a tileset could be supplied in the
mapcache.xml configuration file, for the dynamic case where datasets are added
regularly this would not be practical as it would require a server restart.</p>
<p>The initial implementation will query a sqlite database for the available
timestamps given a time interval. Additional database backends may be added in
the future, the code is written with the traditional mapcache struct
inheritance that allows for future extensibility.</p>
<p>In order to remain generic, there is no enforcement on the schema of the
provided sqlite database, it is up to the mapcache administrator to:</p>
<ul class="simple">
<li>Provide the path to the sqlite file that should be used for a given tileset</li>
<li>Provide the sqlite query that should be run in order to obtain the individual
timestamps given a time interval. Mapcache will use this query on the sqlite
database, after having binded one or more of the <code class="docutils literal"><span class="pre">:tileset</span></code>,
<code class="docutils literal"><span class="pre">:start_timestamp</span></code>, <code class="docutils literal"><span class="pre">:end_timestamp</span></code> values given the current request.</li>
</ul>
<p>An example configuration entry is provided here:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;timedimension</span> <span class="na">type=</span><span class="s">&quot;sqlite&quot;</span> <span class="na">default=</span><span class="s">&quot;2010&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dbfile&gt;</span>/path/to/mapcache-time.sqlite<span class="nt">&lt;/dbfile&gt;</span>
  <span class="nt">&lt;query&gt;</span>
    select
      strftime(&#39;%Y-%m-%dT%H:%M:%SZ&#39;,start_time)||&#39;/&#39;||strftime(&#39;%Y-%m-%dT%H:%M:%SZ&#39;,end_time)
    from
      time
    where
      source_id=:tileset
      and
      start_time<span class="ni">&amp;gt;</span>=datetime(:start_timestamp,&#39;unixepoch&#39;)
      and
      end_time<span class="ni">&amp;lt;</span>=datetime(:end_timestamp,&#39;unixepoch&#39;)
    order by
      end_time
  <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/timedimension&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is up to the mapcache administrator to provide a sqlite query that
correctly interprets the start_time and end_time values, <strong>and</strong> that returns
a timestamp in a textual form that can be directly interpreted by the
tileset&#8217;s source WMS after having been passed in a <code class="docutils literal"><span class="pre">TIME=xxx</span></code> URL parameter
in the GetMap request.</p>
</div>
</div>
<div class="section" id="interpreting-time-formats">
<h3>2.3 Interpreting Time formats<a class="headerlink" href="#interpreting-time-formats" title="Permalink to this headline">¶</a></h3>
<p>MapCache will accept requests with a TIME dimension that follows one of these
two formats:</p>
<ul class="simple">
<li>TIME=&lt;timestamp&gt;, e.g. TIME=2012-01-01</li>
<li>TIME=&lt;timestamp_start&gt;/&lt;timestamp_end&gt;, e.g. TIME=2012-01-01/2012-12-31</li>
</ul>
<p>The format for &lt;timestamp&gt; respects ISO 8601:2000 “extended” format: up to 14
digits specifying century, year, month, day, hour, minute, and seconds with
non-numeric characters to separate each piece:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ccyy-mm-ddThh:mm:ssZ
</pre></div>
</div>
<p>A &lt;timestamp&gt; may be abbreviated to lower resolutions, mapcache will understand
timestamps of the following formats:</p>
<ul class="simple">
<li>%Y-%m-%dT%H:%M:%SZ (finest resolution)</li>
<li>%Y-%m-%dT%H:%MZ (all timestamp for a given minute)</li>
<li>%Y-%m-%dT%HZ (all timestamps for a given hour)</li>
<li>%Y-%m-%d (all timestamps for a given day)</li>
<li>%Y-%m (all timestamps for a given month)</li>
<li>%Y (all timestamps for a given year)</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">ISO8601:2000 allows time resolutions down to the millisecond, i.e.
<code class="docutils literal"><span class="pre">ccyy-mm-ddThh:mm:ss.sssZ</span></code>.  These are not supported by mapcache at the
time being.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">ISO8601:2000 allows timezones to be specified as the last letter of the
timestamp. This is not supported by mapcache, who expects timestamps in UTC
(suffix Z, zulu)</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The OGC WMS spec allows lists of timestamps or intervals to be specified.
These are not supported by mapcache at the time being.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The OGC WMS spec allows a resolution to be added to the end of a time
interval, e.g.  <code class="docutils literal"><span class="pre">TIME=2012-01-01/2012-02-01/P1D</span></code>. It is ignored by mapcache
as it does not make any sense in this current setup.</p>
</div>
<p>A new function will be added, using strptime, that will compute a time interval
given a TIME dimension provided in the request URL.</p>
<p>To summarize, here is the full list of valid timestamps for mapcache:</p>
<ul class="simple">
<li>2012</li>
<li>2012-01</li>
<li>2012-01-01</li>
<li>2012-01-01T12Z</li>
<li>2012-01-01T12:01Z</li>
<li>2012-01-01T12:01:01Z</li>
</ul>
<p>Here is an example list of valid TIME url parameters, where the timestamps can
also be used in intervals (the resolution does not <em>need</em> to match, although
doing so is recommended), for example:</p>
<ul class="simple">
<li>TIME=2012</li>
<li>TIME=2012-01-01</li>
<li>TIME=2012-01-01T12Z</li>
<li>TIME=2012/2013</li>
<li>TIME=2012-01-01T12Z/2012-01-02T12Z</li>
<li>TIME=2012/2013-01-02T12Z   (not recommended)</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The OGC WMTS spec does not allow intervals to be specified for the TIME
dimension. MapCache will however interpret intervals in its KVP interface,
but these cannot be supported by the REST interface (due to the presence
of &#8216;/&#8217;s which are ambiguous).</p>
</div>
</div>
<div class="section" id="handling-incomplete-tilesets-for-a-given-timestamp">
<h3>2.4 Handling Incomplete Tilesets for a given Timestamp<a class="headerlink" href="#handling-incomplete-tilesets-for-a-given-timestamp" title="Permalink to this headline">¶</a></h3>
<p>Though not strictly related to this RFC, the TIME dimension support in mapcache
will support tilesets spanning different extents depending on the timestamp. If
the tileset is set to &lt;readonly&gt;, a missing tile from the cache for a given
timestamp will not result in an error or be requested from the &lt;source&gt;, but
will be regarded as &#8220;empty&#8221;.</p>
<p>To put this in context, a satellite run corresponds to a specific
time(stamp|interval), and spans a limited area on the globe. There is no need
to seed|generate the tiles outside of the extents spanned by this run, however
it is still possible to request a mosaic compositing all of the satellite runs
for a given (larger) time interval.</p>
</div>
</div>
<div class="section" id="implementation-details">
<h2>3. Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>3.1 Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>A struct representing a TIME database will be added, and be sub-classed by a
sqlite specific implementation.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
  <span class="n">MAPCACHE_TIMEDIMENSION_ASSEMBLY_STACK</span><span class="p">,</span>
  <span class="n">MAPCACHE_TIMEDIMENSION_ASSEMBLY_ANIMATE</span> <span class="cm">/* for future use */</span>
<span class="p">}</span> <span class="n">mapcache_timedimension_assembly_type</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
  <span class="n">MAPCACHE_TIMEDIMENSION_SOURCE_SQLITE</span>
  <span class="cm">/* for future use */</span>
<span class="p">}</span> <span class="n">mapcache_timedimension_source_type</span><span class="p">;</span>

<span class="n">apr_array_header_t</span><span class="o">*</span> <span class="nf">mapcache_timedimension_get_entries_for_value</span><span class="p">(</span>
  <span class="n">mapcache_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span>
  <span class="n">mapcache_timedimension</span> <span class="o">*</span><span class="n">timedimension</span><span class="p">,</span>
  <span class="n">mapcache_tileset</span> <span class="o">*</span><span class="n">tileset</span><span class="p">,</span>
  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span>
<span class="p">);</span>

<span class="k">struct</span> <span class="n">mapcache_timedimension</span> <span class="p">{</span>
  <span class="n">mapcache_timedimension_assembly_type</span> <span class="n">assembly_type</span><span class="p">;</span> <span class="cm">/* for future use */</span>
  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">configuration_parse_xml</span><span class="p">)(</span>
    <span class="n">mapcache_context</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span>
    <span class="n">mapcache_timedimension</span> <span class="o">*</span><span class="n">dim</span><span class="p">,</span>
    <span class="n">ezxml_t</span> <span class="n">node</span><span class="p">);</span>
  <span class="n">apr_array_header_t</span><span class="o">*</span> <span class="p">(</span><span class="o">*</span><span class="n">get_entries_for_interval</span><span class="p">)(</span>
    <span class="n">mapcache_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">mapcache_timedimension</span> <span class="o">*</span><span class="n">dim</span><span class="p">,</span>
    <span class="n">mapcache_tileset</span> <span class="o">*</span><span class="n">tileset</span><span class="p">,</span>
    <span class="kt">time_t</span> <span class="n">start</span><span class="p">,</span>
    <span class="kt">time_t</span> <span class="n">end</span><span class="p">);</span>
  <span class="n">apr_array_header_t</span><span class="o">*</span> <span class="p">(</span><span class="o">*</span><span class="n">get_all_entries</span><span class="p">)(</span>
    <span class="n">mapcache_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">mapcache_timedimension</span> <span class="o">*</span><span class="n">dim</span><span class="p">,</span>
    <span class="n">mapcache_tileset</span> <span class="o">*</span><span class="n">tileset</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">default_value</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">mapcache_timedimension_sqlite</span> <span class="p">{</span>
  <span class="n">mapcache_timedimension</span> <span class="n">timedimension</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">dbfile</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">query</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The structs present two public functions, one to get all valid values (in order
to construct capabilities documents and demo interface), and another returning
valid timestamps for a given interval.</p>
</div>
<div class="section" id="files-affected">
<h3>3.2 Files affected<a class="headerlink" href="#files-affected" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>mapcache.h</li>
<li>configuration_xml.c (parser)</li>
<li>dimension.c (sqlite timestamp extraction)</li>
<li>service_demo.c (add valid timestamps to demo interface)</li>
<li>service_wms.c, service_wmts.c (URL parameter parsing, timestamp database querying)</li>
<li>tileset.c (cloning and creation functions)</li>
<li>mapcache_seed.c (timestamp specification when seeding)</li>
</ul>
</div>
<div class="section" id="backwards-compatibility-issues">
<h3>3.3 Backwards Compatibility Issues<a class="headerlink" href="#backwards-compatibility-issues" title="Permalink to this headline">¶</a></h3>
<p>None expected, new functionality</p>
</div>
</div>
<div class="section" id="performance-implications">
<h2>4. Performance implications<a class="headerlink" href="#performance-implications" title="Permalink to this headline">¶</a></h2>
<p>When supplying a TIME range in the request URL that corresponds to a large number of
time entries from the database, the corresponding operation in mapcache can become
computationally heavy as there will be numerous image tiles to fetch, decode and merge
into the finally produced image.
While this might lead to a denial of service on the mapcache server, it is considered
normal behavior in order to supply correct results. Server administrators can mitigate
this load by adding a <code class="docutils literal"><span class="pre">ORDER</span> <span class="pre">BY</span> <span class="pre">ttt</span> <span class="pre">LIMIT</span> <span class="pre">xxx</span></code> clause in their sqlite queries, at the
cost of responses that will be missing entries.</p>
</div>
<div class="section" id="bug-id">
<h2>5. Bug ID<a class="headerlink" href="#bug-id" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>62: <a class="reference external" href="https://github.com/mapserver/mapcache/pull/62">pull62</a></li>
</ul>
</div>
<div class="section" id="voting-history">
<h2>6. Voting history<a class="headerlink" href="#voting-history" title="Permalink to this headline">¶</a></h2>
<p>+1 from ThomasB, MikeS, TomK, JeffM, DanielM, SteveW, OlivierC, SteveL and
PerryN</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a>
</p>
  <h3>Current Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 96: Time Dimension Support in MapCache Tilesets</a><ul>
<li><a class="reference internal" href="#overview">1. Overview</a></li>
<li><a class="reference internal" href="#proposed-solution">2. Proposed solution</a><ul>
<li><a class="reference internal" href="#example">2.1 Example</a></li>
<li><a class="reference internal" href="#storing-and-retrieving-timestamp-entries">2.2 Storing and Retrieving Timestamp entries</a></li>
<li><a class="reference internal" href="#interpreting-time-formats">2.3 Interpreting Time formats</a></li>
<li><a class="reference internal" href="#handling-incomplete-tilesets-for-a-given-timestamp">2.4 Handling Incomplete Tilesets for a given Timestamp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-details">3. Implementation Details</a><ul>
<li><a class="reference internal" href="#id1">3.1 Overview</a></li>
<li><a class="reference internal" href="#files-affected">3.2 Files affected</a></li>
<li><a class="reference internal" href="#backwards-compatibility-issues">3.3 Backwards Compatibility Issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-implications">4. Performance implications</a></li>
<li><a class="reference internal" href="#bug-id">5. Bug ID</a></li>
<li><a class="reference internal" href="#voting-history">6. Voting history</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Open Source Geospatial Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
    </div>

    

    
  </body>
</html>