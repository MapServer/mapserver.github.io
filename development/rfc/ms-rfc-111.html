<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MS RFC 111: MapCache Support for animated time series &mdash; MapServer 7.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="MapServer 7.0.0 documentation" href="../../index.html" />
    <link rel="up" title="Request for Comments" href="index.html" />
    <link rel="next" title="MS RFC 112: Retry “Follow” label positioning after maxoverlapangle colision" href="ms-rfc-112.html" />
    <link rel="prev" title="MS RFC 110: MapCache REST Cache Backends" href="ms-rfc-110.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../faq.html" title="FAQ">FAQ</a> |
      <a href="../../download.html" title="Download">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        
        
          <a href="../../uk/development/rfc/ms-rfc-111.html"><img src="../../_static/flagicons/uk.png" alt="uk" title="uk" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-112.html" title="MS RFC 112: Retry “Follow” label positioning after maxoverlapangle colision"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-110.html" title="MS RFC 110: MapCache REST Cache Backends"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ms-rfc-111-mapcache-support-for-animated-time-series">
<span id="rfc111"></span><h1>MS RFC 111: MapCache Support for animated time series<a class="headerlink" href="#ms-rfc-111-mapcache-support-for-animated-time-series" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">2014/05</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Jerome Villeneuve-Larouche</td>
</tr>
<tr class="field-odd field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:jlarouche&#37;&#52;&#48;mapgears&#46;com">jlarouche<span>&#64;</span>mapgears<span>&#46;</span>com</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Status:</th><td class="field-body">Draft</td>
</tr>
<tr class="field-odd field"><th class="field-name">Version:</th><td class="field-body">MapCache 1.4</td>
</tr>
<tr class="field-even field"><th class="field-name">Last Updated:</th><td class="field-body">2014/05/14</td>
</tr>
</tbody>
</table>
<div class="section" id="motivation">
<h2>1. Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>Currently if you specify a time frame in a request on a tileset with a
timedimension, mapcache simply stacks all the frames onto each other. Another
way to show time series is to produce an animated image of the different frames.
This implementation will use the Gif format to create an animated version of
the time series.</p>
</div>
<div class="section" id="implementation-details">
<h2>2. Implementation details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h2>
<p>This implementation only work for single tile request, like a single tile map
in OpenLayers, because there is no way to synchronize the animation of
multiple Gif tiles on one mapview, seeding multiple tile wouldn&#8217;t produce a
good result.</p>
<div class="section" id="gif-encoding">
<h3>2.1 Gif Encoding<a class="headerlink" href="#gif-encoding" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>New Gif format output using GifLib</li>
<li>New format write_frames function in MapCache to write an animated Gif</li>
</ul>
</div>
<div class="section" id="animation-configuration">
<h3>2.2 Animation configuration<a class="headerlink" href="#animation-configuration" title="Permalink to this headline">¶</a></h3>
<p>Adding animation to a time dimension requires two new attributes to it and using
the Gif output format.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> &lt;timedimension type=&quot;sqlite&quot; default=&quot;2012-01-01&quot; animate=&quot;true&quot; delay=&quot;150&quot;&gt;
     &lt;dbfile&gt;mapcache-time.sqlite&lt;/dbfile&gt;
         &lt;query&gt;
         select
             strftime(&#39;%Y-%m-%d&#39;,start_time)
             from
             time
         where
             source_id=:tileset
         and
             start_time&amp;gt;=datetime(:start_timestamp,&#39;unixepoch&#39;)
         and
             start_time&amp;lt;=datetime(:end_timestamp,&#39;unixepoch&#39;)
         order by
             end_time
     &lt;/query&gt;
 &lt;/timedimension&gt;

&lt;service type=&quot;wms&quot; enabled=&quot;true&quot;&gt;
   &lt;full_wms&gt;assemble&lt;/full_wms&gt;
   &lt;resample_mode&gt;bilinear&lt;/resample_mode&gt;
   &lt;format&gt;GIF&lt;/format&gt;
   &lt;maxsize&gt;4096&lt;/maxsize&gt;
&lt;/service&gt;
</pre></div>
</div>
<ul>
<li><p class="first">The &#8220;animate&#8221; attribute specifies if we want to animate our timedimension.
If it is not present or set to false, we don&#8217;t animate.</p>
</li>
<li><p class="first">The &#8220;delay&#8221; attribute specifies the delay between two frames in
hundreth of a second. If it is not present, it defaults to 100,
if it is present but the &#8220;animate&#8221; attribute isn&#8217;t, it will simply
be ignored. It also has to be bigger than zero.</p>
<p>You also have to set the output format, for example in the service, to Gif.
If you ask for an animated tileset without the Gif format, MapCache will
generate an error message.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="miscellaneous">
<h2>3. Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The animation could also be controlled by the service format instead of
adding attributes to the timedimension. I think it would make more sense to
implement it that way in the code since the core and encoding
functions don&#8217;t normally use the tileset but the map request and
the format.</li>
</ul>
<div class="section" id="backwards-incompatibilities">
<h3>3.1 Backwards Incompatibilities<a class="headerlink" href="#backwards-incompatibilities" title="Permalink to this headline">¶</a></h3>
<p>none expected</p>
</div>
<div class="section" id="issue-tracking-id">
<h3>3.2 Issue Tracking ID<a class="headerlink" href="#issue-tracking-id" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="files-changed">
<h3>3.4 Files Changed<a class="headerlink" href="#files-changed" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>include/mapacache.h</li>
<li>lib/configuration.c</li>
<li>lib/configuration_xml.c</li>
<li>lib/core.c</li>
<li>lib/dimension.c</li>
<li>lib/imageio_gif.c (new)</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a>
</p>
  <h3>Current Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 111: MapCache Support for animated time series</a><ul>
<li><a class="reference internal" href="#motivation">1. Motivation</a></li>
<li><a class="reference internal" href="#implementation-details">2. Implementation details</a><ul>
<li><a class="reference internal" href="#gif-encoding">2.1 Gif Encoding</a></li>
<li><a class="reference internal" href="#animation-configuration">2.2 Animation configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#miscellaneous">3. Miscellaneous</a><ul>
<li><a class="reference internal" href="#backwards-incompatibilities">3.1 Backwards Incompatibilities</a></li>
<li><a class="reference internal" href="#issue-tracking-id">3.2 Issue Tracking ID</a></li>
<li><a class="reference internal" href="#files-changed">3.4 Files Changed</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Open Source Geospatial Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
    </div>

    

    
  </body>
</html>