<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 39: Support of WMS/SLD Named Styles &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 40: Support Label Text Transformations" href="ms-rfc-40.html" />
    <link rel="prev" title="MS RFC 38: Native Microsoft SQL Server 2008 Driver for MapServer" href="ms-rfc-38.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-39.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-40.html" title="MS RFC 40: Support Label Text Transformations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-38.html" title="MS RFC 38: Native Microsoft SQL Server 2008 Driver for MapServer"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 39: Support of WMS/SLD Named Styles</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-39-support-of-wms-sld-named-styles">
<span id="rfc39"></span><h1>MS RFC 39: Support of WMS/SLD Named Styles<a class="headerlink" href="#ms-rfc-39-support-of-wms-sld-named-styles" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2008/06/25</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Yewondwossen Assefa</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p>assefa at dmsolutions.ca</p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Adopted</p>
</dd>
<dt class="field-odd">Version<span class="colon">:</span></dt>
<dd class="field-odd"><p>MapServer 5.2</p>
</dd>
</dl>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>When WMS and SLD support was added in MapServer few years back, one of
features that was not integrated was the ability to specify named styles
through WMS GetMap request using the STYLES parameter or through the
&lt;NamedStyle&gt; parameter in an SLD document.</p>
<p>Using named styles, the WMS client has the ability to render a specified layer
using styles predefined by the WMS server.</p>
<p>Example of this would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://..../mapserv.cgi?Request=GetMap&amp;....&amp;LAYERS=Rivers,Roads,Houses&amp;STYLES=CenterLine,CenterLine,Outline


&lt;StyledLayerDescriptorversion=&quot;1.0.0&quot;&gt;
  &lt;NamedLayer&gt;&lt;Name&gt;Roads&lt;/Name&gt;
    &lt;NamedStyle&gt;
      &lt;Name&gt;Casing&lt;/Name&gt;
    &lt;/NamedStyle&gt;
    &lt;NamedStyle&gt;
      &lt;Name&gt;CenterLine&lt;/Name&gt;
    &lt;/NamedStyle&gt;
  &lt;/NamedLayer&gt;
&lt;/StyledLayerDescriptor&gt;
</pre></div>
</div>
<p>The main reason this functionality is not yet supported is that It is not
currently possible to defined in MapServer several mutually exclusive ‘styles’
on a layer The intention of this RFC is to introduce a simple mechanism that
would allow MapServer to define mutually exclusive ‘Styles’. This would then
allow for MapServer to advertise and support named styles through the WMS
interface</p>
</section>
<section id="proposed-changes">
<h2>Proposed Changes<a class="headerlink" href="#proposed-changes" title="Link to this heading">¶</a></h2>
<p>The MapServer architecture (layer. class, styles) does not fit well the SLD
model where it assumes that you can define mutually exclusive styles on a
layer and be able to switch between them.</p>
<p>One possible solution which is reasonably non disruptive would be to introduce
the concept of group names at the class object level and have at a layer level
a parameter that can be used to specify the classes to use. Something like
this is what is proposed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
 <span class="o">...</span>
 <span class="n">CLASSGROUP</span> <span class="s2">&quot;group1&quot;</span>
 <span class="o">...</span>
 <span class="n">CLASS</span>
   <span class="n">NAME</span> <span class="s2">&quot;name1&quot;</span>
   <span class="n">GROUP</span> <span class="s2">&quot;group1&quot;</span>
   <span class="o">...</span>
 <span class="n">END</span>
 <span class="n">CLASS</span>
   <span class="n">NAME</span> <span class="s2">&quot;name2&quot;</span>
   <span class="n">GROUP</span> <span class="s2">&quot;group2&quot;</span>
   <span class="o">...</span>
 <span class="n">END</span>
 <span class="n">CLASS</span>
   <span class="n">NAME</span> <span class="s2">&quot;name3&quot;</span>
   <span class="n">GROUP</span> <span class="s2">&quot;group1&quot;</span>
   <span class="o">...</span>
 <span class="n">END</span>
 <span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This introduces two new keywords, CLASSGROUP at the layer level and GROUP
name in the class object.</p></li>
<li><p>These parameters are optional</p></li>
<li><p>If the CLASSGROUP parameter is set, only classes that have the same group
name would be considered at rendering time. If it is not set, all classes
(current behavior) would be used.</p></li>
<li><p>Note that CLASSGROUP is acting as the default style if there are classes
within the same LAYER with different GROUPs defined. The idea is that STYLES
parameter through a wms request (or cgi URL variable) would override the
value of the CLASSGROUP. In the example above, only classes “name1” and
“name3” would be considered for rendering (if STYLES= or STYLES=default),
unless the client overrides this value using STYLES=group2.</p></li>
</ul>
</section>
<section id="affected-added-functionalities-in-mapserver">
<h2>Affected/Added functionalities in MapServer<a class="headerlink" href="#affected-added-functionalities-in-mapserver" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>MapServer vector rendering (function msShapeGetClass) would use the setting
of the classgroup if it is available</p></li>
<li><p>Raster rendering (function msGetClass) : would use the setting of the
classgroup if it is available</p></li>
<li><p>Possibility to use the URL variables to modify the value of the classgroup
(something like this would be valid :
…&amp;map.layer[layername]=classgroup+group2. This would allow through the cgi
to switch representation of a layer if needed</p></li>
<li><p>WMS related functionalities:</p></li>
</ol>
<ul class="simple">
<li><p>Advertise STYLES through the GetCapabilities: styles would be based on the
different group names of the classes defined in the layer. If all classes do
not have the GROUP set, the current behavior (returning the STYLE element with
the ‘default’ name) will be kept. If one or more classes have the GROUP set,
It is proposed to output something like this for each “group”:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Style</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Name</span><span class="o">&gt;</span><span class="n">group1</span><span class="o">&lt;/</span><span class="n">Name</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Title</span><span class="o">&gt;</span><span class="n">group1</span><span class="o">&lt;/</span><span class="n">Title</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">LegendURL</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;20&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">Format</span><span class="o">&gt;</span><span class="n">image</span><span class="o">/</span><span class="n">png</span><span class="o">&lt;/</span><span class="n">Format</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">OnlineResource</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xlink</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="n">xlink</span><span class="p">:</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span> <span class="n">xlink</span><span class="p">:</span><span class="n">href</span><span class="o">=</span><span class="s2">&quot;http://127.0.0.1/cgi-bin/mapserv.exe?map=f:/msapps/test.map&amp;amp;version=1.1.1&amp;amp;service=WMS&amp;amp;request=GetLegendGraphic&amp;amp;layer=mylayer&amp;amp;format=image/png&amp;STYLES=group1&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;/</span><span class="n">LegendURL</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">Style</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Support Named Styles in SLD. This would have the effect of setting the layer
level CLASSGROUP. We throw an exception if an invalid style is passed.</p></li>
<li><p>Support style names in the STYLES parameter for the WMS GetMap request. We
would still support the empty style names as well as the “default” keyword
used for STYLES. We throw an exception if an invalid style is passed.</p></li>
<li><p>GetLegendGraphic would be extended to support names in the STYLES
parameter. The if STYLE parameter is present and the value is not empty, we
would throw an exception is the style passes is not valid.</p></li>
<li><p>GetStyles : the current behavior is to return all the classes as UserStyle
elements. the sld 1.0 specification does not seem to be clear on how to deal
when multiple styles are available : section 13.1 specifies “…All
requested styles that can in fact be described by SLD will be returned as
UserStyle elements, and styles that cannot be will returned as NamedStyle
elements. …”. The proposed approach is to keep the current beahviour if
the CLASSGROUP is not set and if set, to return UserStyle elements on
specified classes only.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Legend drawing would need to use the setting of the classgroup if it is
available</p></li>
</ol>
</section>
<section id="other-considerations">
<h2>Other Considerations<a class="headerlink" href="#other-considerations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Does this apply to all types of layers such as chart layers ?</p></li>
</ul>
</section>
<section id="files-affected">
<h2>Files Affected<a class="headerlink" href="#files-affected" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maplexer</span><span class="o">.</span><span class="n">l</span>
<span class="n">mapserver</span><span class="o">.</span><span class="n">h</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">h</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span>
<span class="n">mapogcsld</span><span class="o">.</span><span class="n">c</span>
<span class="n">mapwms</span><span class="o">.</span><span class="n">c</span>
<span class="n">maplegend</span><span class="o">.</span><span class="n">c</span>
<span class="n">mapcopy</span><span class="o">.</span><span class="n">c</span>
<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
</section>
<section id="mapscript">
<h2>MapScript<a class="headerlink" href="#mapscript" title="Link to this heading">¶</a></h2>
<p>Need to update set function (at least in the php MapScript) to set the two new
parameters at the layer and class level. Need to check if there is anything to
be done for swig MapScript.</p>
</section>
<section id="backwards-compatibility">
<h2>Backwards Compatibility<a class="headerlink" href="#backwards-compatibility" title="Link to this heading">¶</a></h2>
<p>All work described in this RFC will provide optional capabilities to MapServer
and no backward compatibility issues are expected.</p>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="../../ogc/sld.html#sld"><span class="std std-ref">SLD</span></a>, <a class="reference internal" href="../../ogc/wms_server.html#wms-server"><span class="std std-ref">WMS Server</span></a>, and <a class="reference internal" href="../../mapfile/index.html#mapfile"><span class="std std-ref">Mapfile</span></a> documents will be upgraded.</p>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading">¶</a></h2>
<p>Addition of a test in msauto to validate the support of names STYLES parameter
through a GetMap request</p>
</section>
<section id="bug-id">
<h2>Bug ID<a class="headerlink" href="#bug-id" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/MapServer/MapServer/issues/2431">https://github.com/MapServer/MapServer/issues/2431</a></p>
</section>
<section id="voting-history">
<h2>Voting History<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h2>
<p>+1: Assefa, TomK, FrankW
+0, DanielM, SteveW</p>
</section>
<section id="discussions-on-mailing-list">
<h2>Discussions on mailing list<a class="headerlink" href="#discussions-on-mailing-list" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://lists.osgeo.org/pipermail/mapserver-dev/2007-December/004727.html">https://lists.osgeo.org/pipermail/mapserver-dev/2007-December/004727.html</a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 39: Support of WMS/SLD Named Styles</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#proposed-changes">Proposed Changes</a></li>
<li><a class="reference internal" href="#affected-added-functionalities-in-mapserver">Affected/Added functionalities in MapServer</a></li>
<li><a class="reference internal" href="#other-considerations">Other Considerations</a></li>
<li><a class="reference internal" href="#files-affected">Files Affected</a></li>
<li><a class="reference internal" href="#mapscript">MapScript</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#bug-id">Bug ID</a></li>
<li><a class="reference internal" href="#voting-history">Voting History</a></li>
<li><a class="reference internal" href="#discussions-on-mailing-list">Discussions on mailing list</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-40.html" title="MS RFC 40: Support Label Text Transformations"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-38.html" title="MS RFC 38: Native Microsoft SQL Server 2008 Driver for MapServer"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 39: Support of WMS/SLD Named Styles</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>