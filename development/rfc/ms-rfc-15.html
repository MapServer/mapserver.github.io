<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 15: Support for thread neutral operation of MapServer/MapScript &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 16: MapScript WxS Services" href="ms-rfc-16.html" />
    <link rel="prev" title="MS RFC 14: Relative Coordinates for INLINE features" href="ms-rfc-14.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-15.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-16.html" title="MS RFC 16: MapScript WxS Services"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-14.html" title="MS RFC 14: Relative Coordinates for INLINE features"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 15: Support for thread neutral operation of MapServer/MapScript</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-15-support-for-thread-neutral-operation-of-mapserver-mapscript">
<span id="rfc15"></span><h1>MS RFC 15: Support for thread neutral operation of MapServer/MapScript<a class="headerlink" href="#ms-rfc-15-support-for-thread-neutral-operation-of-mapserver-mapscript" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2006/05/01</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Tamas Szekeres</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p>szekerest at gmail.com</p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Draft</p>
</dd>
<dt class="field-odd">Version<span class="colon">:</span></dt>
<dd class="field-odd"><p>Not assigned yet</p>
</dd>
</dl>
<section id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>By this time the core MapServer code has become widely used by many of the
different application models. The extended usage of MapScript causes the
possibility that the execution of the code is carried out by multiple
threads, standing a fair chance portions of the code being called by the
different threads simultaneously. The threading model of the application
may fall beyond the control of the MapServer code, at the worst case even
the host process of the application is beyond the programmer’s scope. For
example a web mapping application may be executed by a pre-existing host
process ensuring to serve the user requests and calling the MapServer code
by different threads from a pool of threads. The usage of process-wide global
variables and resources within MapServer may require the need to serialize
of the access to the variable by the multiple threads by using locks. The
current approach uses process-wide locks to ensure the safe access to these
variables causing performance degradation in multithreaded environments.
Currently this behavior may be controlled by the USE_THREAD
compilation switch.</p>
</section>
<section id="purpose">
<h2>2. Purpose<a class="headerlink" href="#purpose" title="Link to this heading">¶</a></h2>
<p>The purpose of this change is to get a significant performance boost by
removing “big locks” from the code. It would add a significant improvement of
the applications having high number of multiple threads executed
simultaneously. This activity could bring in a more feasible support for
some application models not really aimed at now like Microsoft ASP.NET. May
result in higher clarity of the code by determining the code segments
affected by multiple threads.</p>
</section>
<section id="general-principles-of-the-solution">
<h2>2. General principles of the solution<a class="headerlink" href="#general-principles-of-the-solution" title="Link to this heading">¶</a></h2>
<p>This RFC is in a special situation since wide area of the code is to be
reviewed and extensive developer support is needed. The proposal will reach
the proposed state only if all of the open issues are classified and
properly handled.</p>
<p>Changing of the modules of MapServer should be in accordance of the
primary maintainer. The maintainer may reserve the right to commit the
changes proposed by this RFC during the implementation phase. Otherwise the
primary author Tamas Szekeres will be responsible to make the changes.</p>
<p>The problems of the current implementation and the proposed changes will be
enumerated later. To handle these issues the following options will be
considered ordering by the expediency. The latter is the less expedient.</p>
</section>
<section id="not-changing-the-code-considering-as-safe-without-locks">
<h2>2.1 Not changing the code (Considering as safe without locks)<a class="headerlink" href="#not-changing-the-code-considering-as-safe-without-locks" title="Link to this heading">¶</a></h2>
<p>Some of the process-wide global variables store invariant data - like
enumerations - having been initialized at compilation time. Since these
variables can be simultaneously read by multiple threads there is nothing
to be done and even the locks should be removed - if exist - ensuring the
thread isolation to be realized. Might be redeclared as “static const”.</p>
</section>
<section id="retaining-the-variable-but-reconsidering-the-initialization-code">
<h2>2.2 Retaining the variable, but reconsidering the initialization code<a class="headerlink" href="#retaining-the-variable-but-reconsidering-the-initialization-code" title="Link to this heading">¶</a></h2>
<p>Some of the global variables store invariant data but the initial value is
assigned at run time during the module initialization phase. In this situation
we should ensure that the initialization will be done before the subsequent
access is receivable to prevent from the possibility of race conditions.
msSetup() is designated as a suitable place to make module level initialization
of the variables. Mapscript language bindings are encouraged to provide
calling msSetup automatically at module startup. The current locking
strategy should be reviewed and the locks should be restricted to the
initialization code.</p>
</section>
<section id="rewriting-the-code-to-eliminate-the-need-of-the-global-variable">
<h2>2.3 Rewriting the code to eliminate the need of the global variable<a class="headerlink" href="#rewriting-the-code-to-eliminate-the-need-of-the-global-variable" title="Link to this heading">¶</a></h2>
<p>If the global variable could be eliminated by changing the code structure we
will consider to make these changes. The locks related to these variables
should be removed.</p>
</section>
<section id="using-thread-local-variable-instead-of-the-global-one">
<h2>2.4 Using thread local variable instead of the global one<a class="headerlink" href="#using-thread-local-variable-instead-of-the-global-one" title="Link to this heading">¶</a></h2>
<p>When the usage of the global variable cannot be eliminated easily we will
consider to use thread local variables instead. To implement thread local
variables, theoretically we have at least 2 options to do:</p>
<ol class="arabic simple">
<li><p>By modifying the variable declaration we could use storage specifiers like
Microsoft specific “__declspec(thread)” or “__thread” on
the POSIX environments.</p></li>
<li><p>By implementing the allocation of the thread local memory utilizing the
platform dependent TLS APIs like the Windows TLS or the unix
Pthreads implementation.</p></li>
</ol>
<p>The first one is not applicable for MapServer  since the Microsoft
implementation does not allow delay loading of the dll containing variables
declared with __declspec(thread).</p>
<p>The second approach is applicable, however rewriting the existing code may be
more difficult. GDAL has a sample implementation for it might be taken over.</p>
</section>
<section id="not-changing-the-code-marking-as-safe-with-locks-will-be-reconsidered-later">
<h2>2.5 Not changing the code (Marking as safe with locks, will be reconsidered later)<a class="headerlink" href="#not-changing-the-code-marking-as-safe-with-locks-will-be-reconsidered-later" title="Link to this heading">¶</a></h2>
<p>Some of the MapServer code and/or the related external libraries may not be
modified easily and will be protected by locks in this phase of the
realization. These issues will be kept open and the solution for the thread
isolation might be reconsidered later. The open issues will be enumerated and
documented along with the MapServer source files and the thread safety FAQ</p>
<p><a class="reference external" href="http://mapserver.gis.umn.edu/docs/faq/thread_safety">http://mapserver.gis.umn.edu/docs/faq/thread_safety</a></p>
</section>
<section id="not-changing-the-code-marking-as-unsafe-will-be-deprecated-and-unsupported">
<h2>2.6 Not changing the code (Marking as unsafe, will be deprecated and unsupported)<a class="headerlink" href="#not-changing-the-code-marking-as-unsafe-will-be-deprecated-and-unsupported" title="Link to this heading">¶</a></h2>
<p>Having lack of support of portions of the existing code may keep from changing
the code easily. These portions of the code will not be modified in this
phase of the realization. These issues will be kept open and might be
reconsidered later. The open issues will be enumerated and documented
along with the MapServer source files and the thread safety FAQ.</p>
</section>
<section id="issues-of-the-mapserver-mapscript-code">
<h2>3. Issues of the MapServer /Mapscript code<a class="headerlink" href="#issues-of-the-mapserver-mapscript-code" title="Link to this heading">¶</a></h2>
<p>This chapter will enumerate the sections of the existing code should be
reconsidered according to the options mentioned previously. The line
numbers may slightly change according to the developers work.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">epplib</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">47</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">REVERSE</span><span class="p">;</span> <span class="o">/*</span> <span class="nb">set</span> <span class="n">to</span> <span class="mi">1</span> <span class="n">on</span> <span class="n">bigendian</span> <span class="n">machines</span> <span class="o">*/</span>
</pre></div>
</div>
<p>This variable is set in eppreset using the following code
{ union { long i; char c[4]; } u; u.i=1; REVERSE=(u.c[0]==0); }
should be set during the initialization or by the makefile as a predefined
constant. Also the MapServer configure script may include byte order
detection. This constant might be used by other modules.</p>
<p>SDL: This constant is limited to epplib.c…</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapcpl</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">57</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span>     <span class="n">szStaticResult</span><span class="p">[</span><span class="n">MS_PATH_BUF_SIZE</span><span class="p">];</span>
</pre></div>
</div>
<p>FrankW: In fact this code carried over from GDAL was later remodelled in GDAL.
It looks like msGetBasename() is only used in a few places and we should
remodel those to avoid using a static buffer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maperror</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">110</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">ms_errorCodes</span><span class="p">[</span><span class="n">MS_NUMERRORCODES</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="n">maperror</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">154</span><span class="p">):</span>    <span class="n">static</span> <span class="n">errorObj</span> <span class="n">ms_error</span> <span class="o">=</span> <span class="p">{</span><span class="n">MS_NOERR</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">};</span>
<span class="n">maperror</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">169</span><span class="p">):</span><span class="n">static</span> <span class="n">te_info_t</span> <span class="o">*</span><span class="n">error_list</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
<span class="n">maperror</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">552</span><span class="p">):</span>  <span class="n">static</span> <span class="n">char</span> <span class="n">version</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="n">maperror</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">651</span><span class="p">):</span>    <span class="n">static</span> <span class="n">char</span> <span class="n">nonblocking_set</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">184</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msUnits</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;INCHES&quot;</span><span class="p">,</span> <span class="s2">&quot;FEET&quot;</span><span class="p">,</span> <span class="s2">&quot;MILES&quot;</span><span class="p">,</span> <span class="s2">&quot;METERS&quot;</span><span class="p">,</span> <span class="s2">&quot;KILOMETERS&quot;</span><span class="p">,</span> <span class="s2">&quot;DD&quot;</span><span class="p">,</span>  <span class="s2">&quot;PIXELS&quot;</span><span class="p">,</span> <span class="s2">&quot;PERCENTAGES&quot;</span><span class="p">};</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">185</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msLayerTypes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;POINT&quot;</span><span class="p">,</span> <span class="s2">&quot;LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;POLYGON&quot;</span><span class="p">,</span> <span class="s2">&quot;RASTER&quot;</span><span class="p">,</span> <span class="s2">&quot;ANNOTATION&quot;</span><span class="p">,</span> <span class="s2">&quot;QUERY&quot;</span><span class="p">,</span> <span class="s2">&quot;CIRCLE&quot;</span><span class="p">,</span> <span class="s2">&quot;TILEINDEX&quot;</span><span class="p">};</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">186</span><span class="p">):</span><span class="n">char</span> <span class="o">*</span><span class="n">msPositionsText</span><span class="p">[</span><span class="n">MS_POSITIONS_LENGTH</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;UL&quot;</span><span class="p">,</span> <span class="s2">&quot;LR&quot;</span><span class="p">,</span> <span class="s2">&quot;UR&quot;</span><span class="p">,</span> <span class="s2">&quot;LL&quot;</span><span class="p">,</span> <span class="s2">&quot;CR&quot;</span><span class="p">,</span> <span class="s2">&quot;CL&quot;</span><span class="p">,</span> <span class="s2">&quot;UC&quot;</span><span class="p">,</span> <span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="s2">&quot;CC&quot;</span><span class="p">,</span> <span class="s2">&quot;AUTO&quot;</span><span class="p">,</span> <span class="s2">&quot;XY&quot;</span><span class="p">,</span> <span class="s2">&quot;FOLLOW&quot;</span><span class="p">};</span> <span class="o">/*</span> <span class="n">msLabelPositions</span><span class="p">[]</span> <span class="n">also</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">mapsymbols</span><span class="o">.</span><span class="n">c</span> <span class="p">(</span><span class="ow">not</span> <span class="n">static</span><span class="p">)</span> <span class="o">*/</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">187</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msBitmapFontSizes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TINY&quot;</span><span class="p">,</span> <span class="s2">&quot;SMALL&quot;</span><span class="p">,</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span> <span class="s2">&quot;LARGE&quot;</span><span class="p">,</span> <span class="s2">&quot;GIANT&quot;</span><span class="p">};</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">188</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msQueryMapStyles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;NORMAL&quot;</span><span class="p">,</span> <span class="s2">&quot;HILITE&quot;</span><span class="p">,</span> <span class="s2">&quot;SELECTED&quot;</span><span class="p">,</span> <span class="s2">&quot;INVERTED&quot;</span><span class="p">};</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">189</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msStatus</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;OFF&quot;</span><span class="p">,</span> <span class="s2">&quot;ON&quot;</span><span class="p">,</span> <span class="s2">&quot;DEFAULT&quot;</span><span class="p">,</span> <span class="s2">&quot;EMBED&quot;</span><span class="p">};</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">191</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msTrueFalse</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;FALSE&quot;</span><span class="p">,</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">};</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">193</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msJoinType</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ONE-TO-ONE&quot;</span><span class="p">,</span> <span class="s2">&quot;ONE-TO-MANY&quot;</span><span class="p">};</span>
</pre></div>
</div>
<p>The above are all const static data, being handled as 2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">239</span><span class="p">):</span><span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">PNGsig</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">137</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">10</span><span class="p">};</span> <span class="o">/*</span> <span class="mi">89</span> <span class="mi">50</span> <span class="mi">4</span><span class="n">E</span> <span class="mi">47</span> <span class="mi">0</span><span class="n">D</span> <span class="mi">0</span><span class="n">A</span> <span class="mi">1</span><span class="n">A</span> <span class="mi">0</span><span class="n">A</span> <span class="nb">hex</span> <span class="o">*/</span>
<span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">240</span><span class="p">):</span><span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">JPEGsig</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">255</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">255</span><span class="p">};</span> <span class="o">/*</span> <span class="n">FF</span> <span class="n">D8</span> <span class="n">FF</span> <span class="nb">hex</span> <span class="o">*/</span>
<span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">911</span><span class="p">):</span>  <span class="n">static</span> <span class="n">gdPoint</span> <span class="n">points</span><span class="p">[</span><span class="mi">38</span><span class="p">];</span>
<span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">2428</span><span class="p">):</span>  <span class="n">static</span> <span class="n">double</span> <span class="n">last_style_size</span><span class="p">;</span>
<span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">2719</span><span class="p">):</span>  <span class="n">static</span> <span class="nb">int</span> <span class="n">styleIndex</span><span class="p">,</span> <span class="n">styleVis</span><span class="p">;</span>
<span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">2720</span><span class="p">):</span>  <span class="n">static</span> <span class="n">double</span> <span class="n">styleSize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">styleCoef</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_style_size</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">mapgd</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">2721</span><span class="p">):</span>  <span class="n">static</span> <span class="nb">int</span> <span class="n">last_style_c</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">last_style_stylelength</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">last_styleVis</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapgdal</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">141</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span>    <span class="n">bGDALInitialized</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>Will be handled as 2.2. (Startup initialization)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapgeos</span><span class="o">.</span><span class="n">cpp</span><span class="p">(</span><span class="mi">98</span><span class="p">):</span><span class="n">GeometryFactory</span> <span class="o">*</span><span class="n">gf</span><span class="o">=</span><span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>Will be handled as 2.2. (Startup initialization)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maphttp</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">140</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">gbCurlInitialized</span> <span class="o">=</span> <span class="n">MS_FALSE</span><span class="p">;</span>
</pre></div>
</div>
<p>Will be handled as 2.2. (Startup initialization)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">141</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">layerlist</span><span class="o">=</span><span class="n">NULL</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">142</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">layersize</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">143</span><span class="p">):</span><span class="n">static</span> <span class="n">pString</span> <span class="n">imgStr</span><span class="p">,</span> <span class="n">layerStr</span><span class="o">=</span><span class="p">{</span> <span class="o">&amp;</span><span class="n">layerlist</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">layersize</span><span class="p">,</span> <span class="mi">0</span> <span class="p">};</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">146</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">polyHrefFmt</span><span class="p">,</span> <span class="o">*</span><span class="n">polyMOverFmt</span><span class="p">,</span> <span class="o">*</span><span class="n">polyMOutFmt</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">147</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">symbolHrefFmt</span><span class="p">,</span> <span class="o">*</span><span class="n">symbolMOverFmt</span><span class="p">,</span> <span class="o">*</span><span class="n">symbolMOutFmt</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">148</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">mapName</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">150</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">suppressEmpty</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">229</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">lastcolor</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">273</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span><span class="o">*</span> <span class="n">lname</span><span class="p">;</span>
<span class="n">mapimagemap</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">274</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">dxf</span><span class="p">;</span>
</pre></div>
</div>
<p>Imagemap support is not widely used, will be handled as 2.6 for now. Still waiting for comments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">67</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">is_msIO_initialized</span> <span class="o">=</span> <span class="n">MS_FALSE</span><span class="p">;</span>
<span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">69</span><span class="p">):</span><span class="n">static</span> <span class="n">msIOContext</span> <span class="n">default_stdin_context</span><span class="p">;</span>
<span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">70</span><span class="p">):</span><span class="n">static</span> <span class="n">msIOContext</span> <span class="n">default_stdout_context</span><span class="p">;</span>
<span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">71</span><span class="p">):</span><span class="n">static</span> <span class="n">msIOContext</span> <span class="n">default_stderr_context</span><span class="p">;</span>
<span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">73</span><span class="p">):</span><span class="n">static</span> <span class="n">msIOContext</span> <span class="n">current_stdin_context</span><span class="p">;</span>
<span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">74</span><span class="p">):</span><span class="n">static</span> <span class="n">msIOContext</span> <span class="n">current_stdout_context</span><span class="p">;</span>
<span class="n">mapio</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span><span class="n">static</span> <span class="n">msIOContext</span> <span class="n">current_stderr_context</span><span class="p">;</span>
</pre></div>
</div>
<p>FrankW: Currently there is only one process wide set of “io handlers” for io.  This will almost certainly need to change at some point to be thread local in some fashion.  I hope to address this when I work on the redirectable OWS services accessible from MapScript this spring.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">220</span><span class="p">):</span><span class="n">static</span> <span class="n">YY_BUFFER_STATE</span> <span class="n">yy_current_buffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">230</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="n">yy_hold_char</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">232</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">yy_n_chars</span><span class="p">;</span>         <span class="o">/*</span> <span class="n">number</span> <span class="n">of</span> <span class="n">characters</span> <span class="n">read</span> <span class="n">into</span> <span class="n">yy_ch_buf</span> <span class="o">*/</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">238</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">yy_c_buf_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span> <span class="o">*</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">239</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">yy_init</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>                <span class="o">/*</span> <span class="n">whether</span> <span class="n">we</span> <span class="n">need</span> <span class="n">to</span> <span class="n">initialize</span> <span class="o">*/</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">240</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">yy_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>       <span class="o">/*</span> <span class="n">start</span> <span class="n">state</span> <span class="n">number</span> <span class="o">*/</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">245</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">yy_did_buffer_switch_on_eof</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">306</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="n">short</span> <span class="nb">int</span> <span class="n">yy_accept</span><span class="p">[</span><span class="mi">2442</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">579</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="nb">int</span> <span class="n">yy_ec</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">611</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="nb">int</span> <span class="n">yy_meta</span><span class="p">[</span><span class="mi">52</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">621</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="n">short</span> <span class="nb">int</span> <span class="n">yy_base</span><span class="p">[</span><span class="mi">2456</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">895</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="n">short</span> <span class="nb">int</span> <span class="n">yy_def</span><span class="p">[</span><span class="mi">2456</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1169</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="n">short</span> <span class="nb">int</span> <span class="n">yy_nxt</span><span class="p">[</span><span class="mi">2776</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1478</span><span class="p">):</span><span class="n">static</span> <span class="n">yyconst</span> <span class="n">short</span> <span class="nb">int</span> <span class="n">yy_chk</span><span class="p">[</span><span class="mi">2776</span><span class="p">]</span> <span class="o">=</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1787</span><span class="p">):</span><span class="n">static</span> <span class="n">yy_state_type</span> <span class="n">yy_last_accepting_state</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1788</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">yy_last_accepting_cpos</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1886</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">yy_start_stack_ptr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1887</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">yy_start_stack_depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1888</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="o">*</span><span class="n">yy_start_stack</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>According to Steve’s suggestions we will address this with newer versions
flex and bison invoked appropriately.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapmygis</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">245</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">gBYTE_ORDER</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapogcsos</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1974</span><span class="p">):</span>    <span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">request</span><span class="o">=</span><span class="n">NULL</span><span class="p">,</span> <span class="o">*</span><span class="n">service</span><span class="o">=</span><span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapogr</span><span class="o">.</span><span class="n">cpp</span><span class="p">(</span><span class="mi">840</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">bOGRDriversRegistered</span> <span class="o">=</span> <span class="n">MS_FALSE</span><span class="p">;</span>
</pre></div>
</div>
<p>Will be handled as 2.2. (Startup initialization)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapows</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1647</span><span class="p">):</span>  <span class="n">static</span> <span class="n">char</span> <span class="n">epsgCode</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">282</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yytranslate</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">317</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yyprhs</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">328</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">yysigned_char</span> <span class="n">yyrhs</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">354</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">short</span> <span class="n">yyrline</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">368</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">const</span> <span class="n">yytname</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">381</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">short</span> <span class="n">yytoknum</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">391</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yyr1</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">402</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yyr2</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">415</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yydefact</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">431</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">yysigned_char</span> <span class="n">yydefgoto</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">439</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">short</span> <span class="n">yypact</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">455</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">yysigned_char</span> <span class="n">yypgoto</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">465</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yytable</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">491</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">yysigned_char</span> <span class="n">yycheck</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapparser</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">519</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">yystos</span><span class="p">[]</span> <span class="o">=</span>
</pre></div>
</div>
<p>According to Steve’s suggestions we will address this with newer versions
flex and bison invoked appropriately.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mappluginlayer</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">46</span><span class="p">):</span><span class="n">static</span> <span class="n">VTFactoryObj</span> <span class="n">gVirtualTableFactory</span> <span class="o">=</span> <span class="p">{</span><span class="n">MS_MAXLAYERS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{</span><span class="n">NULL</span><span class="p">}};</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mappool</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">206</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">connectionCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mappool</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">207</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">connectionMax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mappool</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">208</span><span class="p">):</span><span class="n">static</span> <span class="n">connectionObj</span> <span class="o">*</span><span class="n">connections</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapproject</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">889</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">ms_proj_lib</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
<span class="n">mapproject</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">890</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">last_filename</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
<span class="n">mapproject</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">918</span><span class="p">):</span>    <span class="n">static</span> <span class="nb">int</span> <span class="n">finder_installed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapscale</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">68</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">unitText</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="s2">&quot;ft&quot;</span><span class="p">,</span> <span class="s2">&quot;mi&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;km&quot;</span><span class="p">};</span>
<span class="n">mapscale</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">69</span><span class="p">):</span><span class="n">double</span> <span class="n">inchesPerUnit</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">63360.0</span><span class="p">,</span> <span class="mf">39.3701</span><span class="p">,</span> <span class="mf">39370.1</span><span class="p">,</span> <span class="mi">4374754</span><span class="p">};</span>
</pre></div>
</div>
<p>const static data, being handled as 2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapsde</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">216</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">lcacheCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mapsde</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">217</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">lcacheMax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mapsde</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">218</span><span class="p">):</span><span class="n">static</span> <span class="n">layerId</span> <span class="o">*</span><span class="n">lcache</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapserv</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1196</span><span class="p">):</span>        <span class="n">static</span> <span class="nb">int</span> <span class="n">nRequestCounter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>Considering safe without locks (2.1). The <a class="reference internal" href="../../cgi/mapserv.html#mapserv"><span class="std std-ref">mapserv</span></a> application does not
involved in multiple threads.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapshape</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">70</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span>      <span class="n">bBigEndian</span><span class="p">;</span>
</pre></div>
</div>
<p>Should be handled as
epplib.c(47):static int REVERSE;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapsvg</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">164</span><span class="p">):</span>    <span class="n">static</span> <span class="n">char</span> <span class="n">epsgCode</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="n">mapsvg</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">165</span><span class="p">):</span>    <span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">value</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapswf</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">97</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="n">gszFilename</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
<span class="n">mapswf</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">98</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="n">gszAction</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
<span class="n">mapswf</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">99</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="n">gszTmp</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapsymbol</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">154</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">msCapsJoinsCorners</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span> <span class="s2">&quot;BEVEL&quot;</span><span class="p">,</span> <span class="s2">&quot;BUTT&quot;</span><span class="p">,</span> <span class="s2">&quot;MITER&quot;</span><span class="p">,</span> <span class="s2">&quot;ROUND&quot;</span><span class="p">,</span> <span class="s2">&quot;SQUARE&quot;</span><span class="p">,</span> <span class="s2">&quot;TRIANGLE&quot;</span><span class="p">};</span>
</pre></div>
</div>
<p>const static data, being handled as 2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">196</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">thread_debug</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">198</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">lock_names</span><span class="p">[]</span> <span class="o">=</span>
</pre></div>
</div>
<p>const static data, being handled as 2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">213</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">mutexes_initialized</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">214</span><span class="p">):</span><span class="n">static</span> <span class="n">pthread_mutex_t</span> <span class="n">mutex_locks</span><span class="p">[</span><span class="n">TLOCK_MAX</span><span class="p">];</span>
<span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">223</span><span class="p">):</span>    <span class="n">static</span> <span class="n">pthread_mutex_t</span> <span class="n">core_lock</span> <span class="o">=</span> <span class="n">PTHREAD_MUTEX_INITIALIZER</span><span class="p">;</span>
<span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">294</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">mutexes_initialized</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">295</span><span class="p">):</span><span class="n">static</span> <span class="n">HANDLE</span> <span class="n">mutex_locks</span><span class="p">[</span><span class="n">TLOCK_MAX</span><span class="p">];</span>
<span class="n">mapthread</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">305</span><span class="p">):</span>    <span class="n">static</span> <span class="n">HANDLE</span> <span class="n">core_lock</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>Should be handled as 2.2. (Startup initialization). Initialized in msThreadInit();</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maputil</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1068</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">tmpCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">maputil</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1069</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">ForcedTmpBase</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapwms</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">252</span><span class="p">):</span><span class="n">static</span> <span class="n">char</span> <span class="o">*</span><span class="n">wms_exception_format</span><span class="o">=</span><span class="n">NULL</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">md5c</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">58</span><span class="p">):</span><span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">PADDING</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</pre></div>
</div>
<p>const static data, being handled as 2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">strptime</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">43</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">abb_weekdays</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">strptime</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">54</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">full_weekdays</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">strptime</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">65</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">abb_month</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">strptime</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">81</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">full_month</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">strptime</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">97</span><span class="p">):</span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">ampm</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</pre></div>
</div>
<p>const static data, being handled as 2.1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdft</span>\<span class="n">gdkanji</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">103</span><span class="p">):</span>   <span class="n">static</span> <span class="nb">int</span> <span class="n">whatcode</span><span class="p">;</span>
<span class="n">gdft</span>\<span class="n">gdkanji</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">403</span><span class="p">):</span>   <span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">tmp</span><span class="p">[</span><span class="n">BUFSIZ</span><span class="p">];</span>
<span class="n">gdft</span>\<span class="n">gdkanji</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">489</span><span class="p">):</span>   <span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">tmp_dest</span><span class="p">[</span><span class="n">BUFSIZ</span><span class="p">];</span>
</pre></div>
</div>
<p>SDL: gdft and it’s contents are not part of MapServer distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdft</span>\<span class="n">gdttf</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">712</span><span class="p">):</span>  <span class="n">static</span> <span class="n">gdCache_head_t</span> <span class="o">*</span><span class="n">tweenColorCache</span><span class="o">=</span><span class="n">NULL</span><span class="p">;</span> <span class="o">/******</span> <span class="nb">set</span> <span class="n">up</span> <span class="n">tweenColorCache</span> <span class="n">on</span> <span class="n">first</span> <span class="n">call</span> <span class="o">************/</span>
<span class="n">gdft</span>\<span class="n">gdttf</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">852</span><span class="p">):</span>  <span class="n">static</span> <span class="n">gdCache_head_t</span>      <span class="o">*</span><span class="n">fontCache</span><span class="o">=</span><span class="n">NULL</span><span class="p">;</span> <span class="o">/******</span> <span class="n">initialize</span> <span class="n">font</span> <span class="n">engine</span> <span class="n">on</span> <span class="n">first</span> <span class="n">call</span> <span class="o">************/</span>
<span class="n">gdft</span>\<span class="n">gdttf</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">853</span><span class="p">):</span>  <span class="n">static</span> <span class="n">TT_Engine</span>   <span class="n">engine</span><span class="p">;</span>
</pre></div>
</div>
<p>SDL: gdft and it’s contents are not part of MapServer distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdft</span>\<span class="n">jisx0208</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span><span class="n">static</span> <span class="n">unsigned</span> <span class="n">short</span> <span class="n">UnicodeTbl</span><span class="p">[][</span><span class="mi">94</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</pre></div>
</div>
<p>SDL: gdft and it’s contents are not part of MapServer distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mapscript\csharp\csmodule.i(32):               static $moduleHelper()
mapscript\csharp\csmodule.i(41):       static $moduleHelper the$moduleHelper = new $moduleHelper();
</pre></div>
</div>
<p>Initialization startup code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">mapscript_i</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">223</span><span class="p">):</span>    <span class="n">static</span> <span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">mapscript_i</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1137</span><span class="p">):</span>        <span class="n">static</span> <span class="n">char</span> <span class="n">pszFieldName</span><span class="p">[</span><span class="mi">1000</span><span class="p">];</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">789</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msmap</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">790</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mslayer</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">791</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msimg</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">792</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msclass</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">793</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mslabel</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">794</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mscolor</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">795</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msrect_new</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">796</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msrect_ref</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">797</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mspoint_new</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">798</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mspoint_ref</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">799</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msline_new</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">800</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msline_ref</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">801</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msshape_new</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">802</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msshape_ref</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">803</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msshapefile</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">804</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msweb</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">805</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msrefmap</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">806</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msprojection_new</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">807</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msprojection_ref</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">808</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msscalebar</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">809</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mslegend</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">810</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msstyle</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">811</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msoutputformat</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">812</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msgrid</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">813</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mserror_ref</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">814</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mslabelcache</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">815</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_mssymbol</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">816</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_msquerymap</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">857</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">map_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">858</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">img_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">859</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">rect_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">860</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">color_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">861</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">web_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">862</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">reference_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">863</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">layer_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">864</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">label_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">865</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">class_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">866</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">point_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">867</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">line_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">868</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">shape_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">869</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">shapefile_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">870</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">projection_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">871</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">scalebar_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">872</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">legend_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">873</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">style_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">874</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">outputformat_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">875</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">grid_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">876</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">error_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">877</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">labelcache_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">878</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">symbol_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">879</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">querymap_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">891</span><span class="p">):</span><span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">one_arg_force_ref</span><span class="p">[]</span> <span class="o">=</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_mapscript</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">893</span><span class="p">):</span><span class="n">static</span> <span class="n">unsigned</span> <span class="n">char</span> <span class="n">two_args_first_arg_force_ref</span><span class="p">[]</span> <span class="o">=</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_proj</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">196</span><span class="p">):</span><span class="n">static</span> <span class="n">zend_class_entry</span> <span class="o">*</span><span class="n">proj_class_entry_ptr</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_proj</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span><span class="n">static</span> <span class="nb">int</span> <span class="n">le_projobj</span><span class="p">;</span>
<span class="n">mapscript</span>\<span class="n">php3</span>\<span class="n">php_proj</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">294</span><span class="p">):</span><span class="n">static</span> <span class="n">long</span> <span class="n">_php_proj_build_proj_object</span><span class="p">(</span><span class="n">PJ</span> <span class="o">*</span><span class="n">pj</span><span class="p">,</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapscript</span>\<span class="n">swiginc</span>\<span class="n">dbfinfo</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>        <span class="n">static</span> <span class="n">char</span> <span class="n">pszFieldName</span><span class="p">[</span><span class="mi">1000</span><span class="p">];</span>
</pre></div>
</div>
<p>TODO</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapscript</span>\<span class="n">swiginc</span>\<span class="nb">map</span><span class="o">.</span><span class="n">i</span><span class="p">(</span><span class="mi">204</span><span class="p">):</span>    <span class="n">static</span> <span class="nb">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>TODO</p>
</section>
<section id="issues-of-the-related-libraries">
<h2>3. Issues of the related libraries<a class="headerlink" href="#issues-of-the-related-libraries" title="Link to this heading">¶</a></h2>
<p>TODO</p>
</section>
<section id="considerations-for-the-future-development">
<h2>4. Considerations for the future development<a class="headerlink" href="#considerations-for-the-future-development" title="Link to this heading">¶</a></h2>
<p>Developers should keep in mind that their code may be called by multiple
threads simultaneously. Using process-wide global variables modified at run
time will be discouraged in the future. If the usage is inevitable the
variables should be protected by using mutual exclusion properly depending
on the USE_THREAD constant.</p>
</section>
<section id="backwards-compatibility-issues">
<h2>5. Backwards compatibility issues<a class="headerlink" href="#backwards-compatibility-issues" title="Link to this heading">¶</a></h2>
<p>This is binary and source code level backward incompatible change.
The compatibility of the mapscript interface might be kept.</p>
</section>
<section id="bug-id">
<h2>Bug ID<a class="headerlink" href="#bug-id" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>The following bug is added as a primary source for collecting the developer</dt><dd><p>and user response. Nevertheless the MapServer users and developers list
will also be monitored and the RFC will be updated accordingly by the
primary author.</p>
</dd>
</dl>
<p>Bug <a class="reference external" href="https://github.com/MapServer/MapServer/issues/1764">1764</a></p>
</section>
<section id="voting-history">
<h2>Voting history<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h2>
<p>Still not proposed for voting</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 15: Support for thread neutral operation of MapServer/MapScript</a><ul>
<li><a class="reference internal" href="#overview">1. Overview</a></li>
<li><a class="reference internal" href="#purpose">2. Purpose</a></li>
<li><a class="reference internal" href="#general-principles-of-the-solution">2. General principles of the solution</a></li>
<li><a class="reference internal" href="#not-changing-the-code-considering-as-safe-without-locks">2.1 Not changing the code (Considering as safe without locks)</a></li>
<li><a class="reference internal" href="#retaining-the-variable-but-reconsidering-the-initialization-code">2.2 Retaining the variable, but reconsidering the initialization code</a></li>
<li><a class="reference internal" href="#rewriting-the-code-to-eliminate-the-need-of-the-global-variable">2.3 Rewriting the code to eliminate the need of the global variable</a></li>
<li><a class="reference internal" href="#using-thread-local-variable-instead-of-the-global-one">2.4 Using thread local variable instead of the global one</a></li>
<li><a class="reference internal" href="#not-changing-the-code-marking-as-safe-with-locks-will-be-reconsidered-later">2.5 Not changing the code (Marking as safe with locks, will be reconsidered later)</a></li>
<li><a class="reference internal" href="#not-changing-the-code-marking-as-unsafe-will-be-deprecated-and-unsupported">2.6 Not changing the code (Marking as unsafe, will be deprecated and unsupported)</a></li>
<li><a class="reference internal" href="#issues-of-the-mapserver-mapscript-code">3. Issues of the MapServer /Mapscript code</a></li>
<li><a class="reference internal" href="#issues-of-the-related-libraries">3. Issues of the related libraries</a></li>
<li><a class="reference internal" href="#considerations-for-the-future-development">4. Considerations for the future development</a></li>
<li><a class="reference internal" href="#backwards-compatibility-issues">5. Backwards compatibility issues</a></li>
<li><a class="reference internal" href="#bug-id">Bug ID</a></li>
<li><a class="reference internal" href="#voting-history">Voting history</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-16.html" title="MS RFC 16: MapScript WxS Services"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-14.html" title="MS RFC 14: Relative Coordinates for INLINE features"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 15: Support for thread neutral operation of MapServer/MapScript</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>