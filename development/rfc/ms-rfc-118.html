<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 118: Support Vendor-Specific OGC FILTER parameter in WMS requests &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 119: Mapbox Vector Tile (MVT) Support" href="ms-rfc-119.html" />
    <link rel="prev" title="MS RFC 117: PHP 7 MapScript Support Through SWIG" href="ms-rfc-117.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-118.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-119.html" title="MS RFC 119: Mapbox Vector Tile (MVT) Support"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-117.html" title="MS RFC 117: PHP 7 MapScript Support Through SWIG"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 118: Support Vendor-Specific OGC FILTER parameter in WMS requests</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-118-support-vendor-specific-ogc-filter-parameter-in-wms-requests">
<span id="rfc118"></span><h1>MS RFC 118: Support Vendor-Specific OGC FILTER parameter in WMS requests<a class="headerlink" href="#ms-rfc-118-support-vendor-specific-ogc-filter-parameter-in-wms-requests" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2017-02-09</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Daniel Morissette</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:dmorissette&#37;&#52;&#48;mapgears&#46;com">dmorissette<span>&#64;</span>mapgears<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Adopted</p>
</dd>
<dt class="field-odd">Last update<span class="colon">:</span></dt>
<dd class="field-odd"><p>2017-09-20</p>
</dd>
<dt class="field-even">Version<span class="colon">:</span></dt>
<dd class="field-even"><p>MapServer 7.2</p>
</dd>
</dl>
<section id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>It is common practice for JS client applications to let the users make selections or apply filters on the client side that should be reflected on the map that is rendered by a WMS GetMap request.</p>
<p>At the moment, there is no simple way to pass a filter to a WMS GetMap request, so JS application developers have to resort to one of the following methods/hacks:</p>
<ul class="simple">
<li><p>Apply a SLD to the GetMap request: overkill especially when only a simple filter is required and needs to be applied to multiple layers with complex symbology</p></li>
<li><p>Use %variable% replacements: limited functionality, messes up your layer definitions and is prone to security issues</p></li>
<li><p>Create temporary mapfiles on the server side: hey, we are in 2017!</p></li>
</ul>
<p>The OpenLayers3 code already makes it possible for JS devs to build and pass an OGC filter in a WMS GetMap request the same way as for WFS GetFeature requests, and GeoServer already supports this as a vendor-specific parameter, so this RFC proposes to support the same vendor-specific FILTER parameter in MapServer.</p>
</section>
<section id="proposed-solution">
<h2>2. Proposed solution<a class="headerlink" href="#proposed-solution" title="Link to this heading">¶</a></h2>
<p>This RFC proposes the implementation of a vendor-specific FILTER parameter in the MapServer WMS server interface that operates like the WFS GetFeature FILTER parameter.</p>
</section>
<section id="the-wms-filter-parameter">
<h2>2.1 The WMS FILTER parameter<a class="headerlink" href="#the-wms-filter-parameter" title="Link to this heading">¶</a></h2>
<p>The WMS FILTER parameter will be supported in both GetMap and GetFeatureInfo requests. The syntax and format is the same that is currently supported by the WFS GetFeature FILTER parameter. As for any GET HTTP request parameters, the value will have to be properly URL encoded.</p>
<p>If more than one layer is specified in the LAYERS parameter then a separate FILTER must be specified for each layer.  In this case the list is enclosed in parentheses: ( ).</p>
</section>
<section id="examples">
<h2>2.2 Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<p>Simple PropertyIsEqualTo on a single layer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/cgi-bin/mapserv?map=...
&amp;SERVICE=WMS
&amp;REQUEST=GetMap
&amp;LAYERS=popplace
&amp;FILTER=&lt;Filter&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/Filter&gt;
&amp;...
</pre></div>
</div>
<p>DWithin spatial filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/cgi-bin/mapserv?map=...
&amp;SERVICE=WMS
&amp;REQUEST=GetMap
&amp;LAYERS=popplace
&amp;FILTER=&lt;Filter&gt;&lt;DWithin&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Point&gt;&lt;gml:coordinates&gt;-60.18,46.10&lt;/gml:coordinates&gt;&lt;/gml:Point&gt;&lt;Distance units=&#39;dd&#39;&gt;0.05&lt;/Distance&gt;&lt;/DWithin&gt;&lt;/Filter&gt;
&amp;...
</pre></div>
</div>
<p>Filter on multiple layers enclosed in parentheses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/cgi-bin/mapserv?map=...
&amp;SERVICE=WMS
&amp;REQUEST=GetMap
&amp;LAYERS=road,popplace
&amp;FILTER=(&lt;Filter&gt;&lt;DWithin&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Point&gt;&lt;gml:coordinates&gt;46,-63&lt;/gml:coordinates&gt;&lt;/gml:Point&gt;&lt;Distance units=&#39;dd&#39;&gt;0.5&lt;/Distance&gt;&lt;/DWithin&gt;&lt;/Filter&gt;)(&lt;Filter&gt;&lt;DWithin&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Point&gt;&lt;gml:coordinates&gt;46,-63&lt;/gml:coordinates&gt;&lt;/gml:Point&gt;&lt;Distance units=&#39;dd&#39;&gt;0.5&lt;/Distance&gt;&lt;/DWithin&gt;&lt;/Filter&gt;)
&amp;...
</pre></div>
</div>
<p>GetMap on multiple layers, with empty filter on some layers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/cgi-bin/mapserv?map=...
&amp;SERVICE=WMS
&amp;REQUEST=GetMap
&amp;LAYERS=road,popplace
&amp;FILTER=()(&lt;Filter&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/Filter&gt;)
&amp;...
</pre></div>
</div>
</section>
<section id="implementation-details">
<h2>3. Implementation Details<a class="headerlink" href="#implementation-details" title="Link to this heading">¶</a></h2>
<p>The internal WFS GetFeature FILTER handling code is closely tied to the WFS interface. It will have to be made generic in order to be usable by both the WFS and WMS interfaces.</p>
<p>Tests will be added to msautotest for the new feature.</p>
</section>
<section id="limitations">
<h2>4. Limitations<a class="headerlink" href="#limitations" title="Link to this heading">¶</a></h2>
<p>This will only be implemented for GET requests, and will be subject to the limitation in URL length of the HTTP servers. The exact limit of GET URL length depends on the server configuration.</p>
<p>The use of FILTER in WMS requires previous knowledge of the geometry and attribute column names that would normally be obtained with a WFS DescribeFeatureType.  While this is not strictly required for the FILTER to work on their own in the GetMap request, access to DescribeFeatureType can be provided by enabling the WFS interface on the corresponding layers.</p>
<p>Since rendering of the filtered layers is done via the QUERYMAP mechanism, the MASK, OPACITY and COMPOSITE settings are ignored since they are not implemented for QUERYMAPs. (This could be considered a QUERYMAP bug but is out of scope for this RFC)</p>
</section>
<section id="backwards-compatibility-issues">
<h2>5. Backwards Compatibility Issues<a class="headerlink" href="#backwards-compatibility-issues" title="Link to this heading">¶</a></h2>
<p>None anticipated.</p>
</section>
<section id="security-implications">
<h2>6. Security implications<a class="headerlink" href="#security-implications" title="Link to this heading">¶</a></h2>
<p>None anticipated. If anything, this will generally improve the security of servers which will no longer have to rely on %variable% embedded in their data statements.</p>
</section>
<section id="performance-implications">
<h2>7. Performance implications<a class="headerlink" href="#performance-implications" title="Link to this heading">¶</a></h2>
<p>No impacts on core performance are anticipated.</p>
</section>
<section id="documentation-needs">
<h2>8. Documentation needs<a class="headerlink" href="#documentation-needs" title="Link to this heading">¶</a></h2>
<p>Documentation for this vendor-specific parameter will be added to the relevant section of the WMS Server documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://mapserver.org/ogc/wms_server.html#vendor-specific-wms-parameters">https://mapserver.org/ogc/wms_server.html#vendor-specific-wms-parameters</a></p></li>
</ul>
</section>
<section id="bug-id-and-references">
<h2>9. Bug ID and references<a class="headerlink" href="#bug-id-and-references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>GeoServer FILTER parameter: <a class="reference external" href="http://docs.geoserver.org/latest/en/user/services/wms/vendor.html#filter">http://docs.geoserver.org/latest/en/user/services/wms/vendor.html#filter</a></p></li>
</ul>
</section>
<section id="voting-history">
<h2>10. Voting history<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h2>
<p>+1 from TomK, SteveL, JukkaR, SteveW, MichaelS, StephanM, JeffM and DanielM.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 118: Support Vendor-Specific OGC FILTER parameter in WMS requests</a><ul>
<li><a class="reference internal" href="#overview">1. Overview</a></li>
<li><a class="reference internal" href="#proposed-solution">2. Proposed solution</a></li>
<li><a class="reference internal" href="#the-wms-filter-parameter">2.1 The WMS FILTER parameter</a></li>
<li><a class="reference internal" href="#examples">2.2 Examples</a></li>
<li><a class="reference internal" href="#implementation-details">3. Implementation Details</a></li>
<li><a class="reference internal" href="#limitations">4. Limitations</a></li>
<li><a class="reference internal" href="#backwards-compatibility-issues">5. Backwards Compatibility Issues</a></li>
<li><a class="reference internal" href="#security-implications">6. Security implications</a></li>
<li><a class="reference internal" href="#performance-implications">7. Performance implications</a></li>
<li><a class="reference internal" href="#documentation-needs">8. Documentation needs</a></li>
<li><a class="reference internal" href="#bug-id-and-references">9. Bug ID and references</a></li>
<li><a class="reference internal" href="#voting-history">10. Voting history</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-119.html" title="MS RFC 119: Mapbox Vector Tile (MVT) Support"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-117.html" title="MS RFC 117: PHP 7 MapScript Support Through SWIG"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 118: Support Vendor-Specific OGC FILTER parameter in WMS requests</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>