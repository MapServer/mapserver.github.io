<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MS RFC 98: Label/Text Rendering Overhaul &mdash; MapServer 7.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="top" title="MapServer 7.0.0 documentation" href="../../index.html" />
    <link rel="up" title="Request for Comments" href="index.html" />
    <link rel="next" title="MS RFC 99: Remove support for GD renderer" href="ms-rfc-99.html" />
    <link rel="prev" title="MS RFC 97: Dynamic creation of higher zoom levels tiles" href="ms-rfc-97.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../faq.html" title="FAQ">FAQ</a> |
      <a href="../../download.html" title="Download">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        
        
          <a href="../../uk/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/uk.png" alt="uk" title="uk" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-99.html" title="MS RFC 99: Remove support for GD renderer"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-97.html" title="MS RFC 97: Dynamic creation of higher zoom levels tiles"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ms-rfc-98-label-text-rendering-overhaul">
<span id="rfc98"></span><h1>MS RFC 98: Label/Text Rendering Overhaul<a class="headerlink" href="#ms-rfc-98-label-text-rendering-overhaul" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">2013/06</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Thomas Bonfort</td>
</tr>
<tr class="field-odd field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:thomas&#46;bonfort&#37;&#52;&#48;gmail&#46;com">thomas<span>&#46;</span>bonfort<span>&#64;</span>gmail<span>&#46;</span>com</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Status:</th><td class="field-body">Adopted</td>
</tr>
<tr class="field-odd field"><th class="field-name">Version:</th><td class="field-body">MapServer 7.0</td>
</tr>
</tbody>
</table>
<div class="section" id="the-current-situation">
<h2>1. The current situation<a class="headerlink" href="#the-current-situation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="text-rendering-pipeline">
<h3>1.1 Text rendering pipeline<a class="headerlink" href="#text-rendering-pipeline" title="Permalink to this headline">¶</a></h3>
<p>When a feature needs to be labelled, the following (simplified) steps are undertaken:</p>
<ul>
<li><p class="first">the string eventually goes through iconv to be converted to utf8</p>
</li>
<li><p class="first">the string goes through fribidi to reorder the glyphs from &#8220;logical order&#8221; to &#8220;visual order&#8221;,
to support languages that are written from right to left. e.g. supposing capital letters are
arabic letters, the text which is stored in the feature as <code class="docutils literal"><span class="pre">this</span> <span class="pre">is</span> <span class="pre">some</span> <span class="pre">ARABIC</span> <span class="pre">text</span></code> is
transformed into <code class="docutils literal"><span class="pre">this</span> <span class="pre">is</span> <span class="pre">some</span> <span class="pre">CIBARA</span> <span class="pre">text</span></code> in order to be fed transparently to the
renderers that currently layout glyphs from left to right</p>
</li>
<li><p class="first">the string goes through line breaking, which is currently broken for RTL
scripts for line breaking as we render (for <code class="docutils literal"><span class="pre">arabic</span> <span class="pre">\n</span> <span class="pre">text</span></code>)</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">TXET</span>
<span class="n">CIBARA</span>
</pre></div>
</div>
<p>instead of the required</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">CIBARA</span>
<span class="n">TXET</span>
</pre></div>
</div>
</li>
<li><p class="first">the string goes through alignment, which is currently hacky and unprecise (thanks
to yours faithfully) as we (try to) achieve alignment by padding with spaces instead
of using precise offsets per line</p>
</li>
<li><p class="first">the string is then passed to the renderers as-is, who are responsible for the whole
laying out of each glyph</p>
</li>
</ul>
</div>
<div class="section" id="limitations">
<h3>1.2 Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h3>
<p>While the current situation is simple to understand, and works reasonable well for latin
languages, it has a number of shortcomings that this RFC aims to resolve:</p>
<ul class="simple">
<li>All the renderers are duplicating layout logic:<ul>
<li>splitting the utf8 string into individual glyphs</li>
<li>looking up a given glyph inside a font file</li>
<li>laying out a glyph with respect to the previous one (this includes spacing between
subsequent characters, or determining how many pixels should be vertically added
when a linebreak is encountered)</li>
</ul>
</li>
<li>While latin languages have a 1-to-1 mapping between string characters and font glyphs,
this is not the case for complex languages, where ligature glyphs need to be inserted
depending on context (see the <a class="reference external" href="http://en.wikipedia.org/wiki/Complex_text_layout">wikipedia complex text layout page</a> for a more complete explanation).
While this is partly taken care of for us by fribidi for arabic (which has a shaping
algorithm that inserts ligatures for us), we currently fail hard for other complex
text languages.</li>
<li>We don&#8217;t support double spacing or line spacing at all, and our text alignment
(center, right) is imprecise, as implementation for these would need to be added
to each individual renderer.</li>
</ul>
</div>
</div>
<div class="section" id="proposed-overhaul">
<h2>2. Proposed Overhaul<a class="headerlink" href="#proposed-overhaul" title="Permalink to this headline">¶</a></h2>
<p>For the big picture, see <a class="reference external" href="http://behdad.org/text/">the state of text rendering</a>.</p>
<p>In short, instead of passing a string of text and a starting position to the renderers,
we pass a list of glyphs (i.e. a glyph is a specific entry inside a specific font file)
along with their precise positioning, very similarly to what we do currently when
rendering <code class="docutils literal"><span class="pre">FOLLOW</span></code> labels, as is already outlined in <a class="reference external" href="https://github.com/mapserver/mapserver/issues/3611">bug 3611</a> . The actual shaping and layout
happens in a single mapserver function, and the renderers just dumbly place glyphs where
they are told to.</p>
<div class="section" id="architecture-implications">
<h3>2.1 Architecture Implications<a class="headerlink" href="#architecture-implications" title="Permalink to this headline">¶</a></h3>
<p>Architecturaly, this modification is significant, as the whole label rendering chain
needs to be refactored in order to take a list of positionned glyphs into account instead
of just plain text strings.</p>
<div class="section" id="dependencies">
<h4>2.1.1 Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Freetype becomes a central mapserver dependency, as we need the information about glyph
sizes at a higher level than currently (where freetype is a dependency of the individual
renderers). We also need a single central glyph cache to be used across harfbuzz and the
renderers. <code class="docutils literal"><span class="pre">fontsetObj</span></code> will likely need to be extended to be more than a simple
filename hashtable.</li>
<li>Fribidi (which has some thread safety issues) is kept as the library that handles the
bidi algorithm for us. We do not use it for shaping anymore.</li>
<li>Bring in Harfbuzz to support complex script shaping (to simplify: the tool that will
insert ligatures between characters). Harfbuzz algorithms will be applied on text strings
that have been determined to not be latin (i.e. the slowdown induced by harfbuzz is limited
to those languages that actually require shaping).</li>
<li>UTHash (<a class="reference external" href="http://troydhanson.github.io/uthash/">http://troydhanson.github.io/uthash/</a>) is a header only hashtable
implementation that works with arbitrary keys and values, and is used for
accessing cached fonts and glyphs. Given some performance testing, we might
want to replace our own hashtable implementation with this one some day.</li>
</ul>
<p>Note that the Fribidi and Harfbuzz dependencies will remain optional and can be
disablable at compile time for those only treating latin scripts. Harfbuzz and Fribidi will
need to be enabled or disabled together.</p>
</div>
<div class="section" id="font-and-glyph-cache">
<h4>2.1.2 Font and Glyph cache<a class="headerlink" href="#font-and-glyph-cache" title="Permalink to this headline">¶</a></h4>
<p>(fontcache.c)
A global (thread protected if needed) glyph and font cache will
ensure that cached glyphs are reusable across
multiple requests for the fastcgi case, but in turn requires some
thread-level protection and probably some pruning in order for it to
remain of reasonable size. Some APIs have changed in order to have the
fontcache accessible.
The fontcache contains caches for:</p>
<ul class="simple">
<li>font faces (i.e. the representation of of a truetype file)</li>
<li>glyphs (i.e. the metrics of an individual glyph at a given size)</li>
</ul>
</div>
<div class="section" id="transforming-a-string-of-text-into-a-list-of-positionned-glyphs">
<h4>2.1.2 Transforming a string of text into a list of positionned glyphs<a class="headerlink" href="#transforming-a-string-of-text-into-a-list-of-positionned-glyphs" title="Permalink to this headline">¶</a></h4>
<p>This step will be added to mapserver, and consists in coordinating the outputs from freetype,
the bidi algorithm, harfbuzz, line-breaking, text alignment, and in the future text and line
spacing. This step could be in most part implemented transparently through pango, however
pango is hard to support across platforms, and, to my knowledge, has a hard dependency on
fontconfig which is incompatible with our fontset approach.</p>
<p>Text is represented by a &#8220;textPathObj&#8221; which is basically a list of
positioned glyphs. (e.g the word &#8220;Label&#8221; at size 10 for an arial font
is represented by arial font&#8217;s glyph &#8220;L&#8221; at position (x,y)= (0,0),
glyph &#8220;a&#8221; at position (10,0) , &#8220;b&#8221; at (18,0), etc...). Multiline text
is handled transparently by having glyphs positioned at different y
values. A textPath can be either &#8220;absolute&#8221; (i.e. the glyph positions
are in absolute image coordinates, used to position glyphs for angle
follow labels), or &#8220;relative&#8221;, in which case they must be offset by
their labeling point.</p>
<p>All the shaping happens in textlayout.c,
who&#8217;s principal role is to take a string of text as input, and return
a list of positioned glyphs as output. The input string goes through
multiple steps, and is plit into multiple run. Each run will have a
distinct line number, bidi direction, and script &#8220;language&#8221;.</p>
<p>As an example, we&#8217;ll be working with the input unicode string &#8220;this is
some text in english, ARABIC and JAPANESE&#8221;. Capital letters are used
to denote non latin glyphs, also note that ARABIC is stored in logical
(=reading) order, whereas it would be rendered as CIBARA.</p>
<ul class="simple">
<li>iconv encoding conversion to convert the string to unicode</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="s2">&quot;this is some text in english, ARABIC and JAPANESE&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li>line wrapping: break on wrap character, break long lines on spaces</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="s2">&quot;this is some text in english,&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">0</span>
<span class="n">run2</span> <span class="o">=</span> <span class="s2">&quot;ARABIC and JAPANESE&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<ul class="simple">
<li>bidi levels, each run has a single bidi direction (i.e. left-to-right or right-to-left)</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>run1 = &quot;this is some text in english,&quot;, line=0, direction=LTR
run2 = &quot;ARABIC&quot; line=1, direction=RTL
run3 = &quot; and JAPANESE&quot;, line=1, direction = LTR
</pre></div>
</div>
<ul class="simple">
<li>script detection is applied to enable language dependent shaping,
and also to refine which fonts will be used (more on that later)</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>run1 = &quot;this is some text in english,&quot;, line=0, direction=LTR, script=latin
run2 = &quot;ARABIC&quot; line=1, direction=RTL, script=arabic
run3 = &quot; and &quot; line=1, direction=LTR, script=latin
run4 = &quot;JAPANESE&quot; line=1, direction=LTR, script=hiragana
</pre></div>
</div>
<ul class="simple">
<li>for each run, we select which font should be used, in order to use
the same font inside a given run. <a class="reference internal" href="ms-rfc-80.html#rfc80"><span>MS RFC 80: Font Fallback Support</span></a> allowed to specify
multiple fonts for a LABEL, this has been extended to be able to fine
tune which fonts are to be preferably used for a given script:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span>LABEL &quot;arialuni,arial,cjk,arabic&quot;
</pre></div>
</div>
<p>can now be written prefixed by a script identifier, i.e.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>  LABEL &quot;arialuni,en:arial,ja:cjk,ar:arabic&quot;

This is needed as there is and will be overlap between font glyph
coverages, and it should be possible to prioritize which font is used
for which language.
</pre></div>
</div>
<ul class="simple">
<li>Each run is then fed into harfbuzz, which returns a list of
positionned glyphs. The number of returned glyphs is not meant to be
identical to the number of glyphs we had in the unicode string, and
are ordered from left to right. As a speedup, a run who&#8217;s script is
&#8220;latin&#8221; is not fed through harfbuzz, but instead uses cached glyph
advances.</li>
<li>The glyphs of each run are reassembled to account for line numbers
and run positions (e.g. run 3 is offset down by one line, and placed
to the right of run 2)</li>
<li>Each line is horizontally offseted to account for ALIGN. LABEL ALIGN
now stops defaulting to LEFT, so right-to-left runs will be right
aligned instead of left as is now.</li>
</ul>
</div>
<div class="section" id="handling-glyphs-at-rendering-phase">
<h4>2.1.3 Handling glyphs at rendering phase<a class="headerlink" href="#handling-glyphs-at-rendering-phase" title="Permalink to this headline">¶</a></h4>
<p>The labelcache and the renderers will need to be updated to work with a list of glyphs.
Changes here are extensive but should remain conceptually simple. Individual renderers are
substantially simplified.</p>
<p>Work has been done to trim down the labelcache computations as much as possible:</p>
<p>When inserting features into the labelcache:</p>
<ul class="simple">
<li>We&#8217;ll insert a reference to the original labelObj instead of a copy
if the labelObj and it&#8217;s child styleObjs don&#8217;t contain any bindings.
This cuts dow on memory usage when attribute bindings aren&#8217;t in use.</li>
<li>We don&#8217;t insert features that will never get rendered (e.g. out of
scale, too large for their feature (minfeaturesize keyword) )</li>
</ul>
<p>At the msDrawLabelCache phase:</p>
<ul>
<li><p class="first">We delay computation of the label text bounding box to after we have
checked conditions that would cause it not be renderered, i.e.</p>
<ul class="simple">
<li>if they have a MINDISTANCE set and a neighbouring label with
identical text has already been rendered</li>
<li>for labels without markers, we first check that the labelpoint
doesn&#8217;t collide with an existing label.</li>
</ul>
</li>
<li><p class="first">The Collision detection has been optimized:</p>
<ul class="simple">
<li>We keep a list of rendered labels and loop through those instead of
checking the status of all the labels in the labelcache for each
member</li>
<li>The bounding metrics for a label has been cut down from a full
shapeObj to a struct containing a bounding rect and an optional
lineObj. For non rotated labels, there&#8217;s no information needed more
than the bounding box, which makes intersection detection much easier
for two labels like this (i.e. the overlapping of these two labels is
the same as the overlapping of their bounding boxes, no need to go
into further geometric intersection primitives).</li>
</ul>
<p>The speedups for these changes are extremely important for cluttered
maps, c.f. <a class="reference external" href="https://plus.google.com/u/0/118271009221580171800/posts/PrwhFYSkhea">https://plus.google.com/u/0/118271009221580171800/posts/PrwhFYSkhea</a>
(e.g. rendering time goes from 800 to 1 second for 500.000 labels)</p>
</li>
</ul>
</div>
</div>
<div class="section" id="backwards-compatibility">
<h3>2.2 Backwards Compatibility<a class="headerlink" href="#backwards-compatibility" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>At a high (mapfile) level, none expected.</li>
<li>Some mapscript APIs may change or may need to be wrapped. (TBD)</li>
<li>Some subtle but widespread changes in character placement.</li>
<li><a class="reference internal" href="ms-rfc-99.html#rfc99"><span>MS RFC 99: Remove support for GD renderer</span></a> is a collateral of most of these changes</li>
</ul>
</div>
<div class="section" id="performance-implications">
<h3>2.3 Performance Implications<a class="headerlink" href="#performance-implications" title="Permalink to this headline">¶</a></h3>
<p>Potentially numerous:</p>
<ul class="simple">
<li>Existing performance on latin only text will need to be kept to
the current level, by detecting and shortcutting these cases. If done correctly we may
actually be able to speed up latin text rendering marginally.</li>
<li>For other scripts, the cost of going through harfbuzz <strong>will</strong> come with a performance
penalty.</li>
</ul>
</div>
</div>
<div class="section" id="miscellaneous">
<h2>3. Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<div class="section" id="issue-tracking-id">
<h3>3.1 Issue Tracking ID<a class="headerlink" href="#issue-tracking-id" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/mapserver/mapserver/issues/4673">https://github.com/mapserver/mapserver/issues/4673</a></p>
</div>
<div class="section" id="voting-history">
<h3>3.2 Voting History<a class="headerlink" href="#voting-history" title="Permalink to this headline">¶</a></h3>
<p>+1 from MikeS, StephanM, TomK, JeffM, SteveW, SteveL and ThomasB</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a>
</p>
  <h3>Current Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 98: Label/Text Rendering Overhaul</a><ul>
<li><a class="reference internal" href="#the-current-situation">1. The current situation</a><ul>
<li><a class="reference internal" href="#text-rendering-pipeline">1.1 Text rendering pipeline</a></li>
<li><a class="reference internal" href="#limitations">1.2 Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#proposed-overhaul">2. Proposed Overhaul</a><ul>
<li><a class="reference internal" href="#architecture-implications">2.1 Architecture Implications</a><ul>
<li><a class="reference internal" href="#dependencies">2.1.1 Dependencies</a></li>
<li><a class="reference internal" href="#font-and-glyph-cache">2.1.2 Font and Glyph cache</a></li>
<li><a class="reference internal" href="#transforming-a-string-of-text-into-a-list-of-positionned-glyphs">2.1.2 Transforming a string of text into a list of positionned glyphs</a></li>
<li><a class="reference internal" href="#handling-glyphs-at-rendering-phase">2.1.3 Handling glyphs at rendering phase</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">2.2 Backwards Compatibility</a></li>
<li><a class="reference internal" href="#performance-implications">2.3 Performance Implications</a></li>
</ul>
</li>
<li><a class="reference internal" href="#miscellaneous">3. Miscellaneous</a><ul>
<li><a class="reference internal" href="#issue-tracking-id">3.1 Issue Tracking ID</a></li>
<li><a class="reference internal" href="#voting-history">3.2 Voting History</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Open Source Geospatial Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
    </div>

    

    
  </body>
</html>