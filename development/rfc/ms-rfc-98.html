<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 98: Label/Text Rendering Overhaul &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 99: Remove support for GD renderer" href="ms-rfc-99.html" />
    <link rel="prev" title="MS RFC 97: Dynamic creation of higher zoom levels tiles" href="ms-rfc-97.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-98.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-99.html" title="MS RFC 99: Remove support for GD renderer"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-97.html" title="MS RFC 97: Dynamic creation of higher zoom levels tiles"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 98: Label/Text Rendering Overhaul</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-98-label-text-rendering-overhaul">
<span id="rfc98"></span><h1>MS RFC 98: Label/Text Rendering Overhaul<a class="headerlink" href="#ms-rfc-98-label-text-rendering-overhaul" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013/06</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Thomas Bonfort</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:thomas&#46;bonfort&#37;&#52;&#48;gmail&#46;com">thomas<span>&#46;</span>bonfort<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Adopted</p>
</dd>
<dt class="field-odd">Version<span class="colon">:</span></dt>
<dd class="field-odd"><p>MapServer 7.0</p>
</dd>
</dl>
<section id="the-current-situation">
<h2>1. The current situation<a class="headerlink" href="#the-current-situation" title="Link to this heading">¶</a></h2>
<section id="text-rendering-pipeline">
<h3>1.1 Text rendering pipeline<a class="headerlink" href="#text-rendering-pipeline" title="Link to this heading">¶</a></h3>
<p>When a feature needs to be labelled, the following (simplified) steps are undertaken:</p>
<ul>
<li><p>the string eventually goes through iconv to be converted to utf8</p></li>
<li><p>the string goes through fribidi to reorder the glyphs from “logical order” to “visual order”,
to support languages that are written from right to left. e.g. supposing capital letters are
arabic letters, the text which is stored in the feature as <cite>this is some ARABIC text</cite> is
transformed into <cite>this is some CIBARA text</cite> in order to be fed transparently to the
renderers that currently layout glyphs from left to right</p></li>
<li><p>the string goes through line breaking, which is currently broken for RTL
scripts for line breaking as we render (for <cite>arabic n text</cite>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TXET</span>
<span class="n">CIBARA</span>
</pre></div>
</div>
<p>instead of the required</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CIBARA</span>
<span class="n">TXET</span>
</pre></div>
</div>
</li>
<li><p>the string goes through alignment, which is currently hacky and unprecise (thanks
to yours faithfully) as we (try to) achieve alignment by padding with spaces instead
of using precise offsets per line</p></li>
<li><p>the string is then passed to the renderers as-is, who are responsible for the whole
laying out of each glyph</p></li>
</ul>
</section>
<section id="limitations">
<h3>1.2 Limitations<a class="headerlink" href="#limitations" title="Link to this heading">¶</a></h3>
<p>While the current situation is simple to understand, and works reasonable well for latin
languages, it has a number of shortcomings that this RFC aims to resolve:</p>
<ul class="simple">
<li><p>All the renderers are duplicating layout logic:</p>
<ul>
<li><p>splitting the utf8 string into individual glyphs</p></li>
<li><p>looking up a given glyph inside a font file</p></li>
<li><p>laying out a glyph with respect to the previous one (this includes spacing between
subsequent characters, or determining how many pixels should be vertically added
when a linebreak is encountered)</p></li>
</ul>
</li>
<li><p>While latin languages have a 1-to-1 mapping between string characters and font glyphs,
this is not the case for complex languages, where ligature glyphs need to be inserted
depending on context (see the <a class="reference external" href="http://en.wikipedia.org/wiki/Complex_text_layout">wikipedia complex text layout page</a> for a more complete explanation).
While this is partly taken care of for us by fribidi for arabic (which has a shaping
algorithm that inserts ligatures for us), we currently fail hard for other complex
text languages.</p></li>
<li><p>We don’t support double spacing or line spacing at all, and our text alignment
(center, right) is imprecise, as implementation for these would need to be added
to each individual renderer.</p></li>
</ul>
</section>
</section>
<section id="proposed-overhaul">
<h2>2. Proposed Overhaul<a class="headerlink" href="#proposed-overhaul" title="Link to this heading">¶</a></h2>
<p>For the big picture, see <a class="reference external" href="http://behdad.org/text/">the state of text rendering</a>.</p>
<p>In short, instead of passing a string of text and a starting position to the renderers,
we pass a list of glyphs (i.e. a glyph is a specific entry inside a specific font file)
along with their precise positioning, very similarly to what we do currently when
rendering <cite>FOLLOW</cite> labels, as is already outlined in <a class="reference external" href="https://github.com/MapServer/MapServer/issues/3611">bug 3611</a> . The actual shaping and layout
happens in a single mapserver function, and the renderers just dumbly place glyphs where
they are told to.</p>
<section id="architecture-implications">
<h3>2.1 Architecture Implications<a class="headerlink" href="#architecture-implications" title="Link to this heading">¶</a></h3>
<p>Architecturaly, this modification is significant, as the whole label rendering chain
needs to be refactored in order to take a list of positioned glyphs into account instead
of just plain text strings.</p>
<section id="dependencies">
<h4>2.1.1 Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>Freetype becomes a central mapserver dependency, as we need the information about glyph
sizes at a higher level than currently (where freetype is a dependency of the individual
renderers). We also need a single central glyph cache to be used across harfbuzz and the
renderers. <cite>fontsetObj</cite> will likely need to be extended to be more than a simple
filename hashtable.</p></li>
<li><p>Fribidi (which has some thread safety issues) is kept as the library that handles the
bidi algorithm for us. We do not use it for shaping anymore.</p></li>
<li><p>Bring in Harfbuzz to support complex script shaping (to simplify: the tool that will
insert ligatures between characters). Harfbuzz algorithms will be applied on text strings
that have been determined to not be latin (i.e. the slowdown induced by harfbuzz is limited
to those languages that actually require shaping).</p></li>
<li><p>UTHash (<a class="reference external" href="http://troydhanson.github.io/uthash/">http://troydhanson.github.io/uthash/</a>) is a header only hashtable
implementation that works with arbitrary keys and values, and is used for
accessing cached fonts and glyphs. Given some performance testing, we might
want to replace our own hashtable implementation with this one some day.</p></li>
</ul>
<p>Note that the Fribidi and Harfbuzz dependencies will remain optional and can be
disablable at compile time for those only treating latin scripts. Harfbuzz and Fribidi will
need to be enabled or disabled together.</p>
</section>
<section id="font-and-glyph-cache">
<h4>2.1.2 Font and Glyph cache<a class="headerlink" href="#font-and-glyph-cache" title="Link to this heading">¶</a></h4>
<p>(fontcache.c)
A global (thread protected if needed) glyph and font cache will
ensure that cached glyphs are reusable across
multiple requests for the fastcgi case, but in turn requires some
thread-level protection and probably some pruning in order for it to
remain of reasonable size. Some APIs have changed in order to have the
fontcache accessible.
The fontcache contains caches for:</p>
<ul class="simple">
<li><p>font faces (i.e. the representation of of a truetype file)</p></li>
<li><p>glyphs (i.e. the metrics of an individual glyph at a given size)</p></li>
</ul>
</section>
<section id="transforming-a-string-of-text-into-a-list-of-positioned-glyphs">
<h4>2.1.2 Transforming a string of text into a list of positioned glyphs<a class="headerlink" href="#transforming-a-string-of-text-into-a-list-of-positioned-glyphs" title="Link to this heading">¶</a></h4>
<p>This step will be added to mapserver, and consists in coordinating the outputs from freetype,
the bidi algorithm, harfbuzz, line-breaking, text alignment, and in the future text and line
spacing. This step could be in most part implemented transparently through pango, however
pango is hard to support across platforms, and, to my knowledge, has a hard dependency on
fontconfig which is incompatible with our fontset approach.</p>
<p>Text is represented by a “textPathObj” which is basically a list of
positioned glyphs. (e.g the word “Label” at size 10 for an arial font
is represented by arial font’s glyph “L” at position (x,y)= (0,0),
glyph “a” at position (10,0) , “b” at (18,0), etc…). Multiline text
is handled transparently by having glyphs positioned at different y
values. A textPath can be either “absolute” (i.e. the glyph positions
are in absolute image coordinates, used to position glyphs for angle
follow labels), or “relative”, in which case they must be offset by
their labeling point.</p>
<p>All the shaping happens in textlayout.c,
who’s principal role is to take a string of text as input, and return
a list of positioned glyphs as output. The input string goes through
multiple steps, and is plit into multiple run. Each run will have a
distinct line number, bidi direction, and script “language”.</p>
<p>As an example, we’ll be working with the input unicode string “this is
some text in english, ARABIC and JAPANESE”. Capital letters are used
to denote non latin glyphs, also note that ARABIC is stored in logical
(=reading) order, whereas it would be rendered as CIBARA.</p>
<ul class="simple">
<li><p>iconv encoding conversion to convert the string to unicode</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="s2">&quot;this is some text in english, ARABIC and JAPANESE&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>line wrapping: break on wrap character, break long lines on spaces</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="s2">&quot;this is some text in english,&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">0</span>
<span class="n">run2</span> <span class="o">=</span> <span class="s2">&quot;ARABIC and JAPANESE&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<ul class="simple">
<li><p>bidi levels, each run has a single bidi direction (i.e. left-to-right or right-to-left)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="s2">&quot;this is some text in english,&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">LTR</span>
<span class="n">run2</span> <span class="o">=</span> <span class="s2">&quot;ARABIC&quot;</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">RTL</span>
<span class="n">run3</span> <span class="o">=</span> <span class="s2">&quot; and JAPANESE&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">LTR</span>
</pre></div>
</div>
<ul class="simple">
<li><p>script detection is applied to enable language dependent shaping,
and also to refine which fonts will be used (more on that later)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">run1</span> <span class="o">=</span> <span class="s2">&quot;this is some text in english,&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">LTR</span><span class="p">,</span> <span class="n">script</span><span class="o">=</span><span class="n">latin</span>
<span class="n">run2</span> <span class="o">=</span> <span class="s2">&quot;ARABIC&quot;</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">RTL</span><span class="p">,</span> <span class="n">script</span><span class="o">=</span><span class="n">arabic</span>
<span class="n">run3</span> <span class="o">=</span> <span class="s2">&quot; and &quot;</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">LTR</span><span class="p">,</span> <span class="n">script</span><span class="o">=</span><span class="n">latin</span>
<span class="n">run4</span> <span class="o">=</span> <span class="s2">&quot;JAPANESE&quot;</span> <span class="n">line</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">LTR</span><span class="p">,</span> <span class="n">script</span><span class="o">=</span><span class="n">hiragana</span>
</pre></div>
</div>
<ul class="simple">
<li><p>for each run, we select which font should be used, in order to use
the same font inside a given run. <a class="reference internal" href="ms-rfc-80.html#rfc80"><span class="std std-ref">MS RFC 80: Font Fallback Support</span></a> allowed to specify
multiple fonts for a LABEL, this has been extended to be able to fine
tune which fonts are to be preferably used for a given script:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FONT</span> <span class="s2">&quot;arialuni,arial,cjk,arabic&quot;</span>
</pre></div>
</div>
<p>can now be written prefixed by a script identifier, i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">FONT</span> <span class="s2">&quot;arialuni,en:arial,ja:cjk,ar:arabic&quot;</span>

<span class="n">This</span> <span class="ow">is</span> <span class="n">needed</span> <span class="k">as</span> <span class="n">there</span> <span class="ow">is</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">overlap</span> <span class="n">between</span> <span class="n">font</span> <span class="n">glyph</span>
<span class="n">coverages</span><span class="p">,</span> <span class="ow">and</span> <span class="n">it</span> <span class="n">should</span> <span class="n">be</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">prioritize</span> <span class="n">which</span> <span class="n">font</span> <span class="ow">is</span> <span class="n">used</span>
<span class="k">for</span> <span class="n">which</span> <span class="n">language</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Each run is then fed into harfbuzz, which returns a list of
positioned glyphs. The number of returned glyphs is not meant to be
identical to the number of glyphs we had in the unicode string, and
are ordered from left to right. As a speedup, a run who’s script is
“latin” is not fed through harfbuzz, but instead uses cached glyph
advances.</p></li>
<li><p>The glyphs of each run are reassembled to account for line numbers
and run positions (e.g. run 3 is offset down by one line, and placed
to the right of run 2)</p></li>
<li><p>Each line is horizontally offseted to account for ALIGN. LABEL ALIGN
now stops defaulting to LEFT, so right-to-left runs will be right
aligned instead of left as is now.</p></li>
</ul>
</section>
<section id="handling-glyphs-at-rendering-phase">
<h4>2.1.3 Handling glyphs at rendering phase<a class="headerlink" href="#handling-glyphs-at-rendering-phase" title="Link to this heading">¶</a></h4>
<p>The labelcache and the renderers will need to be updated to work with a list of glyphs.
Changes here are extensive but should remain conceptually simple. Individual renderers are
substantially simplified.</p>
<p>Work has been done to trim down the labelcache computations as much as possible:</p>
<p>When inserting features into the labelcache:</p>
<ul class="simple">
<li><p>We’ll insert a reference to the original labelObj instead of a copy
if the labelObj and it’s child styleObjs don’t contain any bindings.
This cuts dow on memory usage when attribute bindings aren’t in use.</p></li>
<li><p>We don’t insert features that will never get rendered (e.g. out of
scale, too large for their feature (minfeaturesize keyword) )</p></li>
</ul>
<p>At the msDrawLabelCache phase:</p>
<ul>
<li><p>We delay computation of the label text bounding box to after we have
checked conditions that would cause it not be renderered, i.e.</p>
<ul class="simple">
<li><p>if they have a MINDISTANCE set and a neighbouring label with
identical text has already been rendered</p></li>
<li><p>for labels without markers, we first check that the labelpoint
doesn’t collide with an existing label.</p></li>
</ul>
</li>
<li><p>The Collision detection has been optimized:</p>
<ul class="simple">
<li><p>We keep a list of rendered labels and loop through those instead of
checking the status of all the labels in the labelcache for each
member</p></li>
<li><p>The bounding metrics for a label has been cut down from a full
shapeObj to a struct containing a bounding rect and an optional
lineObj. For non rotated labels, there’s no information needed more
than the bounding box, which makes intersection detection much easier
for two labels like this (i.e. the overlapping of these two labels is
the same as the overlapping of their bounding boxes, no need to go
into further geometric intersection primitives).</p></li>
</ul>
<p>The speedups for these changes are extremely important for cluttered
maps, c.f. <a class="reference external" href="https://plus.google.com/u/0/118271009221580171800/posts/PrwhFYSkhea">https://plus.google.com/u/0/118271009221580171800/posts/PrwhFYSkhea</a>
(e.g. rendering time goes from 800 to 1 second for 500.000 labels)</p>
</li>
</ul>
</section>
</section>
<section id="backwards-compatibility">
<h3>2.2 Backwards Compatibility<a class="headerlink" href="#backwards-compatibility" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>At a high (mapfile) level, none expected.</p></li>
<li><p>Some mapscript APIs may change or may need to be wrapped. (TBD)</p></li>
<li><p>Some subtle but widespread changes in character placement.</p></li>
<li><p><a class="reference internal" href="ms-rfc-99.html#rfc99"><span class="std std-ref">MS RFC 99: Remove support for GD renderer</span></a> is a collateral of most of these changes</p></li>
</ul>
</section>
<section id="performance-implications">
<h3>2.3 Performance Implications<a class="headerlink" href="#performance-implications" title="Link to this heading">¶</a></h3>
<p>Potentially numerous:</p>
<ul class="simple">
<li><p>Existing performance on latin only text will need to be kept to
the current level, by detecting and shortcutting these cases. If done correctly we may
actually be able to speed up latin text rendering marginally.</p></li>
<li><p>For other scripts, the cost of going through harfbuzz <strong>will</strong> come with a performance
penalty.</p></li>
</ul>
</section>
</section>
<section id="miscellaneous">
<h2>3. Miscellaneous<a class="headerlink" href="#miscellaneous" title="Link to this heading">¶</a></h2>
<section id="issue-tracking-id">
<h3>3.1 Issue Tracking ID<a class="headerlink" href="#issue-tracking-id" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://github.com/MapServer/MapServer/issues/4673">https://github.com/MapServer/MapServer/issues/4673</a></p>
</section>
<section id="voting-history">
<h3>3.2 Voting History<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h3>
<p>+1 from MikeS, StephanM, TomK, JeffM, SteveW, SteveL and ThomasB</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 98: Label/Text Rendering Overhaul</a><ul>
<li><a class="reference internal" href="#the-current-situation">1. The current situation</a><ul>
<li><a class="reference internal" href="#text-rendering-pipeline">1.1 Text rendering pipeline</a></li>
<li><a class="reference internal" href="#limitations">1.2 Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#proposed-overhaul">2. Proposed Overhaul</a><ul>
<li><a class="reference internal" href="#architecture-implications">2.1 Architecture Implications</a><ul>
<li><a class="reference internal" href="#dependencies">2.1.1 Dependencies</a></li>
<li><a class="reference internal" href="#font-and-glyph-cache">2.1.2 Font and Glyph cache</a></li>
<li><a class="reference internal" href="#transforming-a-string-of-text-into-a-list-of-positioned-glyphs">2.1.2 Transforming a string of text into a list of positioned glyphs</a></li>
<li><a class="reference internal" href="#handling-glyphs-at-rendering-phase">2.1.3 Handling glyphs at rendering phase</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-compatibility">2.2 Backwards Compatibility</a></li>
<li><a class="reference internal" href="#performance-implications">2.3 Performance Implications</a></li>
</ul>
</li>
<li><a class="reference internal" href="#miscellaneous">3. Miscellaneous</a><ul>
<li><a class="reference internal" href="#issue-tracking-id">3.1 Issue Tracking ID</a></li>
<li><a class="reference internal" href="#voting-history">3.2 Voting History</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-99.html" title="MS RFC 99: Remove support for GD renderer"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-97.html" title="MS RFC 97: Dynamic creation of higher zoom levels tiles"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 98: Label/Text Rendering Overhaul</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>