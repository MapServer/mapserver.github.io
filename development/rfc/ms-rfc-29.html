<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 29: Dynamic Charting Capability &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 30: Support for WMS 1.3.0" href="ms-rfc-30.html" />
    <link rel="prev" title="MS RFC 28: Redesign of LOG/DEBUG output mechanisms" href="ms-rfc-28.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-29.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-30.html" title="MS RFC 30: Support for WMS 1.3.0"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-28.html" title="MS RFC 28: Redesign of LOG/DEBUG output mechanisms"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 29: Dynamic Charting Capability</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-29-dynamic-charting-capability">
<span id="rfc29"></span><h1>MS RFC 29: Dynamic Charting Capability<a class="headerlink" href="#ms-rfc-29-dynamic-charting-capability" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2007/06/15</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Daniel Morissette</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p>dmorissette at mapgears.com</p>
</dd>
<dt class="field-even">Last Edited<span class="colon">:</span></dt>
<dd class="field-even"><p>2007/07/31</p>
</dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adopted (2007/07/05) - Completed (2007/07/09)</p>
</dd>
<dt class="field-even">Version<span class="colon">:</span></dt>
<dd class="field-even"><p>MapServer 5.0</p>
</dd>
</dl>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>This RFC proposes the addition of simple dynamic charting capability in
MapServer 5.0 by integrating the patch proposed by Thomas Bonfort in
ticket #1800.</p>
<p>Note: this is already implemented and working (as a patch in ticket 1800).
This RFC is to document the new feature and (hopefully) include it in the
MapServer 5.0 release.</p>
</section>
<section id="technical-solution">
<h2>Technical Solution<a class="headerlink" href="#technical-solution" title="Link to this heading">¶</a></h2>
<p>A new CHART layer type is created and the initial implementation would
support pie and bar charts.</p>
<p>PROCESSING directives are used to set the layer’s CHART_TYPE (pie or bar) and
CHART_SIZE,</p>
<p>Then we have one class for each pie slice or bar from the chart. Inside each
class, the STYLE COLOR defines the color of the pie slice or bar, and the
STYLE SIZE is used to set the relative size (value) of each pie slice or bar.
This is mostly useful in combination with attribute binding of course. e.g.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
    <span class="n">NAME</span> <span class="s2">&quot;Ages&quot;</span>
    <span class="n">TYPE</span> <span class="n">CHART</span>
    <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
    <span class="n">CONNECTION</span> <span class="s2">&quot;blabla&quot;</span>
    <span class="n">DATA</span> <span class="s2">&quot;the_geom from demo&quot;</span>
    <span class="n">PROCESSING</span> <span class="s2">&quot;CHART_TYPE=pie&quot;</span>
    <span class="n">PROCESSING</span> <span class="s2">&quot;CHART_SIZE=30&quot;</span>
    <span class="n">STATUS</span> <span class="n">ON</span>
    <span class="n">CLASS</span>
      <span class="n">NAME</span> <span class="s2">&quot;Population Age 0-19&quot;</span>
      <span class="n">STYLE</span>
        <span class="n">SIZE</span> <span class="p">[</span><span class="n">v1006</span><span class="p">]</span>
        <span class="n">COLOR</span> <span class="mi">255</span> <span class="mi">244</span> <span class="mi">237</span>
      <span class="n">END</span>
    <span class="n">END</span>
    <span class="n">CLASS</span>
      <span class="n">NAME</span> <span class="s2">&quot;Population Age 20-39&quot;</span>
      <span class="n">STYLE</span>
        <span class="n">SIZE</span> <span class="p">[</span><span class="n">v1007</span><span class="p">]</span>
        <span class="n">COLOR</span> <span class="mi">255</span> <span class="mi">217</span> <span class="mi">191</span>
      <span class="n">END</span>
    <span class="n">END</span>
    <span class="n">CLASS</span>
      <span class="n">NAME</span> <span class="s2">&quot;Population Age 40-59&quot;</span>
      <span class="n">STYLE</span>
        <span class="n">SIZE</span> <span class="p">[</span><span class="n">v1008</span><span class="p">]</span>
        <span class="n">COLOR</span> <span class="mi">255</span> <span class="mi">186</span> <span class="mi">140</span>
      <span class="n">END</span>
    <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>In the example above, if for a given shape we have v1006=1000, v1007=600 and
v1008=400 then the actual pie slices for each class will be respectively 50%,
30% and 20% of the total pie size. If we produced bar charts then the values
would represent the relative height of the bars with the largest value
(highest bar) being 100% of the chart height.</p>
<p>The following attachment to ticket 1800 contains a sample map produced
by the layer definition above:</p>
<p><a class="reference external" href="https://trac.osgeo.org/mapserver/attachment/ticket/1800/chart-test.jpg">https://trac.osgeo.org/mapserver/attachment/ticket/1800/chart-test.jpg</a></p>
<p>The layer’s legend behaves as usual and produces one color sample per class.</p>
</section>
<section id="issues-and-limitations">
<h2>Issues and limitations<a class="headerlink" href="#issues-and-limitations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>The initial implementation supports only GD output formats. However
Thomas Bonfort has offered to implement an AGG version once support
for it is available. This is considered a future enhancement outside
of the scope of this RFC. Update 2007/09/06: chart rendering is supported
by the AGG renderer too.</p></li>
<li><p>Should we use special keywords instead of PROCESSING parameters to specify
the chart type and size?</p></li>
<li><p>The values of each class are taken from the SIZE of the corresponding STYLE,
which is semantically awkward (but that saves us from creating new keywords)</p></li>
</ul>
</section>
<section id="mapscript-implications">
<h2>MapScript Implications<a class="headerlink" href="#mapscript-implications" title="Link to this heading">¶</a></h2>
<p>The new CHART type (constant) would be exposed via MapScript. There are no
other MapScript implications.</p>
</section>
<section id="files-affected">
<h2>Files affected<a class="headerlink" href="#files-affected" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="o">.</span><span class="n">h</span>          <span class="p">(</span><span class="n">new</span> <span class="n">MS_LAYER_CHART</span> <span class="n">constant</span><span class="p">)</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span>
<span class="n">maplexer</span><span class="o">.</span><span class="n">l</span>     <span class="p">(</span><span class="n">new</span> <span class="n">CHART</span> <span class="n">keyword</span><span class="p">)</span>
<span class="n">mapdraw</span><span class="o">.</span><span class="n">c</span>      <span class="p">(</span><span class="n">hooks</span> <span class="n">to</span> <span class="n">call</span> <span class="n">chart</span> <span class="n">rendering</span> <span class="n">code</span><span class="p">)</span>
<span class="n">mapchart</span><span class="o">.</span><span class="n">c</span>     <span class="p">(</span><span class="n">implementation</span> <span class="n">of</span> <span class="n">chart</span> <span class="n">rendering</span><span class="p">)</span>
<span class="n">maplegend</span><span class="o">.</span><span class="n">c</span>    <span class="p">(</span><span class="n">add</span> <span class="n">case</span> <span class="k">for</span> <span class="n">chart</span> <span class="n">layer</span> <span class="nb">type</span><span class="p">)</span>
<span class="n">Makefile</span><span class="o">.</span><span class="ow">in</span>    <span class="p">(</span><span class="n">addition</span> <span class="n">of</span> <span class="n">mapchart</span><span class="o">.</span><span class="n">o</span><span class="p">)</span>
<span class="n">makefile</span><span class="o">.</span><span class="n">vc</span>    <span class="p">(</span><span class="n">addition</span> <span class="n">of</span> <span class="n">mapchart</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
<p>Note:</p>
<p>The patch from ticket 1800 also contains changes to mappostgis.c and
mapmygis.c to treat layer type CHART the same way as POLYGON but I’m not
exactly sure why or if the same needs to be done for other data sources.
This will need further review before being released.</p>
</section>
<section id="backwards-compatibility-issues">
<h2>Backwards compatibility issues<a class="headerlink" href="#backwards-compatibility-issues" title="Link to this heading">¶</a></h2>
<p>None. This is a new feature.</p>
</section>
<section id="bug-id">
<h2>Bug ID<a class="headerlink" href="#bug-id" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>1800: <a class="reference external" href="https://github.com/MapServer/MapServer/issues/1800">https://github.com/MapServer/MapServer/issues/1800</a></p></li>
</ul>
<p>Future enhancements:</p>
<ul class="simple">
<li><p>2136: <a class="reference external" href="https://github.com/MapServer/MapServer/issues/2136">https://github.com/MapServer/MapServer/issues/2136</a></p></li>
<li><p>2145: <a class="reference external" href="https://github.com/MapServer/MapServer/issues/2145">https://github.com/MapServer/MapServer/issues/2145</a></p></li>
</ul>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://mapserver.gis.umn.edu/docs/howto/dynamic-charting">http://mapserver.gis.umn.edu/docs/howto/dynamic-charting</a></p></li>
</ul>
</section>
<section id="voting-history">
<h2>Voting history<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h2>
<p>Vote completed on 2007/07/05:</p>
<p>+1 from DanielM, SteveW, AssefaY</p>
</section>
<section id="questions-comments-from-the-review-period">
<h2>Questions/Comments from the review period<a class="headerlink" href="#questions-comments-from-the-review-period" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Q: Does this assume a POLYGON data type input only? Can LINE and POINT data
sources also be supported?</p>
<p>A: The current implementation works only for polygon data sources. I could
extend it to work on point data sources as well fairly easily I think.</p>
<p>I’m not sure about line data sources though. I guess we could do like we do
for ANNOTATION layers and use msPolylineLabelPoint() to determine the
location of the chart.</p>
<p>Ticket #2145 has been opened to track this enhancement:
<a class="reference external" href="https://github.com/MapServer/MapServer/issues/2145">https://github.com/MapServer/MapServer/issues/2145</a></p>
</li>
<li><p>Q: Could we support attribute binding in CHART_SIZE = [size]? This would
allow you to show the relative size of hits at a point and have the chart
show the percentage contributions in the wedges.</p>
<p>A: While this would be a nice feature, we will keep it as a potential
enhancement for a future release. See
ticket #2136: <a class="reference external" href="https://github.com/MapServer/MapServer/issues/2136">https://github.com/MapServer/MapServer/issues/2136</a></p>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 29: Dynamic Charting Capability</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#technical-solution">Technical Solution</a></li>
<li><a class="reference internal" href="#issues-and-limitations">Issues and limitations</a></li>
<li><a class="reference internal" href="#mapscript-implications">MapScript Implications</a></li>
<li><a class="reference internal" href="#files-affected">Files affected</a></li>
<li><a class="reference internal" href="#backwards-compatibility-issues">Backwards compatibility issues</a></li>
<li><a class="reference internal" href="#bug-id">Bug ID</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#voting-history">Voting history</a></li>
<li><a class="reference internal" href="#questions-comments-from-the-review-period">Questions/Comments from the review period</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-30.html" title="MS RFC 30: Support for WMS 1.3.0"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-28.html" title="MS RFC 28: Redesign of LOG/DEBUG output mechanisms"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 29: Dynamic Charting Capability</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>