<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 128: Make C99 and C++11 build requirements &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 129: Update msautotest to use Pytest" href="ms-rfc-129.html" />
    <link rel="prev" title="MS RFC 127: Drop (broken) support for builds without GDAL and PROJ" href="ms-rfc-127.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-128.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-129.html" title="MS RFC 129: Update msautotest to use Pytest"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-127.html" title="MS RFC 127: Drop (broken) support for builds without GDAL and PROJ"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 128: Make C99 and C++11 build requirements</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-128-make-c99-and-c-11-build-requirements">
<span id="rfc128"></span><h1>MS RFC 128: Make C99 and C++11 build requirements<a class="headerlink" href="#ms-rfc-128-make-c99-and-c-11-build-requirements" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2019-12-02</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Even Rouault</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:even&#46;rouault&#37;&#52;&#48;spatialys&#46;com">even<span>&#46;</span>rouault<span>&#64;</span>spatialys<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Adopted</p>
</dd>
<dt class="field-odd">Last update<span class="colon">:</span></dt>
<dd class="field-odd"><p>2019-12-11</p>
</dd>
<dt class="field-even">Version<span class="colon">:</span></dt>
<dd class="field-even"><p>MapServer 7.6</p>
</dd>
</dl>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>MapServer currently requires C89 for its .c files and C++98/C++03 for its
.cpp files. We propose to bump the requirements to C99 and C++11.</p>
<p>This RFC is <em>not</em> about converting at once the whole code base to C99 or C++11,
but more about making it <em>possible</em> to do progressive porting where and
when it makes sense. Potential future larger changes of base data structures for
example will need to be addresed in dedicated RFCs.</p>
<p>More than a purely technical move, this is also intended to be an indication to
the community at large that MapServer can embrace “modern” technologies
(as far as one can consider standards of 9 or 20 years ago modern :-))</p>
</section>
<section id="rationale">
<h2>Rationale<a class="headerlink" href="#rationale" title="Link to this heading">¶</a></h2>
<p>This has been discussed at length in projects that MapServer depends on, and
which have already adopted the above requirements:</p>
<ul class="simple">
<li><p>GDAL: <a class="reference external" href="https://gdal.org/development/rfc/rfc68_cplusplus11.html">https://gdal.org/development/rfc/rfc68_cplusplus11.html</a></p></li>
<li><p>PROJ: <a class="reference external" href="https://proj.org/community/rfc/rfc-3.html">https://proj.org/community/rfc/rfc-3.html</a></p></li>
<li><p>GEOS: <a class="reference external" href="https://trac.osgeo.org/geos/wiki/RFC5">https://trac.osgeo.org/geos/wiki/RFC5</a></p></li>
</ul>
</section>
<section id="proposed-solution">
<h2>Proposed solution<a class="headerlink" href="#proposed-solution" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>In CMakeLists.txt, enforce C99 and C++11 requirements</p></li>
<li><p>In CMakeLists.txt, bump minimum version of CMake to 3.0: this just reflects
the current state of MapServer main which uses a 3.0 feature for Python
mapscripts.</p></li>
<li><p>Demo partial conversion in mapogcfiltercommon.c -&gt; mapogcfiltercommon.cpp</p></li>
</ul>
</section>
<section id="narrowing-down-c-api">
<h2>Narrowing down C API<a class="headerlink" href="#narrowing-down-c-api" title="Link to this heading">¶</a></h2>
<p>mapserver.h exposes a (too) large amount of functions as exported, mostly
in mapserver.h, but also in other headers.
We believe that most of them are not intended for external consumption.
Such a large amount of exported functions can be an obstacle to refactoring
and C++’ification. Looking in the archive of all source code that Debian
maintains for “mapserver.h” only points to MapCache as including mapserver.h
( <a class="reference external" href="https://codesearch.debian.net/search?q=mapserver.h">https://codesearch.debian.net/search?q=mapserver.h</a> )</p>
<p>We thus propose that removal of public symbols is permitted, provided that:</p>
<ul class="simple">
<li><p>MapServer binaries (mapserv, map2img, etc…) and MapScript, which are the main
users of the C API, still compile. If changes are needed in them and that they
doesn’t affect the user, they are permitted.</p></li>
<li><p>MapCache still compiles. If changes would be needed in MapCache to compile,
this must be discussed.</p></li>
</ul>
</section>
<section id="backwards-compatibility-issues">
<h2>Backwards Compatibility Issues<a class="headerlink" href="#backwards-compatibility-issues" title="Link to this heading">¶</a></h2>
<p>Obsolete environments where MapServer used to build and that have not natively
C99 support or C++11 will need to upgrade their toolchain.</p>
<p>On Windows side, this means Visual Studio 2015 or above.
For gcc, at least 4.8 is needed.</p>
<p>Current versions of Linux or Windows binary distribution we are aware of
have all the needed requirements. No change in the Travis and AppVeyor CI have
been needed to make the below proposed implementation work.</p>
</section>
<section id="security-implications">
<h2>Security implications<a class="headerlink" href="#security-implications" title="Link to this heading">¶</a></h2>
<p>None.</p>
</section>
<section id="mapscript-implications">
<h2>MapScript implications<a class="headerlink" href="#mapscript-implications" title="Link to this heading">¶</a></h2>
<p>None</p>
</section>
<section id="documentation-needs">
<h2>Documentation needs<a class="headerlink" href="#documentation-needs" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://mapserver.org/installation/unix.html">https://mapserver.org/installation/unix.html</a> and <a class="reference external" href="https://mapserver.org/installation/win32.html">https://mapserver.org/installation/win32.html</a>
will need to mention the new build requirements</p>
</section>
<section id="ticket-id-and-references">
<h2>Ticket ID and references<a class="headerlink" href="#ticket-id-and-references" title="Link to this heading">¶</a></h2>
<p>Pull request available at: <a class="reference external" href="https://github.com/MapServer/MapServer/pull/5939">https://github.com/MapServer/MapServer/pull/5939</a></p>
</section>
<section id="voting-history">
<h2>Voting history<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h2>
<p>Adopted with +1 from PSC members SethG, EvenR, MichaelS, JeffM, SteveL, JukkaR,
DanielM, StephanS, TomK</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 128: Make C99 and C++11 build requirements</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#rationale">Rationale</a></li>
<li><a class="reference internal" href="#proposed-solution">Proposed solution</a></li>
<li><a class="reference internal" href="#narrowing-down-c-api">Narrowing down C API</a></li>
<li><a class="reference internal" href="#backwards-compatibility-issues">Backwards Compatibility Issues</a></li>
<li><a class="reference internal" href="#security-implications">Security implications</a></li>
<li><a class="reference internal" href="#mapscript-implications">MapScript implications</a></li>
<li><a class="reference internal" href="#documentation-needs">Documentation needs</a></li>
<li><a class="reference internal" href="#ticket-id-and-references">Ticket ID and references</a></li>
<li><a class="reference internal" href="#voting-history">Voting history</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-129.html" title="MS RFC 129: Update msautotest to use Pytest"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-127.html" title="MS RFC 127: Drop (broken) support for builds without GDAL and PROJ"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 128: Make C99 and C++11 build requirements</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>