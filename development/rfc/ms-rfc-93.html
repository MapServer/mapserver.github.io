<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MS RFC 93: UTF Grid Support &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MS RFC 94: Shape Smoothing" href="ms-rfc-94.html" />
    <link rel="prev" title="MS RFC 92: Migrating from Autotools to CMake" href="ms-rfc-92.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/development/rfc/ms-rfc-93.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ms-rfc-94.html" title="MS RFC 94: Shape Smoothing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-92.html" title="MS RFC 92: Migrating from Autotools to CMake"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 93: UTF Grid Support</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ms-rfc-93-utf-grid-support">
<span id="rfc93"></span><h1>MS RFC 93: UTF Grid Support<a class="headerlink" href="#ms-rfc-93-utf-grid-support" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013/3/26</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Steve Lime</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:sdlime&#37;&#52;&#48;comcast&#46;net">sdlime<span>&#64;</span>comcast<span>&#46;</span>net</a></p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Thomas Bonfort</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:thomas&#46;bonfort&#37;&#52;&#48;gmail&#46;com">thomas<span>&#46;</span>bonfort<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Daniel Morissette</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:dmorissette&#37;&#52;&#48;mapgears&#46;com">dmorissette<span>&#64;</span>mapgears<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Mike Smith</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Francois Desjarlais</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="mailto:fdesjarlais1&#37;&#52;&#48;gmail&#46;com">fdesjarlais1<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">Status<span class="colon">:</span></dt>
<dd class="field-even"><p>Adopted</p>
</dd>
<dt class="field-odd">Version<span class="colon">:</span></dt>
<dd class="field-odd"><p>MapServer 7.0</p>
</dd>
</dl>
<section id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>UTFGrid is a open solution for specifying raster interaction data. The goal being to provide highly scalable user
interaction with raster maps. The objective of this RFC is to enable MapServer to produce UTFGrid output.</p>
<p>The UTFGrid encoding scheme encodes interactivity data for a raster tile in a space efficient manner. It is designed to be used in browsers, e.g. for displaying tooltips when hovering over certain features of a map tile.</p>
<p>Since slower browsers and machines can’t cope with rendering the actual polygons used to draw vectors on the map tile, we use a grid-based approach where we store the associated information for each pixel. UTFGrid uses JSON as a container format.</p>
<p>The full spec and interactive demos are available at <a class="reference external" href="https://github.com/mapbox/utfgrid-spec">https://github.com/mapbox/utfgrid-spec</a>.</p>
</section>
<section id="proposed-solution">
<h2>2. Proposed solution<a class="headerlink" href="#proposed-solution" title="Link to this heading">¶</a></h2>
<p>This work would add the ability to write UTFGrids (JSON) as output from a normal map draw operation, that is, via
CGI mode=map or WMS GetMap requests.</p>
</section>
<section id="rendering-the-utfgrid">
<h2>2.1 Rendering the UTFGrid<a class="headerlink" href="#rendering-the-utfgrid" title="Link to this heading">¶</a></h2>
<p>New UTFGrid renderer that would utilize the AGG library using an unsigned int32 canvas to encode feature IDs as their
literal UTF-8 respresentation. Feature IDs (starting at 1) would be assigned sequentially as features are rendered
and a reference to the feature’s key would be maintained as part of the rendering process. The list of feature keys
will be searched first to avoid duplication. It is certainly reasonable to define a key for feature that respresents a
thematic property, for example population age class, which would result far smaller output than keys that are unique
to each feature. A layers key item is defined by the new UTFITEM attribute.</p>
<p>The UTFRenderer will draw points, lines and polygons based loosely on the underlying style definition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Polygons</span><span class="p">:</span> <span class="n">solid</span> <span class="n">fill</span><span class="o">.</span>
<span class="n">Lines</span><span class="p">:</span> <span class="n">solid</span> <span class="n">line</span> <span class="k">with</span> <span class="n">width</span><span class="o">.</span> <span class="n">Patterns</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">applied</span><span class="o">.</span>
<span class="n">Points</span><span class="p">:</span> <span class="n">rectangle</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">bounding</span> <span class="n">box</span> <span class="n">of</span> <span class="n">the</span> <span class="n">symbol</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span>
</pre></div>
</div>
<p>Labels can be rendered using their parent feature id (derived via features UTFITEM) where the labels bounding box is
drawn to the map. It is also possible to choose the resolution of the grid. A larger resolution will make the grid
smaller and therefore reduce its weight but also its precision. These are optionals capabilities which can be enabled
through the output format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OUTPUTFORMAT</span>
  <span class="n">NAME</span> <span class="s2">&quot;myUTFGrid&quot;</span>
  <span class="n">DRIVER</span> <span class="n">UTFGRID</span>
  <span class="n">FORMATOPTION</span> <span class="s2">&quot;LABELS=true&quot;</span>
  <span class="n">FORMATOPTION</span> <span class="s2">&quot;UTFRESOLUTION=4&quot;</span>
  <span class="n">FORMATOPTION</span> <span class="s2">&quot;DUPLICATES=false&quot;</span>
<span class="n">END</span>
</pre></div>
</div>
<p>It may be desirable NOT to remove duplicate feature id/key pairs since that process could be expensive depending
on the number of features in the map. The format option duplicates=false can be used to skip this step. The resulting
JSON file will be a bit larger.</p>
<p>Note: due to upcoming changes to text rendering, Truetype symbols and labels rendering aren’t implemented yet and should
be added in the future.</p>
</section>
<section id="exposing-feature-properties">
<h2>2.2 Exposing Feature Properties<a class="headerlink" href="#exposing-feature-properties" title="Link to this heading">¶</a></h2>
<p>A new layer element (UTFDATA) is added to allow the creation of simple JSON templates using MapServer
expression syntax identical to what is used with classObj-&gt;text class text syntax. UTFDATA is of type
expressionObj. If UTFITEMs is set the UTFDATA expose those so that keys and data can be connected.</p>
<p>If a UTFITEM is not set the sequential id (based on rendering order) is being used.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UTFITEM</span> <span class="s2">&quot;fid&quot;</span>
<span class="n">UTFDATA</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">id</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[fid]</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[name]</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">country</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[country_code]</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">area</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[area]</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># no UTFITEM</span>
<span class="n">UTFDATA</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[name]</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">country</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[country_code]</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">area</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[area]</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
</pre></div>
</div>
<p>If no UTFDATA is provided no data beyond the UTFITEM values will be exposed and sometimes this is all that
is required.</p>
<p>UTFGrids can be set on multiple layers but only one UTFGrid can be rendered at a time. If you wish to
add multiples UTFGrid, with for example OpenLayers, you need to add new layer in the map for each of them.</p>
</section>
<section id="examples">
<h2>2.3 Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<p>This is how the output format should look like.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OUTPUTFORMAT</span>
  <span class="n">NAME</span> <span class="s2">&quot;utfgrid&quot;</span>
  <span class="n">DRIVER</span> <span class="n">UTFGRID</span>
  <span class="n">MIMETYPE</span> <span class="s2">&quot;application/json&quot;</span>
  <span class="n">EXTENSION</span> <span class="s2">&quot;json&quot;</span>
  <span class="n">FORMATOPTION</span> <span class="s2">&quot;UTFRESOLUTION=4&quot;</span>
  <span class="n">FORMATOPTION</span> <span class="s2">&quot;DUPLICATES=false&quot;</span>
<span class="n">END</span>
</pre></div>
</div>
<p>And this is how the new UTFITEM and UTFDATA word should be added in the layer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span>         <span class="n">basic</span>
  <span class="n">DATA</span>         <span class="n">ne_50m_admin_0_countries</span>
  <span class="n">TYPE</span>         <span class="n">POLYGON</span>
  <span class="n">PROJECTION</span>
    <span class="s2">&quot;init=epsg:4326&quot;</span>
  <span class="n">END</span>
  <span class="n">UTFITEM</span>   <span class="s2">&quot;postal&quot;</span>
  <span class="n">UTFDATA</span>   <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">admin</span><span class="se">\&quot;</span><span class="s2">:</span><span class="se">\&quot;</span><span class="s2">[admin]</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
<span class="n">END</span>
</pre></div>
</div>
<p>Here is an image rendered as a JSON with UTFGrid renderer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;                            &amp;&amp;&amp;&amp;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                       &amp;&amp; &amp;&amp;&amp;&amp;&amp;&amp;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                     &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                  &amp;&amp;&amp; &amp;&amp;&amp;)))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                    &amp;&amp;&amp;&amp;))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                   &amp;&amp;&amp;&amp;)))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                 &amp;&amp;&amp;&amp;)))))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;                &amp;&amp;&amp;&amp;&amp;)))))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;               &amp;&amp;&amp;&amp;&amp;))))))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;              &amp;&amp;&amp;&amp;&amp;&amp;))))))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;            &amp;&amp;&amp;&amp;&amp;&amp;))))))))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;         &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))))))))))))&quot;</span><span class="p">,</span>
  <span class="s2">&quot;       &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))))))))))) &quot;</span><span class="p">,</span>
  <span class="s2">&quot;    &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;))))))))))))   &quot;</span><span class="p">,</span>
  <span class="s2">&quot;   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))))))))    &quot;</span><span class="p">,</span>
  <span class="s2">&quot;   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))))))))    &quot;</span><span class="p">,</span>
  <span class="s2">&quot;   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))))))))    &quot;</span><span class="p">,</span>
  <span class="s2">&quot;   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;))))))))))))) !&quot;</span><span class="p">,</span>
  <span class="s2">&quot;   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;)))))))))))))))!&quot;</span><span class="p">,</span>
  <span class="s2">&quot;    &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;))))))))))))))  &quot;</span><span class="p">,</span>
  <span class="s2">&quot;    &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; )))))))))))))))  &quot;</span><span class="p">,</span>
  <span class="s2">&quot;    &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;   ))))))))))))     &quot;</span><span class="p">,</span>
  <span class="s2">&quot;       &amp;&amp;    $$ ))))))))))  ))) &quot;</span><span class="p">,</span>
  <span class="s2">&quot;          $$$$$$))))))))))) ))) &quot;</span><span class="p">,</span>
  <span class="s2">&quot;         $$$$$$  )))))))))) )   &quot;</span><span class="p">,</span>
  <span class="s2">&quot;         $$$$$$ $)))))))))      &quot;</span><span class="p">,</span>
  <span class="s2">&quot;         $$$$$$$$$))))          &quot;</span><span class="p">,</span>
  <span class="s2">&quot;         #$$$$$$$$))))$         &quot;</span><span class="p">,</span>
  <span class="s2">&quot;         ##$$$$$$$###    &#39;&#39;&#39;&#39;&#39;&#39;(&quot;</span><span class="p">,</span>
  <span class="s2">&quot;          ###########&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;    </span><span class="si">%%%%</span><span class="s2">#############&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&quot;</span>
 <span class="p">]</span>
</pre></div>
</div>
<p>And now we get the following keys and datas if we use the UTFITEM with the postal code as the key :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;keys&quot;</span><span class="p">:[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;AI&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;DK&quot;</span><span class="p">,</span><span class="s2">&quot;NL&quot;</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="s2">&quot;PL&quot;</span><span class="p">,</span><span class="s2">&quot;RUS&quot;</span><span class="p">,</span><span class="s2">&quot;S&quot;</span><span class="p">],</span><span class="s2">&quot;data&quot;</span><span class="p">:{</span><span class="s2">&quot;AI&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Aland&quot;</span><span class="p">},</span><span class="s2">&quot;D&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Germany&quot;</span><span class="p">},</span>
<span class="s2">&quot;DK&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Denmark&quot;</span><span class="p">},</span><span class="s2">&quot;NL&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Netherlands&quot;</span><span class="p">},</span><span class="s2">&quot;N&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Norway&quot;</span><span class="p">},</span><span class="s2">&quot;PL&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Poland&quot;</span><span class="p">},</span>
<span class="s2">&quot;RUS&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Russia&quot;</span><span class="p">},</span><span class="s2">&quot;S&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Sweden&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>And if we turn off the UTFITEM we obtain the following keys and datas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;keys&quot;</span><span class="p">:[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">,</span><span class="s2">&quot;6&quot;</span><span class="p">,</span><span class="s2">&quot;7&quot;</span><span class="p">,</span><span class="s2">&quot;8&quot;</span><span class="p">,</span><span class="s2">&quot;9&quot;</span><span class="p">],</span><span class="s2">&quot;data&quot;</span><span class="p">:{</span><span class="s2">&quot;1&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Aland&quot;</span><span class="p">},</span><span class="s2">&quot;2&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Germany&quot;</span><span class="p">},</span>
<span class="s2">&quot;3&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Denmark&quot;</span><span class="p">},</span><span class="s2">&quot;4&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Netherlands&quot;</span><span class="p">},</span><span class="s2">&quot;5&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Norway&quot;</span><span class="p">},</span><span class="s2">&quot;6&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Poland&quot;</span><span class="p">},</span>
<span class="s2">&quot;7&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Russia&quot;</span><span class="p">},</span><span class="s2">&quot;8&quot;</span><span class="p">:{</span><span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;Sweden&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>It is also possible to only keeps the UTFITEM which returns :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;keys&quot;</span><span class="p">:[</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;AI&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;DK&quot;</span><span class="p">,</span><span class="s2">&quot;NL&quot;</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="s2">&quot;PL&quot;</span><span class="p">,</span><span class="s2">&quot;RUS&quot;</span><span class="p">,</span><span class="s2">&quot;S&quot;</span><span class="p">],</span><span class="s2">&quot;data&quot;</span><span class="p">:{}</span>
</pre></div>
</div>
</section>
<section id="implementation-details">
<h2>3. Implementation Details<a class="headerlink" href="#implementation-details" title="Link to this heading">¶</a></h2>
<p>Additions:</p>
<ul class="simple">
<li><p>there are two new keywords (UTFDATA and UTFITEM) that exists at the layer-level</p></li>
<li><p>one new renderer (UTFGRID) will be made available</p></li>
</ul>
<p>Known limitations of the initial implementation produced during GSoC:</p>
<ul class="simple">
<li><p>Attribute values are not JSON-escaped, so the JSON output could be broken if the attribute values contain invalid characters. A JSON escaping function should be added for UTFGrid and would also be useful for general template support of JSON output.</p></li>
<li><p>Due to the upcoming changes to TrueType rendering, the renderTrueTypeSymbols method has not been implemented yet. All other types of symbols and labels are implemented.</p></li>
</ul>
</section>
<section id="files-affected">
<h2>4. Files affected<a class="headerlink" href="#files-affected" title="Link to this heading">¶</a></h2>
<p>The following files will be modified/added by this RFC:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mapserver</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">Add</span> <span class="n">new</span> <span class="n">output</span> <span class="nb">format</span> <span class="n">defines</span><span class="p">,</span> <span class="n">extend</span> <span class="n">layerObj</span><span class="p">,</span> <span class="n">etc</span><span class="o">...</span>
<span class="n">mapfile</span><span class="o">.</span><span class="n">c</span><span class="o">/</span><span class="n">mapfile</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">Add</span> <span class="n">new</span> <span class="n">keywords</span><span class="p">:</span> <span class="n">UTFITEM</span> <span class="ow">and</span> <span class="n">UTFDATA</span><span class="o">.</span>
<span class="n">mapoutput</span><span class="o">.</span><span class="n">c</span><span class="p">:</span> <span class="n">Add</span> <span class="n">appropriate</span> <span class="n">entries</span> <span class="k">for</span> <span class="n">new</span> <span class="n">UTFGRID</span> <span class="n">driver</span><span class="o">.</span>
<span class="n">maputfgrid</span><span class="o">.</span><span class="n">cpp</span><span class="o">/</span><span class="n">maputfgrid</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">Implementation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">new</span> <span class="n">UTFGrid</span> <span class="n">renderer</span><span class="o">.</span>
<span class="n">mapaggcommon</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">Common</span> <span class="n">resources</span> <span class="k">for</span> <span class="n">AGG</span> <span class="ow">and</span> <span class="n">UTFGrid</span> <span class="n">drivers</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="openlayers">
<h2>5. OpenLayers<a class="headerlink" href="#openlayers" title="Link to this heading">¶</a></h2>
<p>There is a patch submitted to the OpenLayers development team allowing use of UTFGrid on a WMS service. It is required in order to use the MapServer implementation of UTFGrid with OpenLayers</p>
<p>You can find it at <a class="reference external" href="https://github.com/fdesj/openlayers">https://github.com/fdesj/openlayers</a> in the utfgridwms branch. See also pull request at <a class="reference external" href="https://github.com/openlayers/openlayers/pull/1076">https://github.com/openlayers/openlayers/pull/1076</a></p>
<p>There is a working example in the OpenLayers library (exemples/utfgridwms.html).</p>
</section>
<section id="mapscript">
<h2>6. MapScript<a class="headerlink" href="#mapscript" title="Link to this heading">¶</a></h2>
<p>PHP MapScript will need get/set methods added to the layer class. Swig-based MapScript should need no changes.</p>
</section>
<section id="backwards-compatibility-issues">
<h2>7. Backwards Compatibility Issues<a class="headerlink" href="#backwards-compatibility-issues" title="Link to this heading">¶</a></h2>
<p>None anticipated.</p>
</section>
<section id="security-implications">
<h2>8. Security implications<a class="headerlink" href="#security-implications" title="Link to this heading">¶</a></h2>
<p>None anticipated.</p>
</section>
<section id="performance-implications">
<h2>9. Performance implications<a class="headerlink" href="#performance-implications" title="Link to this heading">¶</a></h2>
<p>No impacts on core performance are anticipated.</p>
</section>
<section id="documentation-needs">
<h2>10. Documentation needs<a class="headerlink" href="#documentation-needs" title="Link to this heading">¶</a></h2>
<p>The layer object documentation will need to be updated to reflect the new parameters. The output section will need a new UTFGrid HowTo page to talk about configuration options associated with the new output format.</p>
</section>
<section id="bug-id-and-references">
<h2>11. Bug ID and references<a class="headerlink" href="#bug-id-and-references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Tracking issue: <a class="reference external" href="https://github.com/MapServer/MapServer/pull/4765">https://github.com/MapServer/MapServer/pull/4765</a> (contains code diff)</p></li>
<li><p>You can find the original code developed during GSoC 2013 at <a class="reference external" href="https://github.com/fdesj/mapserver/tree/utfgridgsoc">https://github.com/fdesj/mapserver/tree/utfgridgsoc</a> in the utfgridgsoc branch (obsolete)</p></li>
<li><p>Doc updates created during GSoC are available in <a class="reference external" href="https://github.com/fdesj/docs/tree/rfc-93">https://github.com/fdesj/docs/tree/rfc-93</a></p></li>
<li><p>Pull request for msautotests at <a class="reference external" href="https://github.com/MapServer/msautotest/pull/24">https://github.com/MapServer/msautotest/pull/24</a> (obsolete)</p></li>
<li><p>Pull request for OpenLayers UTFGridWMS support at <a class="reference external" href="https://github.com/openlayers/openlayers/pull/1076">https://github.com/openlayers/openlayers/pull/1076</a></p></li>
<li><p>See also the GSoC project reports at <a class="reference external" href="https://github.com/MapServer/MapServer/wiki/GSoC-UTF-Grid-implementation">https://github.com/MapServer/MapServer/wiki/GSoC-UTF-Grid-implementation</a></p></li>
</ul>
</section>
<section id="voting-history">
<h2>12. Voting history<a class="headerlink" href="#voting-history" title="Link to this heading">¶</a></h2>
<p>+1 from DanielM, ThomasB, PerryN, SteveW, MikeS, SteveL, YewondwossenA, TamasS and StephanM</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MS RFC 93: UTF Grid Support</a><ul>
<li><a class="reference internal" href="#overview">1. Overview</a></li>
<li><a class="reference internal" href="#proposed-solution">2. Proposed solution</a></li>
<li><a class="reference internal" href="#rendering-the-utfgrid">2.1 Rendering the UTFGrid</a></li>
<li><a class="reference internal" href="#exposing-feature-properties">2.2 Exposing Feature Properties</a></li>
<li><a class="reference internal" href="#examples">2.3 Examples</a></li>
<li><a class="reference internal" href="#implementation-details">3. Implementation Details</a></li>
<li><a class="reference internal" href="#files-affected">4. Files affected</a></li>
<li><a class="reference internal" href="#openlayers">5. OpenLayers</a></li>
<li><a class="reference internal" href="#mapscript">6. MapScript</a></li>
<li><a class="reference internal" href="#backwards-compatibility-issues">7. Backwards Compatibility Issues</a></li>
<li><a class="reference internal" href="#security-implications">8. Security implications</a></li>
<li><a class="reference internal" href="#performance-implications">9. Performance implications</a></li>
<li><a class="reference internal" href="#documentation-needs">10. Documentation needs</a></li>
<li><a class="reference internal" href="#bug-id-and-references">11. Bug ID and references</a></li>
<li><a class="reference internal" href="#voting-history">12. Voting history</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ms-rfc-94.html" title="MS RFC 94: Shape Smoothing"
             >next</a> |</li>
        <li class="right" >
          <a href="ms-rfc-92.html" title="MS RFC 92: Migrating from Autotools to CMake"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Development</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Request for Comments</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MS RFC 93: UTF Grid Support</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>