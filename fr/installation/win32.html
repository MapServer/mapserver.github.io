<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compiler sous Win32 &#8212; MapServer 7.0.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '7.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="MapServer 7.0.3 documentation" href="../index.html" />
    <link rel="up" title="Installation" href="index.html" />
    <link rel="next" title="Installation de PHP MapScript" href="php.html" />
    <link rel="prev" title="Compiler sous Unix" href="unix.html" /> 
  </head>
  <body role="document">

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../installation/win32.html"><img src="../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../ar/installation/win32.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../de/installation/win32.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../el/installation/win32.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        
          
            <a href="../../es/installation/win32.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
          
        
        <img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" width="18px" height="13px"/>
        
          
            <a href="../../id/installation/win32.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../it/installation/win32.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        
          
            <a href="../../ja/installation/win32.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
          
        
        
          
            <a href="../../nl_NL/installation/win32.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
          
        
        
          
            <a href="../../pl/installation/win32.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../ru/installation/win32.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../sq/installation/win32.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../tr/installation/win32.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="php.html" title="Installation de PHP MapScript"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="unix.html" title="Compiler sous Unix"
             accesskey="P">précédent</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation de MapServer 7.0.3</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Installation</a> &#187;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="index-0"></span><div class="section" id="compiling-on-win32">
<span id="win32"></span><span id="index-1"></span><h1><a class="toc-backref" href="#table-of-contents">Compiler sous Win32</a><a class="headerlink" href="#compiling-on-win32" title="Lien permanent vers ce titre">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Pericles Nacionales</td>
</tr>
<tr class="field-even field"><th class="field-name">Contact:</th><td class="field-body">pnaciona at gmail.com</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table des matières</p>
<ul class="simple">
<li><a class="reference internal" href="#compiling-on-win32" id="id1">Compiler sous Win32</a><ul>
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#compiling" id="id3">Compiler</a></li>
<li><a class="reference internal" href="#set-up-a-project-directory" id="id4">Définir un répertoire de projet</a></li>
<li><a class="reference internal" href="#download-mapserver-source-code-and-supporting-libraries" id="id5">Télécharger le code source de Mapserver et les bibliothèques associées</a></li>
<li><a class="reference internal" href="#the-mapserver-source-code" id="id6">Le code source de Mapserver</a></li>
<li><a class="reference internal" href="#set-compilation-options" id="id7">Définir les options de compilation</a></li>
<li><a class="reference internal" href="#compile-the-libraries" id="id8">Compiler les bibliothèques</a></li>
<li><a class="reference internal" href="#compile-mapserver" id="id9">Compiler Mapserver</a></li>
<li><a class="reference internal" href="#compiling-mapserver-with-postgis-support" id="id10">Compiler MapServer avec le support de PostGIS</a></li>
<li><a class="reference internal" href="#common-compiling-errors" id="id11">Erreurs de  compilation communes</a></li>
<li><a class="reference internal" href="#installation" id="id12">Installation</a></li>
<li><a class="reference internal" href="#other-helpful-information" id="id13">Autres Informations utiles</a></li>
<li><a class="reference internal" href="#acknowledgements" id="id14">Remerciements</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#table-of-contents">Introduction</a><a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce document fournit un simple jeu de procédures de compilation pour MapServer sur les plateformes Win32.</p>
<p>Si vous êtes allé aussi loin, il y a des chances que vous connaissiez déjà MapServer et et que vous soyez au moins tentéd&#8217;essayer de le compiler vous-même. Les binaires précompilés pour MapServer sont disponibles depuis une variété de sources différentes. Référez-vous à <a class="reference internal" href="../download.html#windows"><span class="std std-ref">Windows</span></a>. Compiler MapServer pour les plateformes win32 peut être une tâche ardue, ainsi si des binaires existants sont suffisants pour vos besoins, il est fortement recommandé de les utiliser de préférence plutôt que d&#8217;essayer de compiler tout depuis les sources.</p>
<p>Cependant, il y a plusieurs raison de vouloir compiler MapServer à partir des sources sous win32. Ces raisons inclues la nécessité d&#8217;activer des options spécifiques, de le compiler avec des versions différentes de bibliothèques (comme GDAL), la volonté de la gestion de MapScript qui ne fait partie du coeur de la compilation, le besoin de débuguer et de corriger des bugs ou même d&#8217;implémenter de nouvelles fonctionnalités dans MapServer. Pour faciliter cela pour les utilisateurs et les développeurs, j&#8217;ai réalisé une liste d&#8217;étapes, accompagné d&#8217;exemples. Chaque exemple est une poursuite du précédent et se terminera par des programmes utilitaires, le programme CGI (mapserv.exe), le DLL MapServer (libmap.dll).</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Ce document peut se référer à des versions de bibliothèques un peu anciennes. Vous voudrez peut être essayer d&#8217;utiliser des versions plus récentes des bibliothèques pour votre compilation.</p>
</div>
</div>
<div class="section" id="compiling">
<h2><a class="toc-backref" href="#table-of-contents">Compiler</a><a class="headerlink" href="#compiling" title="Lien permanent vers ce titre">¶</a></h2>
<p>Si vous êtes nouveau à la programmation Windows, s&#8217;il vous plaît suivez ce document soigneusement. Les étapes de compilation sont assez simples mais j&#8217;ai ajouté quelques textes de présentation à chaque étape pour vous aider à comprendre comment MapServer compile. Pour les programmeurs expérimentés, peut être que la lecture du fichier  README.Win32 qui accompagne le code source MapServer sera plus utile. Pour ceux qui sont impatients, compiler MapServer implique le téléchargement et le désarchivage du code source, éditer les fichiers make et invoquer le compiler  Visual C++ de Microsoft à partir de la ligne de commande. Le mapserver.exe résultant est le programme CGI qui s&#8217;installe dans le répertoire cgi-bin de votre serveur web.</p>
<p>Pour ceux qui veulent prendre le temps, les étapes de compilation suivent</p>
</div>
<div class="section" id="set-up-a-project-directory">
<h2><a class="toc-backref" href="#table-of-contents">Définir un répertoire de projet</a><a class="headerlink" href="#set-up-a-project-directory" title="Lien permanent vers ce titre">¶</a></h2>
<p>Avant que vous commenciez à compiler MapServer, nous vous recommandons de créer un répertoire nommé &#8220;projets&#8221; où vous pouvez mettre le code source pour MapServer et ses bibliothèques de support. Comme, vous allez travailler avec des commandes en style DOS, vous devriez également vous habituer à la ligne de commande Windows. Pour les utilisateurs Windows 95/98, le processeur de commande devrait s&#8217;appeler command.com. Pour Windows NT/2000/XP, ce serait plutôt cmd.exe. Ainsi, lancez la vieille ligne de commande et allez sur le lecteur disque où vous voulez créer le répertoire du projet.</p>
<p>Voici un exemple de comment créer un répertoire appelé projects sur le lecteur disque C: :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span><span class="o">&gt;</span> <span class="n">mkdir</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>
</pre></div>
</div>
<p>Allez à ce répertoire</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span><span class="o">&gt;</span> <span class="n">cd</span> \<span class="n">Projects</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Depuis le répertoire projects, vous pouvez extraire les codes sources de MapServer et ses bibliothèques associées. Maintenant, vous êtes prêts à télécharger les codes sources.</p>
</div>
<div class="section" id="download-mapserver-source-code-and-supporting-libraries">
<h2><a class="toc-backref" href="#table-of-contents">Télécharger le code source de Mapserver et les bibliothèques associées</a><a class="headerlink" href="#download-mapserver-source-code-and-supporting-libraries" title="Lien permanent vers ce titre">¶</a></h2>
<p>Après la création d&#8217;un répertoire de projet, téléchargez le code source MapServer, les codes pour les bibliothèques support et sauvez les paquets de code source dans le nouveau répertoire créé &#8220;projets&#8221;. Ces codes source sont habituellement fournis sous forme de fichiers ZIP, ou TAR et GZIP UNIX.  Vous aurez besoin d&#8217;un logiciel pour les décompresser. <a class="reference external" href="http://www.7-zip.org/">7-Zip</a> est un exemple de logiciel qui peut gérer ces fichiers.</p>
<p>Cygwin est un logiciel libre, open-source qui qui est un portage de ces outils sur Windows.
Vous pouvez utiliser les utilitaires gzip et tar de cette collection d&#8217;outils. Cygwin est disponible depuis le site <a class="reference external" href="http://www.cygwin.com">http://www.cygwin.com</a>.</p>
<p>Dans le but de compiler le programme CGI de MapServer, vous devez télécharger quelques bibliothèques requises ou optionnelles. Dans sa configuration la plus simple, MapServer nécessite seulement les bibliothèques GD (pour fournir l&#8217;image en sortie) et REGEX (pour fournir la gestion des expressions régulières). Cette configuration permet aux développeurs/fournisseur de données d&#8217;utiliser des shapefiles comme entré et, en fonction de la version la bibliothèque GD utilisée, des images GIF ou PNG en sortie. Des bibliothèques supplémentaires sont nécessaires pour les données en entrée dans des formats alternatives. Les bibliothèques qui fonctionnent avec MapServer sont listées ci-dessous.</p>
</div>
<div class="section" id="the-mapserver-source-code">
<h2><a class="toc-backref" href="#table-of-contents">Le code source de Mapserver</a><a class="headerlink" href="#the-mapserver-source-code" title="Lien permanent vers ce titre">¶</a></h2>
<p>The MapServer source code can be downloaded from the
<a class="reference internal" href="../download.html#download"><span class="std std-ref">download page</span></a>. If you&#8217;d like to get the current development
version of the software, following the nightly snapshot link under the
Interim Builds title. The absolute latest copy of the source code can be
obtained from <a class="reference internal" href="../development/git.html#git"><span class="std std-ref">GitHub</span></a>; however, the GitHub repository does not contain several
important source files (maplexer.c, mapparser.c and
mapparser.h) normally generated on unix, so if possible, using a nightly
snaphot is substantially easier than working directly from <a class="reference internal" href="../development/git.html#git"><span class="std std-ref">GitHub</span></a>.</p>
<div class="section" id="required-libraries">
<h3><strong>Bibliothèques nécessaires</strong><a class="headerlink" href="#required-libraries" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="docutils">
<dt><a class="reference external" href="http://www.libgd.org/">Bibliothèque GD</a>:</dt>
<dd><p class="first last">MapServer utilise la bibliothèque graphique GD pour le rendu des images cartographiques au format GIF, PNG et JPEG. Ces images cartographiques sont affichées dans les navigateurs web clients en utilisant le CGI de MapServer. La version officielle actuelle de GD est la 2.0.33. Le Makefiles distribué est définie pour utiliser les binaires DLL précompilés de GD de Win32 qui inclut GD, libjpeg, libpng, libz et FreeType 2 dans une seule DLL. Ce paquet est généralement listé comme &#8220;Windows DLL .zip&#8221; et la dernière version est normalement disponible sur <a class="reference external" href="http://www.boutell.com/gd/http/gdwin32.zip">http://www.boutell.com/gd/http/gdwin32.zip</a>.</p>
</dd>
<dt>Regex :</dt>
<dd><p class="first last">Regex est une bibliothèque pour les expressions régulières utilisées par MapServer. Elle peut être téléchargée à l&#8217;adresse <a class="reference external" href="http://ftp.gnu.org/old-gnu/regex/regex-0.12.tar.gz">http://ftp.gnu.org/old-gnu/regex/regex-0.12.tar.gz</a></p>
</dd>
</dl>
</div>
<div class="section" id="optional-libraries">
<h3>Bibliothèques optionnelles<a class="headerlink" href="#optional-libraries" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="docutils">
<dt><a class="reference external" href="http://www.ijg.org/">Bibliothèque JPEG</a>:</dt>
<dd><p class="first last">Cette bibliothèque est nécessaire par GD pour le rendu des images JPEG, siGD est compilé à partir des sources. Vous pouvez télécharger cette bibliothèque sur <a class="reference external" href="http://www.ijg.org/files/jpegsrc.v6b.tar.gz">http://www.ijg.org/files/jpegsrc.v6b.tar.gz</a></p>
</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://www.libpng.org/pub/png/">PNG library</a>:</dt>
<dd><p class="first last">Cette bibliothèque est nécessaire par GD pour le rendu des images PNG, si GD est compilé à partir des sources. Vous pouvez télécharger cette bibliothèque sur <a class="reference external" href="http://sourceforge.net/projects/libpng/">http://sourceforge.net/projects/libpng/</a></p>
</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://www.gzip.org/zlib/">Zlib</a>:</dt>
<dd><p class="first last">Cette bibliothèque est nécessaire par libpng pour fournir la gestion de la compression graphique. Elle peut être téléchargé avec la bibliothèque PNG ou sur <a class="reference external" href="http://www.gzip.org/zlib.zip">http://www.gzip.org/zlib.zip</a> .</p>
</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://www.freetype.org/">FreeType 2</a>:</dt>
<dd>FreeType provides TrueType support in MapServer via GD.  We only need to
build FreeType separately if building GD from source.  It can be downloaded
at <a class="reference external" href="http://gnuwin32.sourceforge.net/packages/freetype.htm">http://gnuwin32.sourceforge.net/packages/freetype.htm</a> .</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://trac.osgeo.org/proj/">PROJ.4</a>:</dt>
<dd>PROJ.4 provides on-the-fly projection support to MapServer.  Users whose data
are in different projection systems can use this library to reproject into a
common projection.  It is also required for WMS, WFS or WCS services.</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://www.gdal.org/">GDAL/OGR</a>:</dt>
<dd><p class="first last">La bibliothèque GDAL/OGR permet à MapServer de lire une variété de formats géospatiales raster (GDAL) et des formats vectoriels (OGR). Il peut être téléchargé à <a class="reference external" href="http://www.gdal.org/">http://www.gdal.org/</a>.</p>
</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://www.esri.com/software/arcgis/arcsde/">ArcSDE</a>:</dt>
<dd><p class="first last">ArcSDE est le moteur de base de données spatiale propriétaire d&#8217;ESRI. La plupart des utilisateurs n&#8217;y auront pas accès mais si vous possédez une licence ArcSDE, vous pouvez utiliser ces bibliothèques pour permettre à MapServer d&#8217;accéder aux bases de données SDE.</p>
</dd>
</dl>
<dl class="docutils">
<dt><a class="reference external" href="http://www.lmic.state.mn.us/resource.html?Id=3603">EPPL7</a>:</dt>
<dd><p class="first last">Cette bibliothèque permet à MapServer de lire les jeux de données EPPL7, ainsi que les fichiers plus vieux Erdas LAN/GIS. Cette bibliothèque est définie comme une par défaut dans MapServer, il n&#8217;y a donc pas de code source spécifique à télécharger.</p>
</dd>
</dl>
<p>Maintenant que vous avez vue les bibliothèques qui apporte des fonctionnalités à MapServer, il est temps de décider laquelle compiler et utiliser. Nous travaillerons avec la version précompilée de GD distribuée sur Boutell.com avec PNG, GIF, JPEG et FreeType inclues. Si vous désirez fournir des services web OGC (ie. WMS, WFS) ou réaliser la reprojection à la volée alors la bibliothèque Proj.4 sera nécessaire. Si vous désirez des sources de données raster et vecteur supplémentaires considérez l&#8217;inclusion de la gestion de GDAL/OGR. GDAL est aussi nécessaire pour les services WCS.</p>
<p>Our example calls for the required libraries and on-the-fly projection support
so we need to download GD, regex, and PROJ.4 libraries.  Go ahead and get those
libraries.</p>
</div>
</div>
<div class="section" id="set-compilation-options">
<h2><a class="toc-backref" href="#table-of-contents">Définir les options de compilation</a><a class="headerlink" href="#set-compilation-options" title="Lien permanent vers ce titre">¶</a></h2>
<p>MapServer, comme la plupart de ses dépendances, vient avec un makefile Visual C++ appelé Makefile.vc. Il inclut le fichier nmake.opt qui contient de nombreux définitions spécifiques au site. Nous aurons seulement besoin d&#8217;éditer le fichier nmake.opt pour configurer la compilation pour nos options de site local, et nos bibliothèques de dépendances. Le Makefile.vc, et le fichier de template nmake.opt ont été fournis par Assefa Yewondwossen et les gens de DM Solutions.</p>
<p>A partir de MapServer 4.4, les options de compilation par défaut de MapServer incluent seulement GD, et regex. MapServer est compilé en utilisant l&#8217;option /MD (ce qui signifie que MSVCRT.DLL doit être utilisé), ainsi à partir du moment où les dépendances sont compilées statiquement (plutôt que comme des DLLs), nous avons besoin d&#8217;utiliser /MD quand on les compile également. Par défaut, les versions récentes de PROJ.4 utilisent /MD, ainsi nous devrions être capable d&#8217;utiliser les sources par défaut de PROJ.4 build sans ajustement.</p>
<p>L&#8217;exemple sera compilé aussi bien avec la DLL précompilée GDWin32 que regex-0.12, et PROJ.4. Le support de PROJ.4 assurera que nous puvons activé la compatibilité avec les services OGC-WMS MapServer. Utilisez notepad ou un autre éditeur de texte pour ouvrir le fichier nmake.opt et faites les changements suivants.</p>
<div class="section" id="comments">
<h3>Commentaires<a class="headerlink" href="#comments" title="Lien permanent vers ce titre">¶</a></h3>
<p>Utiliser le signe dièse ( # ) pour commenter les lignes que vous souhaitez désactiver, ou enlever le signe dièse pour activer une option pour NMAKE.</p>
<p>A. Enable PROJ.4 support, and update the path to the PROJ.4
directory.   Uncomment the PROJ= line, and the PROJ_DIR= line as follows,
and update the PROJ_DIR path to point to your PROJ build.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Reprojecting.</span>
<span class="c1"># If you would like mapserver to be able to reproject data from one</span>
<span class="c1"># geographic projection to another, uncomment the following flag</span>
<span class="c1"># PROJ.4 distribution (cartographic projection routines).  PROJ.4 is</span>
<span class="c1"># also required for all OGC services (WMS, WFS, and WCS).</span>
<span class="c1">#</span>
<span class="c1"># For PROJ_DIR use full path to PROJ.4 distribution</span>
<span class="n">PROJ</span><span class="o">=-</span><span class="n">DUSE_PROJ</span> <span class="o">-</span><span class="n">DUSE_PROJ_API_H</span>
<span class="n">PROJ_DIR</span><span class="o">=</span><span class="n">c</span><span class="p">:</span>\<span class="n">projects</span>\<span class="n">proj</span><span class="o">-</span><span class="mf">4.4</span><span class="o">.</span><span class="mi">9</span>
</pre></div>
</div>
<p>Si vous regardez plus bas dans le fichier, vous pouvez voir qu&#8217;une fois que PROJ est activé, MapServer sera lié avec proj_i.lib, la bibliothèque bouchon PROJ.4, signifiant que MapServer utilisera PROJ.DLL à l&#8217;opposé d&#8217;un lien statique dans PROJ.4.</p>
<ol class="upperalpha simple" start="2">
<li><p class="first">Décommenter l&#8217;option WMS</p>
</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Use this flag to compile with WMS Server support.</span>
<span class="c1"># To find out more about the OpenGIS Web Map Server Specification go to</span>
<span class="c1"># http://www.opengis.org/</span>
<span class="n">WMS</span><span class="o">=-</span><span class="n">DUSE_WMS_SVR</span>
</pre></div>
</div>
<ol class="upperalpha simple" start="3">
<li><p class="first">Mise à jour pour utiliser GD.  Voici ce à quoi il devrait ressembler dans notre exemple.</p>
</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>GD_DIR=c:/projects/gdwin32
GD_LIB=$(GD_DIR)/bgd.lib
</pre></div>
</div>
<p><strong>Note</strong>: Comme il distribué, le binaire GDWin32 n&#8217;inclut pas la bibliothèque bouchon bgd.lib. Il est nécessaire en premier de lancer le script <strong>makemsvcimport.bat</strong> dans le répertoire gdwin32.</p>
<p>D. Make sure the regex path is set correctly.  In order for the
&#8220;delete&#8221; command in the &#8220;nmake /f makefile.vc clean&#8221; target to work properly
it is necessary to use backslashes in the REGEX_DIR definition.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># REGEX Library
#
# VC++ does not include the REGEX library... so we must provide our one.
# The following definitions will try to build GNU regex-0.12 located in the
# regex-0.12 sub-directory.
# If it was not included in the source distribution, then you can get it from:

#    ftp://ftp.gnu.org/pub/gnu/regex/regex-0.12.tar.gz
# Provide the full path to the REGEX project directory
# You do not need this library if you are compiling for PHP mapscript.
# In that case the PHP regex library will be used instead
!IFNDEF PHP
REGEX_DIR=c:\projects\regex-0.12
!ENDIF
</pre></div>
</div>
<p>Votre Makefile est maintenant défini.</p>
</div>
</div>
<div class="section" id="compile-the-libraries">
<h2><a class="toc-backref" href="#table-of-contents">Compiler les bibliothèques</a><a class="headerlink" href="#compile-the-libraries" title="Lien permanent vers ce titre">¶</a></h2>
<p>Avant de compiler MapServer, vous devez en premier compiler les librairies de dépendances. La manière dont cela s&#8217;effectue varie selon chaque bibliothèque. Pour la bibliothèque PROJ.4, une commande <strong>nmake /f makefile.vc</strong> dans le répertoire proj-4.4.9src devrait être suffisant . Le code de regex-0.12 est actuellement compilé lors du processus de compilation de MapServer, donc vous n&#8217;avez rien besoin de faire ici.</p>
<div class="section" id="compiling-libcurl">
<h3>Compiler libcurl<a class="headerlink" href="#compiling-libcurl" title="Lien permanent vers ce titre">¶</a></h3>
<p>Auparavant, les bibliothèques curl pouvaient être compilées en utilisant la commande suivante:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmake</span> <span class="o">/</span><span class="n">f</span> <span class="n">makefile</span><span class="o">.</span><span class="n">vc6</span> <span class="n">CFG</span><span class="o">=</span><span class="n">release</span>
</pre></div>
</div>
<p>Cela crée une bibliothèque statique, libcurl.lib, contre laquelle vous allez compiler. Les versions plus récentes que la version 7.10.x devraient être compilées comme bibliothèque dynamique. Cela se fait en utilisant la commande:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmake</span> <span class="o">/</span><span class="n">f</span> <span class="n">makefile</span><span class="o">.</span><span class="n">vc6</span> <span class="n">CFG</span><span class="o">=</span><span class="n">release</span><span class="o">-</span><span class="n">dll</span>
</pre></div>
</div>
<p>Vous aurez besoin d&#8217;éditer le nmake.opt de MapServer pour remplacer la variable CURL_LIB avec cette ligne:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>CURL_LIB = $(CURL_DIR)/lib/libcurl_imp.lib
</pre></div>
</div>
</div>
</div>
<div class="section" id="compile-mapserver">
<h2><a class="toc-backref" href="#table-of-contents">Compiler Mapserver</a><a class="headerlink" href="#compile-mapserver" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un fois que vous avez compilé les librairies de dépendances avec succès, vous êtes prêts à passer à l&#8217;étape finale de compilation. Si vous ne l&#8217;avez pas encore fait, ouvrez une invite de commande et définissez  les variables d&#8217;environnement VC++ en lançant vcvars32.bat habituellement situé dans <strong>C:Program FilesMicrosoft Visual StudioVC98binvcvars32.bat</strong>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span><span class="o">&gt;</span> <span class="n">cd</span> \<span class="n">projects</span>\<span class="n">mapserver</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>\<span class="n">mapserver</span><span class="o">&amp;&gt;</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">Visual</span> <span class="n">Studio</span>\<span class="n">VC98</span>\<span class="n">Bin</span>\<span class="n">vcvars32</span><span class="o">.</span><span class="n">bat</span><span class="s2">&quot;</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>\<span class="n">mapserver</span><span class="o">&gt;</span>

<span class="n">Setting</span> <span class="n">environment</span> <span class="k">for</span> <span class="n">using</span> <span class="n">Microsoft</span> <span class="n">Visual</span> <span class="n">C</span><span class="o">++</span> <span class="n">tool</span><span class="o">.</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>\<span class="n">mapserver</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Maintenant exécuter la commande: <strong>nmake /f Makefile.vc</strong> et attendez qu&#8217;elle finisse de compiler. Si elle compile avec succès, vous devriez obtenir les fichiers mapserver.lib, libmap.dll, mapserv.exe, et d&#8217;autres .EXE. C&#8217;est tout pour le processus de compilation. Si vous rencontrez des problèmes, lisez la section 4 sur les erreurs de compilation. Vous pouvez aussi demander de l&#8217;aide aux sympathiques abonnés de la liste de diffusion MapServer-dev.</p>
</div>
<div class="section" id="compiling-mapserver-with-postgis-support">
<h2><a class="toc-backref" href="#table-of-contents">Compiler MapServer avec le support de PostGIS</a><a class="headerlink" href="#compiling-mapserver-with-postgis-support" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour compiler le support de PostGIS dans MapServer, voici ce que vous aurez besoin de faire:</p>
<ol class="arabic simple">
<li><p class="first">télécharger les sources de PostgreSQL 8.0.1 (ou plus récent) depuis: <a class="reference external" href="ftp://ftp.heanet.ie/pub/postgresql/source/">ftp://ftp.heanet.ie/pub/postgresql/source/</a></p>
</li>
<li><p class="first">Je les ai extrait dans C:projectspostgresql-8.0.1</p>
</li>
<li><p class="first">télécharger <a class="reference external" href="http://www.microsoft.com/downloads/details.aspx?familyid=E6E1C3DF-A74F-4207-8586-711EBE331CDC&amp;displaylang=en">le SDK de la plateforme Microsoft</a> sinon vous aurez des erreurs de liens sur shfolder.lib.</p>
</li>
<li><p class="first">compiler libpq sous C:projectspostgresql-8.0.1srcinterfaceslibpq en utilisant le makefile win32.mak</p>
</li>
<li><p class="first">copier tout de C:projectspostgresql-8.0.1srcinterfaceslibpqrelease vers C:projectspostgresql-8.0.1srcinterfaceslibpq comme le makefile de MapServer cherchera à le trouver ici</p>
</li>
<li><p class="first">Définir ce qui suit dans le fichier nmake.opt pour MapServer: POSTGIS =-DUSE_POSTGIS POSTGIS_DIR =c:/projects/postgresql-8.0.1/src</p>
</li>
<li>nmake /f makefile.vc</li>
<li><p class="first">n&#8217;oubliez pas de copier libpq.dll (depuis C:projectspostgresql-8.0.1srcinterfaceslibpqrelease) dans un emplacement où MapServer pourra le trouver.</p>
</li>
</ol>
</div>
<div class="section" id="common-compiling-errors">
<h2><a class="toc-backref" href="#table-of-contents">Erreurs de  compilation communes</a><a class="headerlink" href="#common-compiling-errors" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce qui suit donne quelques unes des erreur courantes que vous êts susceptibles de rencontrer en essayant de compiler MapServer.</p>
<blockquote>
<div><ul>
<li><p class="first">Outils de Visual C++ incorrectement initialisés</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">projects</span>\<span class="n">mapserver</span><span class="o">&gt;</span> <span class="n">nmake</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">makefile</span><span class="o">.</span><span class="n">vc</span>
<span class="s1">&#39;nmake&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">recognized</span> <span class="k">as</span> <span class="n">an</span> <span class="n">internal</span> <span class="ow">or</span> <span class="n">external</span> <span class="n">command</span><span class="p">,</span>
<span class="n">operable</span> <span class="n">program</span> <span class="ow">or</span> <span class="n">batch</span> <span class="n">file</span><span class="o">.</span>
</pre></div>
</div>
<p>Cela a lieu si vous n&#8217;avez pas correctement défini le chemin et les autres variables d&#8217;environnement requises pour utiliser MS VisualC++ depuis la ligne de commande. Invoquez le script VCVARS32.BAT, habituellement avec la commande <strong>C:Program FilesMicrosoft Visual StudioVC98binvcvars32.bat</strong> ou quelque chose de similaire si visual studio est installé dans un emplacement alternatif. Pour tester si VC++ est disponible, tapez juste &#8220;nmake&#8221; ou &#8220;cl&#8221; dans la ligne de commande et assurez-vous qu&#8217;il est trouvé.</p>
</li>
<li><p class="first">Problèmes de compilation des Regex</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="o">.</span><span class="n">obj</span> <span class="p">:</span> <span class="n">error</span> <span class="n">LNK2001</span><span class="p">:</span> <span class="n">unresolved</span> <span class="n">external</span> <span class="n">symbol</span> <span class="n">_printchar</span>
<span class="n">libmap</span><span class="o">.</span><span class="n">dll</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">LNK1120</span><span class="p">:</span> <span class="mi">1</span> <span class="n">unresolved</span> <span class="n">externals</span>
<span class="n">NMAKE</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">U1077</span><span class="p">:</span> <span class="s1">&#39;link&#39;</span> <span class="p">:</span> <span class="k">return</span> <span class="n">code</span> <span class="s1">&#39;0x460&#39;</span>
<span class="n">Stop</span><span class="o">.</span>
</pre></div>
</div>
<p>Cela a lieu si vous utilisez le regex-0.12 que nous avons référencé. J&#8217;ai contourné ça en commentant la déclaration &#8220;extern&#8221; pour la fonction printchar(), et en la remplaçant par l&#8217;implémentation d&#8217;un bouchon dans regex-0.12regex.c.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">extern</span> <span class="n">void</span> <span class="n">printchar</span> <span class="p">();</span>
<span class="n">void</span> <span class="n">printchar</span><span class="p">(</span> <span class="nb">int</span> <span class="n">i</span> <span class="p">)</span> <span class="p">{}</span>
</pre></div>
</div>
</li>
<li><p class="first">Import de la bibliothèque GD manquant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LINK</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">LNK1104</span><span class="p">:</span> <span class="n">cannot</span> <span class="nb">open</span> <span class="n">file</span> <span class="s1">&#39;c:/projects/gdwin32/bgd.lib&#39;</span>
<span class="n">NMAKE</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">U1077</span><span class="p">:</span> <span class="s1">&#39;link&#39;</span> <span class="p">:</span> <span class="k">return</span> <span class="n">code</span> <span class="s1">&#39;0x450&#39;</span>
<span class="n">Stop</span><span class="o">.</span>
</pre></div>
</div>
<p>Si vous utilisez les binaires précompilés de GD, vous aurez toujours besoin de lancer le script <strong>makemsvcimport.bat</strong> dans le répertoire gdwin32 pour créer une bibliothèque bouchon compatible avec VC++ (bgd.lib).</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#table-of-contents">Installation</a><a class="headerlink" href="#installation" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le fichier qui nous intérese le plus est mapserv.exe. Les autres fichiers exécutables sont les programmes utilitaires MapServer.</p>
<div class="admonition seealso">
<p class="first admonition-title">Voir aussi</p>
<p class="last"><a class="reference internal" href="../utilities/index.html#utilities"><span class="std std-ref">Utilitaires MapServer</span></a></p>
</div>
<p>pour en savoir plus sur ces utilitaires</p>
<p>Pour tester que votre programme CGI fonctionne, tapez mapserv.exe dans la ligne de commande. Vous devriez voir le message suivant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">script</span> <span class="n">can</span> <span class="n">only</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">decode</span> <span class="n">form</span> <span class="n">results</span> <span class="ow">and</span>
<span class="n">should</span> <span class="n">be</span> <span class="n">initiated</span> <span class="k">as</span> <span class="n">a</span> <span class="n">CGI</span> <span class="n">process</span> <span class="n">via</span> <span class="n">a</span> <span class="n">httpd</span> <span class="n">server</span><span class="o">.</span>
</pre></div>
</div>
<p>Vous aurez peut être à la place une popup indiquant qu&#8217;une DLL(comme bgd.dll) est manquante. Vous devrez copier toutes les DLLS requises (c&#8217;est à dire bgd.dll, et proj.dll) dans le même répertoire que le programme mapserv.exe.</p>
<p>Maintenant, tapez mapserv -v dans la ligne de commande pour avoir ce message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">MapServer</span> <span class="n">version</span> <span class="mf">4.4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">beta3</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">GIF</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">PNG</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">JPEG</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">WBMP</span>
<span class="n">SUPPORTS</span><span class="o">=</span><span class="n">PROJ</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">FREETYPE</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WMS_SERVER</span> <span class="n">INPUT</span><span class="o">=</span><span class="n">SHAPEFILE</span>
<span class="n">DEBUG</span><span class="o">=</span><span class="n">MSDEBUG</span>
</pre></div>
</div>
<p>Cela nous dit quels formats de données et autres opions sont supportées par mapserv.exe. En assumant que vous avez un serveur web configuré, copiez mapserv.exe, libmap.dll, bgd.dll, proj.dll et les autres DLLs requises dans votre répertoire cgi-bin.</p>
<p>Vous êtes maintenant prêts à télécharger l&#8217;application de démo et à essayer votre propre programme CGI MapServer. Si vous le souhaitez, vous pouvez aussi créer un répertoire pour stocker les programmes utilitaires. Je vous suggérerait de créer un sous-répertoire appelé &#8220;bin&#8221; sous le dossier &#8220;projects&#8221; et de copier les exécutables dans ce répertoire. Vous trouverez peut être ces programmes utiles lors du développement d&#8217;applications MapServer.</p>
</div>
<div class="section" id="other-helpful-information">
<h2><a class="toc-backref" href="#table-of-contents">Autres Informations utiles</a><a class="headerlink" href="#other-helpful-information" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les HOWTO de l&#8217;installation et de la compilation Unix donnent de bonnes descriptions de quelqu&#8217;unes des options de compilation de MapServer et ses problèmes de bibliothèques. J&#8217;écrirais plus sur ces options et problèmes dans une nouvelle révision de ce HOWTO.</p>
<p>Les documents README de chaque bibliothèque supportée fournissent les instructions de compilation pour Windows.</p>
<p>La communauté d&#8217;utilisateurs de MapServer a une connaissance collective des nuances de la compilation sous MapServer. Cherchez leur conseils à bon escient.</p>
</div>
<div class="section" id="acknowledgements">
<h2><a class="toc-backref" href="#table-of-contents">Remerciements</a><a class="headerlink" href="#acknowledgements" title="Lien permanent vers ce titre">¶</a></h2>
<p>Merci à Assefa Yewondwossen pour avoir fourni le fichier Makefile.vc. Je n&#8217;aurais pas été capable d&#8217;écrire ce HOWTO sans cela.</p>
<p>Merci à Bart van den Eijnden pour les informations de compilation de libcurl et PostGIS.</p>
<p>Merci à Steve Lime pour le développement de MapServer et aux nombreux développeurs qui contribuent par leur temps et leurs efforts à faire du projet MapServer une réussite.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a>
</p>
  <h3>Current Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Compiler sous Win32</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#compiling">Compiler</a></li>
<li><a class="reference internal" href="#set-up-a-project-directory">Définir un répertoire de projet</a></li>
<li><a class="reference internal" href="#download-mapserver-source-code-and-supporting-libraries">Télécharger le code source de Mapserver et les bibliothèques associées</a></li>
<li><a class="reference internal" href="#the-mapserver-source-code">Le code source de Mapserver</a><ul>
<li><a class="reference internal" href="#required-libraries"><strong>Bibliothèques nécessaires</strong></a></li>
<li><a class="reference internal" href="#optional-libraries">Bibliothèques optionnelles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#set-compilation-options">Définir les options de compilation</a><ul>
<li><a class="reference internal" href="#comments">Commentaires</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compile-the-libraries">Compiler les bibliothèques</a><ul>
<li><a class="reference internal" href="#compiling-libcurl">Compiler libcurl</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compile-mapserver">Compiler Mapserver</a></li>
<li><a class="reference internal" href="#compiling-mapserver-with-postgis-support">Compiler MapServer avec le support de PostGIS</a></li>
<li><a class="reference internal" href="#common-compiling-errors">Erreurs de  compilation communes</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#other-helpful-information">Autres Informations utiles</a></li>
<li><a class="reference internal" href="#acknowledgements">Remerciements</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="php.html" title="Installation de PHP MapScript"
             >suivant</a> |</li>
        <li class="right" >
          <a href="unix.html" title="Compiler sous Unix"
             >précédent</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation de MapServer 7.0.3</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Installation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2016, Open Source Geospatial Foundation.
      Mis à jour le 2016-12-09.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>