
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta charset="utf-8" />
    <title>Services de tuilage supportés &#8212; MapServer 7.2.2 documentation</title>
    <link rel="stylesheet" href="../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    
    <link rel="shortcut icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Alimentation du cache" href="seed.html" />
    <link rel="prev" title="Fichier de configuration" href="config.html" /> 
  </head><body>

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../mapcache/services.html"><img src="../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../ar/mapcache/services.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../de/mapcache/services.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../el/mapcache/services.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        
          
            <a href="../../es/mapcache/services.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
          
        
        <img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" width="18px" height="13px"/>
        
          
            <a href="../../id/mapcache/services.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../it/mapcache/services.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        
          
            <a href="../../ja/mapcache/services.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
          
        
        
          
            <a href="../../nl_NL/mapcache/services.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
          
        
        
          
            <a href="../../pl/mapcache/services.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../ru/mapcache/services.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../sq/mapcache/services.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../tr/mapcache/services.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="seed.html" title="Alimentation du cache"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="config.html" title="Fichier de configuration"
             accesskey="P">précédent</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.2.2 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">MapCache 1.6.1</a> &#187;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="supported-tile-services">
<span id="mapcache-services"></span><h1>Services de tuilage supportés<a class="headerlink" href="#supported-tile-services" title="Lien permanent vers ce titre">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Thomas Bonfort</p>
</dd>
<dt class="field-even">Contact</dt>
<dd class="field-even"><p>tbonfort at terriscope.fr</p>
</dd>
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Stephen Woodbridge</p>
</dd>
</dl>
<p>MapCache a la capacité de servir des tuiles en utilisant de nombreux protocoles de requête et de conventions de nommage pour les tuiles. Le but de ce document est de les décrire. Les divers services doivent être activés dans le fichier mapcache.xml afin que MapCache puisse répondre à leurs requêtes spécifiques.</p>
<p>Tous les services sont disponibles dans l’interface de démonstration, à partir duquel vous être encouragés à copier/coller le code JavaScript avant de vous lancer dans le codage de vos propres pages utilisant les tuiles MapCache.</p>
<p>La notation suivante est utilisée sur cette page et fait référence aux noms des objets dans le fichier de configuration mapcache.xml.</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;tileset_name&gt; - nom d’un jeu de tuiles configuré</p></li>
<li><p>&lt;grid_name&gt; - nom de la grille définie explicitement ou implicitement</p></li>
<li><p>&lt;quadkey&gt; - spécifique au service de tuilage Virtual Earth</p></li>
<li><p>&lt;z&gt; - Niveau de zoom dans le schéma de nommage zxy</p></li>
<li><p>&lt;y&gt; - numéro de ligne dans le schéma de nommage zxy</p></li>
<li><p>&lt;x&gt; - numéro de colonne dans le schéma de nommage zxy</p></li>
</ul>
</div></blockquote>
<div class="section" id="tms-service">
<span id="mapcache-tms"></span><h2>Service TMS<a class="headerlink" href="#tms-service" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le service TMS service utilise un schéma de tuilage de type z/x/y où:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>z</em> est le niveau de zoom</p></li>
<li><p><em>x</em> est le numéro de colonne</p></li>
<li><p><em>y</em> est le numéro de ligne</p></li>
</ul>
</div></blockquote>
<p>Pour activer le service TMS, ajoutez ces lignes au fichier de configuration mapcache.xml:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;tms&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Un document de « capabilities » peut être récupéré via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">myhost</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mapcache</span><span class="o">/</span><span class="n">tms</span><span class="o">/</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span>
</pre></div>
</div>
<p>Les tuiles sont demandées en utilisant le schéma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">myhost</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mapcache</span><span class="o">/</span><span class="n">tms</span><span class="o">/</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="o">/&lt;</span><span class="n">tileset_name</span><span class="o">&gt;@&lt;</span><span class="n">grid_name</span><span class="o">&gt;/&lt;</span><span class="n">z</span><span class="o">&gt;/&lt;</span><span class="n">x</span><span class="o">&gt;/&lt;</span><span class="n">y</span><span class="o">&gt;.</span><span class="n">png</span>
</pre></div>
</div>
<p>Pour les grilles epsg:3857 ou epsg:900913 ou GoogleMapsCompatible, avec cellules = [z/x/y]:</p>
<p>z0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>z1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>z2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">...</span>
<span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span><span class="o">...</span>
</pre></div>
</div>
<p>etc…</p>
<p>Pour les grilles epsg:4326 ou WGS84:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La spécification OGC WMTS impose de manière un peu absurde au WellKnownScaleset GoogleCRS84Quad d’avoir un niveau 0 dont l’étendue géographiques est -180,-180,180,180. La grille MapCache par défaut « WGS84 » respecte cela, ce qui peut provoquer des incompatibilités avec les logiciels qui s’attendent à ce qu’au niveau 0 on ait 2 x 1 tuiles avec pour étendue -180,-90,180,90</p>
</div>
<p>z0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>z1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>z2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>etc.</p>
</div>
<div class="section" id="kml-service">
<span id="mapcache-kml"></span><h2>Service KML<a class="headerlink" href="#kml-service" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le service KML produit des “<a class="reference external" href="http://code.google.com/apis/kml/documentation/kml_21tutorial.html#superoverlays">Super-Overlays</a> pour les jeux de tuiles qui sont alignés sur les grilles WGS84 / epsg:4326. Un Super-Overlay est un fichier KML liée à l’URL d’une image du cache et à un ensemble d’autres URLs correspondant aux résolutions voisines. Le service KML utilise un modèle de nommage de tuiles z/x/y où:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>z</em> est le niveau de zoom</p></li>
<li><p><em>x</em> est le numéro de colonne</p></li>
<li><p><em>y</em> est le numéro de ligne</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour que le service KML soit opérationnel, le service TMS doit aussi être activé car le KML Super-Overlay fait un lien vers les images en utilisant cette spécification.</p>
</div>
<p>Pour activer le service KML, ajoutez ces lignes au fichier de configuration mapcache.xml:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;tms&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;kml&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Les tuiles sont demandées en utilisant le schéma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">myhost</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mapcache</span><span class="o">/</span><span class="n">kml</span><span class="o">/&lt;</span><span class="n">tileset_name</span><span class="o">&gt;@&lt;</span><span class="n">grid_name</span><span class="o">&gt;/&lt;</span><span class="n">z</span><span class="o">&gt;/&lt;</span><span class="n">x</span><span class="o">&gt;/&lt;</span><span class="n">y</span><span class="o">&gt;.</span><span class="n">kml</span>
</pre></div>
</div>
</div>
<div class="section" id="ogc-wmts-service">
<span id="mapcache-wmts"></span><h2>Service WMTS OGC<a class="headerlink" href="#ogc-wmts-service" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour activer le service WMTS, ajoutez ces lignes au fichier de configuration mapcache.xml:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;wmts&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Ce service respecte les requêtes du standard OGC WMTS et accepte à la fois les requêtes classiques OGC en mode KVP et les requêtes de type REST.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://myhost.com/mapcache/wmts?SERVICE=WMTS&amp;VERSION=1.0.0&amp;...
http://myhost.com/mapcache/wmts/1.0.0/....
</pre></div>
</div>
<p>Les « capabilities » sont obtenues via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://myhost.com/mapcache/wmts?service=wmts&amp;request=getcapabilities&amp;version=1.0.0
http://myhost.com/mapcache/wmts/1.0.0/WMTSCapabilities.xml
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference internal" href="featureinfo.html#mapcache-featureinfo"><span class="std std-ref">Requêtes FeatureInfo</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference internal" href="dimensions.html#mapcache-dimensions"><span class="std std-ref">Dimensions d’un jeu de tuiles</span></a></p>
</div>
</div>
<div class="section" id="ogc-wms-service">
<span id="mapcache-wms"></span><h2>Service WMS OGC<a class="headerlink" href="#ogc-wms-service" title="Lien permanent vers ce titre">¶</a></h2>
<p>MapCache répond aux requêtes WMS version 1.1.1, et a un support limité pour celles en version 1.3.0.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;wms&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notez que le service WMS est un petit peu différent des autres services MapCache, car il écoute à la racine de l’instance configurée plutôt que sur un emplacement dédié (en fait le service répond sur <a class="reference external" href="http://server/mapcache/">http://server/mapcache/</a>? et non sur <a class="reference external" href="http://server/mapcache/wms">http://server/mapcache/wms</a>?). Ce comportement est rendu nécessaire pour permettre la <a class="reference internal" href="proxying.html#mapcache-proxying"><span class="std std-ref">proxyfication des requêtes non prises en charge</span></a> tout en offrant un point d’entrée unique à tous les services OGC.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MapCache supporte principalement les requêtes WMS 1.1.1 mais a un support limité de la récente version 1.3.0. Pour les requêtes 1.3.0, MapCache choisira la <a class="reference internal" href="config.html#mapcache-grids"><span class="std std-ref">grille</span></a> à utiliser en lisant le paramètre CRS plutôt que SRS, et respectera l’ordre des axes de coordonnées pour les systèmes epsg qui inverse l’ordre x/y habituel du paramètre BBOX.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference internal" href="featureinfo.html#mapcache-featureinfo"><span class="std std-ref">Requêtes FeatureInfo</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference internal" href="dimensions.html#mapcache-dimensions"><span class="std std-ref">Dimensions d’un jeu de tuiles</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p><a class="reference internal" href="tile_assembling.html#mapcache-tile-assembling"><span class="std std-ref">Assemblage de tuiles</span></a></p>
</div>
<p>Les requêtes WMS suivent le style d’encodage classique clé-valeur (Key Value Pair):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://myhost.com/mapcache?SERVICE=WMS&amp;VERSION=1.1.1&amp;REQUEST=....
</pre></div>
</div>
<p>Le document de « capabilities » est retourné par:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://myhost.com/mapcache?service=wms&amp;request=getcapabilities
</pre></div>
</div>
<div class="section" id="optional-wms-configuration-options">
<h3>Optional WMS Configuration Options<a class="headerlink" href="#optional-wms-configuration-options" title="Lien permanent vers ce titre">¶</a></h3>
<div class="section" id="untiled-getmap-support">
<h4>Untiled GetMap Support<a class="headerlink" href="#untiled-getmap-support" title="Lien permanent vers ce titre">¶</a></h4>
<p>Support for untiled (non WMS-C) GetMap requests can be enabled or disabled:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;wms&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
   <span class="c">&lt;!-- full_wms</span>
<span class="c">        Configure response to WMS requests that are not aligned to a tileset&#39;s grids.</span>
<span class="c">        Responding to requests that are not in the SRS of a configured grid is not supported, but</span>
<span class="c">        this should never happen as only the supported SRSs are publicized in the capabilities</span>
<span class="c">        document.</span>

<span class="c">        Allowed values are:</span>
<span class="c">          - error: return a 404 error (default)</span>
<span class="c">          - assemble: build the full image by assembling the tiles from the cache</span>
<span class="c">          - forward: forward the request to the configured source.</span>
<span class="c">   --&gt;</span>
   <span class="nt">&lt;full_wms&gt;</span>assemble<span class="nt">&lt;/full_wms&gt;</span>
<span class="nt">&lt;/service&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="getmap-image-format">
<span id="mapcache-getmap-format"></span><h4>GetMap Image Format<a class="headerlink" href="#getmap-image-format" title="Lien permanent vers ce titre">¶</a></h4>
<p>You may explicitly set which image format should be returned to the client for
an untiled WMS request (i.e. whenever the tile data cannot be served directly
from the caches but needs to go through a decompression/recompression phase).</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;wms&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;format</span> <span class="na">allow_client_override=</span><span class="s">&quot;true/false&quot;</span><span class="nt">&gt;</span>myjpegformat<span class="nt">&lt;/format&gt;</span>
<span class="nt">&lt;/service&gt;</span>
</pre></div>
</div>
<p>If the <cite>allow_client_override</cite> attribute is set to true, then MapCache will honor
the <cite>FORMAT=…</cite> parameter sent by the client. By default MapCache ignores this
parameter and uses its configured image format.</p>
</div>
<div class="section" id="image-resampling-quality">
<h4>Image Resampling Quality<a class="headerlink" href="#image-resampling-quality" title="Lien permanent vers ce titre">¶</a></h4>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;wms&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
   <span class="c">&lt;!-- resample mode</span>
<span class="c">   Filter applied when resampling tiles for full WMS requests.</span>
<span class="c">   Can be either:</span>
<span class="c">   - nearest : fastest, poor quality</span>
<span class="c">   - bilinear: slower, higher qulity</span>
<span class="c">   --&gt;</span>
   <span class="nt">&lt;resample_mode&gt;</span>bilinear<span class="nt">&lt;/resample_mode&gt;</span>
<span class="nt">&lt;/service&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="googlemaps-xyz-service">
<span id="mapcache-gmaps"></span><h2>Service XYZ GoogleMaps<a class="headerlink" href="#googlemaps-xyz-service" title="Lien permanent vers ce titre">¶</a></h2>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;service</span> <span class="na">type=</span><span class="s">&quot;gmaps&quot;</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Prérequis: votre WMS doit être capable de produire des images dans le SRS EPSG:900913 ou EPSG:3857 SRS, c’est à dire qu’il devrait référencer la grille « g » ou « GoogleMapsCompatible »</p>
<p>Voici la page HTML minimale qui devrait vous permettre d’avancer. Les parties importantes sont dans les variables urlTemplate (pour v2) et getTileURL (pour v3).</p>
<ul class="simple">
<li><p>/mapcache est le chemin apache où MapCache gère les requêtes</p></li>
<li><p>test&#64;g est le jeu de tuiles et la grille à utiliser, joints par un “&#64;” - le  {Z}/{X}/{Y}  devrait être laissé de côté</p></li>
<li><p>l’extension finale devrait être changée en « jpg » si vous utilisez le format JPEG pour votre jeu de tuiles.</p></li>
</ul>
<div class="section" id="v2-api">
<h3>API V2<a class="headerlink" href="#v2-api" title="Lien permanent vers ce titre">¶</a></h3>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html</span>
<span class="cp">  PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
<span class="cp">  &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;content-type&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span><span class="p">/&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Google/MapServer Tile Example<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAnfs7bKE82qgb3Zc2YyS-oBT2yXp_ZAY8_ufC3CFXhHIE1NvwkxSySz_REpPq-4WZA27OwgbtyR3VcA&quot;</span>
        <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>

<span class="kd">function</span> <span class="nx">load</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">GBrowserIsCompatible</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">urlTemplate</span> <span class="o">=</span> <span class="s1">&#39;/mapcache/gmaps/test@g/{Z}/{X}/{Y}.png&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">myLayer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GTileLayer</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">18</span><span class="p">,{</span>
                                 <span class="nx">tileUrlTemplate</span><span class="o">:</span><span class="nx">urlTemplate</span><span class="p">,</span>
                                 <span class="nx">isPng</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span>
                                 <span class="nx">opacity</span><span class="o">:</span><span class="mf">0.8</span> <span class="p">});</span>
    <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GMap2</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;map&quot;</span><span class="p">));</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="k">new</span> <span class="nx">GLargeMapControl</span><span class="p">());</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="k">new</span> <span class="nx">GMapTypeControl</span><span class="p">());</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">setCenter</span><span class="p">(</span><span class="k">new</span> <span class="nx">GLatLng</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">addOverlay</span><span class="p">(</span><span class="k">new</span> <span class="nx">GTileLayerOverlay</span><span class="p">(</span><span class="nx">myLayer</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span> <span class="na">onload</span><span class="o">=</span><span class="s">&quot;load()&quot;</span> <span class="na">onunload</span><span class="o">=</span><span class="s">&quot;GUnload()&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 500px; height: 500px&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="v3-api">
<h3>API V3<a class="headerlink" href="#v3-api" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le JavaScript pour l’exemple précédent en V2 devrait être légèrement modifié ainsi:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Map</span><span class="p">(</span><span class="s2">&quot;&lt;element-id&gt;&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="cm">/*options*/</span> <span class="p">});</span>
<span class="kd">var</span> <span class="nx">layerOptions</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">getTileUrl</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">coord</span><span class="p">,</span> <span class="nx">zoom</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;/mapcache/gmaps/test@g/&quot;</span> <span class="o">+</span> <span class="nx">zoom</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">coord</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">coord</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">;</span>
  <span class="p">},</span>
  <span class="nx">tileSize</span><span class="o">:</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Size</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span> <span class="c1">// or whatever</span>
<span class="p">};</span>
<span class="nx">map</span><span class="p">.</span><span class="nx">overlayMapTypes</span><span class="p">.</span><span class="nx">insertAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">ImageMapType</span><span class="p">(</span><span class="nx">layerOptions</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="virtual-earth-tile-service">
<span id="mapcache-ve"></span><h2>Service de tuilage Virtual Earth<a class="headerlink" href="#virtual-earth-tile-service" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les tuiles sont organisées en un ou deux modèles différents selon qu’elles utilisent un projet Mercator Sphérique, comme EPSG:3857 ou EPSG:900913, or si elles utilisent une projection géographiques comme EPSG:4326.</p>
<p>Les tuiles sont demandées en utilisant le schéma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://myhost.com/mapcache/ve?LAYER=&lt;tileset_name&gt;@&lt;grid_name&gt;&amp;tile=&lt;quadkey&gt;
</pre></div>
</div>
<p>Pour les grilles EPSG:3857 ou EPSG:900913 ou GoogleMapsCompatible, &lt;quadkey&gt;  sont arrangés ainsi:</p>
<p>z0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[0]

http://myhost.com/mapcache/ve?LAYER=osm@GoogleMapsCompatible&amp;tile=0
</pre></div>
</div>
<p>z1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[00][01]
[02][03]

http://myhost.com/mapcache/ve?LAYER=osm@GoogleMapsCompatible&amp;tile=00
http://myhost.com/mapcache/ve?LAYER=osm@GoogleMapsCompatible&amp;tile=01
http://myhost.com/mapcache/ve?LAYER=osm@GoogleMapsCompatible&amp;tile=02
http://myhost.com/mapcache/ve?LAYER=osm@GoogleMapsCompatible&amp;tile=03
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">etc</span><span class="o">.</span>
</pre></div>
</div>
<p>Pour les grilles EPSG:4326 ou WGS84, &lt;quadkey&gt; sont arrangés ainsi:</p>
<p>z1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[0][1]

http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=0
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=1
</pre></div>
</div>
<p>z2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[00][01][10][11]
[02][03][12][13]

http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=00
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=01
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=02
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=03
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=10
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=11
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=12
http://myhost.com/mapcache/ve?LAYER=osm@WGS84&amp;tile=13
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">etc</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">Services de tuilage supportés</a><ul>
<li><a class="reference internal" href="#tms-service">Service TMS</a></li>
<li><a class="reference internal" href="#kml-service">Service KML</a></li>
<li><a class="reference internal" href="#ogc-wmts-service">Service WMTS OGC</a></li>
<li><a class="reference internal" href="#ogc-wms-service">Service WMS OGC</a><ul>
<li><a class="reference internal" href="#optional-wms-configuration-options">Optional WMS Configuration Options</a><ul>
<li><a class="reference internal" href="#untiled-getmap-support">Untiled GetMap Support</a></li>
<li><a class="reference internal" href="#getmap-image-format">GetMap Image Format</a></li>
<li><a class="reference internal" href="#image-resampling-quality">Image Resampling Quality</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#googlemaps-xyz-service">Service XYZ GoogleMaps</a><ul>
<li><a class="reference internal" href="#v2-api">API V2</a></li>
<li><a class="reference internal" href="#v3-api">API V3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#virtual-earth-tile-service">Service de tuilage Virtual Earth</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="seed.html" title="Alimentation du cache"
             >suivant</a> |</li>
        <li class="right" >
          <a href="config.html" title="Fichier de configuration"
             >précédent</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.2.2 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >MapCache 1.6.1</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2019, Open Source Geospatial Foundation.
      Mis à jour le 2019-04-09.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.0.
    </div>
  </body>
</html>