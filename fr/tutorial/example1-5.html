<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Exemple 1.5 &#8212; MapServer 7.0.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '7.0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="MapServer 7.0.5 documentation" href="../index.html" /> 
  </head>
  <body role="document">

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../tutorial/example1-5.html"><img src="../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../ar/tutorial/example1-5.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../de/tutorial/example1-5.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../el/tutorial/example1-5.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        
          
            <a href="../../es/tutorial/example1-5.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
          
        
        <img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" width="18px" height="13px"/>
        
          
            <a href="../../id/tutorial/example1-5.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../it/tutorial/example1-5.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        
          
            <a href="../../ja/tutorial/example1-5.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
          
        
        
          
            <a href="../../nl_NL/tutorial/example1-5.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
          
        
        
          
            <a href="../../pl/tutorial/example1-5.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../ru/tutorial/example1-5.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../sq/tutorial/example1-5.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../tr/tutorial/example1-5.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="example-1-5">
<span id="example1-5"></span><h1>Exemple 1.5<a class="headerlink" href="#example-1-5" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="adding-a-raster-layer">
<h2>Ajouter une couche raster<a class="headerlink" href="#adding-a-raster-layer" title="Lien permanent vers ce titre">¶</a></h2>
<img alt="http://demo.mapserver.org/cgi-bin/mapserv?map=/osgeo/mapserver/tutorial/htdocs/example1-5.map&amp;layer=states&amp;layer=states_line&amp;layer=states_label&amp;layer=modis&amp;mode=map" src="http://demo.mapserver.org/cgi-bin/mapserv?map=/osgeo/mapserver/tutorial/htdocs/example1-5.map&amp;layer=states&amp;layer=states_line&amp;layer=states_label&amp;layer=modis&amp;mode=map" />
<p>En plus du support des données vecteur (point, lignes, polygones et annotations), MapServer peut aussi afficher des données raster. Via l&#8217;utilisation de la bibliothèque GDAL, Mapserver peut lire en entrée et générer en sortie de multiple formats raster. Tandis que les versions antérieures à 4.x où l&#8217;entrée raster est limitée à une seule couche, avec des images en niveaux de gris ou en couleurs indexées, les versions récentes de MapServer supportent les images RGB et multispectres (multi-couche). Cet exemple lontre comment sélectionner quel couleur afficher quand on on utilise des données multispectres.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Il est possible de voir une amélioration notable des performances quand on utilise les images RGB et multispectres.</p>
</div>
<p>Parce que MapServer 5.x utilise la version 2.0.x de la bibliothèque GD pour générer les images en sortie, il supporte la sortie RGB (24-bit ou dite &#8220;true color&#8221;) également. Ainsi, avec le PNG 8-bit (couleurs indexées ou niveaux de gris), vous pouvez aussi utiliser le PNG (true color) en sortie. Cet exemple utilise le PNG comme IMAGETYPE.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Comme avec l&#8217;entrée RGB, il est possible d&#8217;avoir une amélioration des performance très perceptible avec l&#8217;usage du PNG par rapport au PNG8.</p>
</div>
<p>MapServer peut actuellement utiliser GDAL pour générer les image de sortie également, mais c&#8217;est un autre sujet. Si vous voulez en savoir plus à ce propos, regardez l&#8217;objet <a class="reference internal" href="../mapfile/outputformat.html#outputformat"><span class="std std-ref">OUTPUTFORMAT</span></a> dans la référence du mapfile.</p>
<div class="section" id="mapfile-structure">
<h3>Structure d&#8217;un MapFile<a class="headerlink" href="#mapfile-structure" title="Lien permanent vers ce titre">¶</a></h3>
<p>C&#8217;est ce à quoi le mapfile ressemble: <a class="reference internal" href="example1-5-map.html#example1-5-map"><span class="std std-ref">Example1-5.map</span></a>.</p>
<p>La structure d&#8217;un mapfile, par objets, ressemble à ceci:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>                                             <span class="n">MAP</span>
             <span class="n">LAYER</span> <span class="c1">#1-------------LAYER #2----|----LAYER #3--------LAYER #4</span>
          <span class="p">(</span><span class="n">states_poly</span><span class="p">)</span>           <span class="p">(</span><span class="n">modis</span><span class="p">)</span>       <span class="p">(</span><span class="n">states_line</span><span class="p">)</span>   <span class="p">(</span><span class="n">states_label</span><span class="p">)</span>
             <span class="o">|</span>                                     <span class="o">|</span>               <span class="o">|</span>
<span class="p">(</span><span class="n">land</span><span class="p">)</span> <span class="n">CLASS</span><span class="o">-|-</span><span class="n">CLASS</span> <span class="p">(</span><span class="n">water</span><span class="p">)</span>                       <span class="o">|-</span><span class="n">CLASS</span>         <span class="o">|-</span><span class="n">CLASS</span>
          <span class="o">|</span>     <span class="o">|</span>                                     <span class="o">|</span>               <span class="o">|</span>
    <span class="n">STYLE</span><span class="o">-|</span>     <span class="o">|-</span><span class="n">STYLE</span>                               <span class="o">|-</span><span class="n">STYLE</span>   <span class="n">STYLE</span><span class="o">-|-</span><span class="n">LABEL</span>
</pre></div>
</div>
<p>Quand vous regardez le mapfile, vous verrez que le nouvel objet LAYER est ajouté en dessous (après) la couche POLYGON state. Pourquoi? MapServer génère les couches dans l&#8217;ordre inversé: &#8220;dernier arrivé, premier sorti&#8221; (LIFO). La première couche définie dans le mapfile est dessinée en dessous dans la carte.</p>
<p>Ainsi, si nous avions dessiné la couche POLYGON state, elle serait en bas. Comme la couche raster est dessinée par dessus, nous ne la verrons pas. C&#8217;est pourquoi la première couche a la valeur de STATUS à OFF. La couche LINE state est définie en dessous de la couche raster ainsi elle est dessinée par dessus (et vous pouvez la voir). C&#8217;est pourquoi nous avons séparé la couche LINE state de la couche POLYGON state. Bien sûr les étiquettes sont dessinées par dessus tout le reste.</p>
<p>MapServer peut automatiquement activer ou désactiver les couches en fonction du statut d&#8217;autres couches (disons que nous voulons la couche polygon states désactivée quand la couche raster est activée). Cela est fait en utilisant le paramètre REQUIRES. Garder cela en tête au cas où vous voudriez l&#8217;utiliser une fois que vous aurez commencé à créer vos propres applications MapServer.</p>
</div>
<div class="section" id="parameters">
<h3>Paramètres<a class="headerlink" href="#parameters" title="Lien permanent vers ce titre">¶</a></h3>
<p>Regardons les nouveaux paramètres introduits dans le mapfile:</p>
<dl class="docutils">
<dt><strong>IMAGETYPE</strong></dt>
<dd><p class="first last">PNG est la version 24 bits ou dite &#8220;couleurs vraies&#8221; du format PNG.  A propos, essayez de changer votre valeur à PNG8.  Notez le temps que cela prend pour générer l&#8217;image en utilisant les différents formats. En choisissant entre &#8220;couleurs vraies&#8221;between et couleurs indexées, prenez</p>
</dd>
<dt><strong>SYMBOLSET</strong></dt>
<dd><p class="first last">Pointe vers le chemin du fichier de définition des symboles. Les symboles dans ce fichier sont référencés par le paramètre SYMBOL dans l&#8217;objet <a class="reference internal" href="../mapfile/class.html#class"><span class="std std-ref">CLASS</span></a>. Il n&#8217;est pas vraiment nécessaire pour le moment mais il était bien de le présenter ici maintenant. Merci de vous référer à <a class="reference internal" href="../mapfile/symbology/construction.html#sym-construction"><span class="std std-ref">la référence des symboles cartographiques</span></a> pour plus d&#8217;informations.</p>
</dd>
<dt><strong>DATA raster/mod09a12003161_ugl_ll_8bit.tif</strong></dt>
<dd><p class="first last">Dans le nouvel objet LAYER, le paramètre DATA pointe vers une image GeoTIFF. Comme pour les jeux de données vecteur, MapServer supporte de multiples formats de fichier. Ce support est fourni par l&#8217;intermédiaire de la bibliothèque GDAL. Pour plus d&#8217;informations sur les différents formats de fichiers raster supportés par MapServer et pour une discussion générale sur l&#8217;utilisation des rasters dans MapServer, merci de lire <a class="reference internal" href="../input/raster.html#raster"><span class="std std-ref">la référence des données raster</span></a>.</p>
</dd>
<dt><strong>TYPE RASTER</strong></dt>
<dd><p class="first last">Quand des données raster (images) sont utilisées, nous utilisons la valeur RASTER pour le paramètre TYPE, qui est opposé aux valeurs POLYGON, LINE, et POINT pour les données vecteur et ANNOTATION pour les identifiants des étiquettes.</p>
</dd>
<dt><strong>PROCESSING &#8220;BANDS=1,2,3&#8221;</strong></dt>
<dd><p class="first last">Ce paramètre de l&#8217;objet LAYER a été ajouté dans MapServer 4.x. Le mot-clé <a class="reference internal" href="../mapfile/layer.html#layer"><span class="std std-ref">PROCESSING</span></a> a de nombreuses valeurs mais dans ce cas, nous l&#8217;utilisons pour sélectionner quelles bandes afficher dans une image multispectres. Les valeurs ici sont des chaînes de caractères qui seront passées à la bibliothèque GDAL.</p>
</dd>
<dt><strong>OFFSITE</strong></dt>
<dd><p class="first last">Ce paramètre dit à MapServer quelles valeurs de pixel il faut afficher comme fond (ou ignorer). Vous pouvez obtenir les valeurs de pixel en utilisant des programmes de traitement ou de manipulation d&#8217;images (comme Imagine, Photoshop ou Gimp).</p>
</dd>
</dl>
</div>
<div class="section" id="rgb-vs-indexed-color-image">
<h3>RGB vs Image à couleurs indexées<a class="headerlink" href="#rgb-vs-indexed-color-image" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour comparer la vitesse de création d&#8217;une carte quand on utilise une image RGB par opposition à une image à couleurs indexées, remplacez les lignes suivantes dans le mapfile:</p>
<div class="highlight-mapfile"><div class="highlight"><pre><span></span><span class="k">DATA</span> <span class="s">&quot;raster/mod09a12003161_ugl_ll_8bit.tif&quot;</span>
<span class="k">STATUS</span> <span class="nb">DEFAULT</span>
<span class="k">TYPE</span> <span class="nb">RASTER</span>
<span class="k">PROCESSING</span> <span class="s">&quot;BANDS=1,2,3&quot;</span>
<span class="k">OFFSITE</span> <span class="mi">71</span> <span class="mi">74</span> <span class="mi">65</span>
</pre></div>
</div>
<p>avec ceci:</p>
<div class="highlight-mapfile"><div class="highlight"><pre><span></span><span class="k">DATA</span> <span class="s">&quot;raster/mod09a12003161_ugl_ll_idxa.tif&quot;</span>
<span class="k">STATUS</span> <span class="nb">DEFAULT</span>
<span class="k">TYPE</span> <span class="nb">RASTER</span>
<span class="k">OFFSITE</span> <span class="mi">70</span> <span class="mi">74</span> <span class="mi">66</span>
</pre></div>
</div>
<p>Essayer aussi de changer l&#8217;IMAGETYPE de PNG à PNG8.</p>
<hr class="docutils" />
<p><a class="reference internal" href="example1-4.html#example1-4"><span class="std std-ref">Revenir à l&#8217;exemple 1.4</span></a> | <a class="reference internal" href="example1-6.html#example1-6"><span class="std std-ref">Aller à l&#8217;exemple 1.6</span></a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a>
</p>
  <h3>Current Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Exemple 1.5</a><ul>
<li><a class="reference internal" href="#adding-a-raster-layer">Ajouter une couche raster</a><ul>
<li><a class="reference internal" href="#mapfile-structure">Structure d&#8217;un MapFile</a></li>
<li><a class="reference internal" href="#parameters">Paramètres</a></li>
<li><a class="reference internal" href="#rgb-vs-indexed-color-image">RGB vs Image à couleurs indexées</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2017, Open Source Geospatial Foundation.
      Mis à jour le 2017-05-10.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>