
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PostGIS/PostgreSQL &#8212; MapServer 7.6.1 documentation</title>
    <link rel="stylesheet" href="../../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/translations.js"></script>
    
    <link rel="shortcut icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="À propos de ces documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="SDTS" href="sdts.html" />
    <link rel="prev" title="Oracle Spatial" href="oracle.html" /> 
  </head><body>

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../../input/vector/postgis.html"><img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../../ar/input/vector/postgis.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../../de/input/vector/postgis.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../../el/input/vector/postgis.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        
          
            <a href="../../../es/input/vector/postgis.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
          
        
        <img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" width="18px" height="13px"/>
        
          
            <a href="../../../id/input/vector/postgis.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../../it/input/vector/postgis.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        
          
            <a href="../../../ja/input/vector/postgis.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
          
        
        
          
            <a href="../../../nl_NL/input/vector/postgis.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
          
        
        
          
            <a href="../../../pl/input/vector/postgis.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../../ru/input/vector/postgis.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../../sq/input/vector/postgis.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../../tr/input/vector/postgis.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="sdts.html" title="SDTS"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="oracle.html" title="Oracle Spatial"
             accesskey="P">précédent</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../documentation.html" >MapServer 7.6.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Data Input</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Vector Data</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">PostGIS/PostgreSQL</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="postgis-postgresql">
<span id="input-postgis"></span><h1><a class="toc-backref" href="#table-of-contents">PostGIS/PostgreSQL</a><a class="headerlink" href="#postgis-postgresql" title="Lien permanent vers ce titre">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Last Updated</dt>
<dd class="field-odd"><p>2019-11-21</p>
</dd>
</dl>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#postgis-postgresql" id="id2">PostGIS/PostgreSQL</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id3">PostGIS/PostgreSQL</a></p></li>
<li><p><a class="reference internal" href="#data-access-connection-method" id="id4">Data Access /Connection Method</a></p></li>
<li><p><a class="reference internal" href="#ogrinfo-examples" id="id5">OGRINFO Examples</a></p></li>
<li><p><a class="reference internal" href="#mapfile-example" id="id6">Mapfile Example</a></p></li>
<li><p><a class="reference internal" href="#support-for-2-5d-geometries" id="id7">Support for 2.5D geometries</a></p></li>
<li><p><a class="reference internal" href="#support-for-sql-mm-curves" id="id8">Support for SQL/MM Curves</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-circularstring-in-mapserver" id="id9">Example#1: CircularString in MapServer</a></p></li>
<li><p><a class="reference internal" href="#example-2-compoundcurve-in-mapserver" id="id10">Example#2: CompoundCurve in MapServer</a></p></li>
<li><p><a class="reference internal" href="#example-3-curvepolygon-in-mapserver" id="id11">Example#3: CurvePolygon in MapServer</a></p></li>
<li><p><a class="reference internal" href="#example-4-multicurve-in-mapserver" id="id12">Example#4: MultiCurve in MapServer</a></p></li>
<li><p><a class="reference internal" href="#example-5-multisurface-in-mapserver" id="id13">Example#5: MultiSurface in MapServer</a></p></li>
<li><p><a class="reference internal" href="#using-mapserver-6-0" id="id14">Using MapServer &lt; 6.0</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#table-of-contents">PostGIS/PostgreSQL</a><a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h2>
<p><a class="reference external" href="http://postgis.net/">PostGIS</a> spatially enables the
Open Source <a class="reference external" href="http://www.postgresql.org/">PostgreSQL</a> database.</p>
<p>The <a class="reference external" href="https://github.com/MapServer/MapServer/wiki/PostGIS">PostGIS wiki page</a>
may include additional information.</p>
</div>
<div class="section" id="data-access-connection-method">
<h2><a class="toc-backref" href="#table-of-contents">Data Access /Connection Method</a><a class="headerlink" href="#data-access-connection-method" title="Lien permanent vers ce titre">¶</a></h2>
<p>PostGIS is supported directly by MapServer and must be compiled into
MapServer to work.</p>
<p>The PostgreSQL client libraries (libpq.so or libpq.dll) must be
present in the system’s path environment for functionality to be
present.</p>
<p>The CONNECTIONTYPE parameter must be set to POSTGIS.</p>
<p>The CONNECTION parameter is used to specify the parameters to connect
to the database.  CONNECTION parameters can be in any order.  Most are
optional.  dbname is required.  user is required.  host defaults to
localhost, port defaults to 5432 (the standard port for PostgreSQL).</p>
<p>The DATA parameter is used to specify the data used to draw the map.
The form of DATA is « [geometry_column] from [table_name|sql_subquery]
using unique [unique_key] using srid=[spatial_reference_id] ».  The
« using unique » and « using srid= » clauses are optional when drawing
features, but using them improves performance. If you want to make
MapServer query calls to a PostGIS layer, your DATA parameter must
include « using unique ». Omitting it will cause the query to fail.</p>
<p>Here is a simple generic example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONNECTIONTYPE</span> <span class="n">POSTGIS</span>
<span class="n">CONNECTION</span> <span class="s2">&quot;host=yourhostname dbname=yourdatabasename user=yourdbusername</span>
            <span class="n">password</span><span class="o">=</span><span class="n">yourdbpassword</span> <span class="n">port</span><span class="o">=</span><span class="n">yourpgport</span><span class="s2">&quot;</span>
<span class="n">DATA</span> <span class="s2">&quot;geometrycolumn from yourtablename&quot;</span>
</pre></div>
</div>
<p>This example shows specifying the unique key and srid in the DATA line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONNECTIONTYPE</span> <span class="n">POSTGIS</span>
<span class="n">CONNECTION</span> <span class="s2">&quot;dbname=yourdatabasename user=yourdbusername&quot;</span>
<span class="n">DATA</span> <span class="s2">&quot;the_geom from the_database using unique gid using srid=4326&quot;</span>
</pre></div>
</div>
<p>This example shows using a SQL subquery to perform a join inside the
database and map the result in MapServer. Note the « as subquery »
string in the statement – everything between « from » and « using » is
sent to the database for evaluation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONNECTIONTYPE</span> <span class="n">POSTGIS</span>
<span class="n">CONNECTION</span> <span class="s2">&quot;dbname=yourdatabasename user=yourdbusername&quot;</span>
<span class="n">DATA</span> <span class="s2">&quot;the_geom from (select g.gid, g.the_geom, a.attr1, a.attr2 from</span>
      <span class="n">geotable</span> <span class="n">g</span> <span class="n">join</span> <span class="n">attrtable</span> <span class="n">a</span> <span class="n">on</span> <span class="n">g</span><span class="o">.</span><span class="n">gid</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">aid</span><span class="p">)</span> <span class="k">as</span> <span class="n">subquery</span>
      <span class="n">using</span> <span class="n">unique</span> <span class="n">gid</span> <span class="n">using</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4326</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>This example shows using a geometry function and database sort to
limit the number of features and vertices returned to MapServer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONNECTIONTYPE</span> <span class="n">POSTGIS</span>
<span class="n">CONNECTION</span> <span class="s2">&quot;dbname=yourdatabasename user=yourdbusername&quot;</span>
<span class="n">DATA</span> <span class="s2">&quot;the_geom from (select g.gid, ST_Simplify(g.the_geom, 10.0) as</span>
      <span class="n">the_geom</span> <span class="kn">from</span> <span class="nn">geotable</span> <span class="n">g</span> <span class="n">order</span> <span class="n">by</span> <span class="n">ST_Area</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">the_geom</span><span class="p">)</span> <span class="n">desc</span>
      <span class="n">limit</span> <span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">subquery</span> <span class="n">using</span> <span class="n">unique</span> <span class="n">gid</span> <span class="n">using</span> <span class="n">srid</span><span class="o">=</span><span class="mi">4326</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>This example shows the use of the !BOX! substitution string to
over-ride the default inclusion of the map bounding box in the SQL. By
default the spatial box clause is appended to the SQL in the DATA
clause, but you can use !BOX! to insert it anywhere you like in the
statement. In general, you won’t need to use !BOX!, because the
PostgreSQL planner will generate the optimal plan from the generated
SQL, but in some cases (complex sub-queries) a better plan can be
generated by placing the !BOX! closer to the middle of the query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CONNECTIONTYPE POSTGIS
CONNECTION &quot;dbname=yourdatabasename user=yourdbusername&quot;
DATA &quot;the_geom from (select g.gid, ST_Union(g.the_geom, 10.0) as
      the_geom from geotable g where ST_Intersects(g.geom,!BOX!)) as
      subquery using unique gid using srid=4326&quot;
</pre></div>
</div>
</div>
<div class="section" id="ogrinfo-examples">
<h2><a class="toc-backref" href="#table-of-contents">OGRINFO Examples</a><a class="headerlink" href="#ogrinfo-examples" title="Lien permanent vers ce titre">¶</a></h2>
<p>OGRINFO can be used to read out metadata about PostGIS tables directly
from the database.</p>
<p>First you should make sure that your GDAL/OGR build contains the
PostgreSQL driver, by using the “–formats” command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">ogrinfo</span> <span class="o">--</span><span class="n">formats</span>
  <span class="n">Loaded</span> <span class="n">OGR</span> <span class="n">Format</span> <span class="n">Drivers</span><span class="p">:</span>
  <span class="o">...</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;PGeo&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;PostgreSQL&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;MySQL&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>If you don’t have the driver, you might want to try the <a class="reference external" href="http://fwtools.maptools.org">FWTools</a> or
<a class="reference external" href="http://www.ms4w.com">MS4W</a> packages, which include the driver.</p>
<p>Once you have the driver you are ready to try an ogrinfo command on
your database to get a list of spatial tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;ogrinfo PG:&quot;host=127.0.0.1 user=postgres password=postgres dbname=canada port=5432&quot;
      using driver `PostgreSQL&#39; successful.
      1: province (Multi Polygon)
</pre></div>
</div>
<p>Now use ogrinfo to get information on the structure of the spatial table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;ogrinfo PG:&quot;host=127.0.0.1 user=postgres password=postgres dbname=canada port=5432&quot;
             province -summary
 INFO: Open of `PG:host=127.0.0.1 user=postgres password=postgres dbname=canada&#39;
    using driver `PostgreSQL&#39; successful.

  Layer name: province
  Geometry: Multi Polygon
  Feature Count: 1068
  Extent: (-2340603.750000, -719746.062500) - (3009430.500000, 3836605.250000)
  Layer SRS WKT:
  (unknown)
  FID Column = gid
  Geometry Column = the_geom
  area: Real (0.0)
  island: String (30.0)
  island_e: String (30.0)
  island_f: String (30.0)
  name: String (30.0)
  ...
</pre></div>
</div>
</div>
<div class="section" id="mapfile-example">
<h2><a class="toc-backref" href="#table-of-contents">Mapfile Example</a><a class="headerlink" href="#mapfile-example" title="Lien permanent vers ce titre">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;province&quot;</span>
  <span class="n">STATUS</span> <span class="n">ON</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">POSTGIS</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;host=127.0.0.1 port=5432 dbname=canada user=postgres password=postgres&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;the_geom from province&quot;</span>
  <span class="n">CLASS</span>
     <span class="o">...</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>For more info about PostGIS and MapServer see the PostGIS docs:
<a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a></p>
</div>
<div class="section" id="support-for-2-5d-geometries">
<h2><a class="toc-backref" href="#table-of-contents">Support for 2.5D geometries</a><a class="headerlink" href="#support-for-2-5d-geometries" title="Lien permanent vers ce titre">¶</a></h2>
<p>In addition to horizontal coordinates (X,Y or longitude,latitude), PostGIS can
support geometries with a vertical component, often called 2.5D geometries.</p>
<p>As of MapServer 7.0, such 2.5D geometries will be taken into account if MapServer
is built with -DWITH_POINT_Z_M=ON.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Output of 2.5D geometries in WFS requires explicit metadata item to be
specified at the layer level. See <a class="reference internal" href="../../ogc/wfs_server.html#wfs-server"><span class="std std-ref">WFS server</span></a> documentation.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is still possible to force 2D only geometries to be retrieved from PostGIS by
setting the following PROCESSING option</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">PROCESSING</span> <span class="s">&quot;FORCE2D=YES&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="support-for-sql-mm-curves">
<h2><a class="toc-backref" href="#table-of-contents">Support for SQL/MM Curves</a><a class="headerlink" href="#support-for-sql-mm-curves" title="Lien permanent vers ce titre">¶</a></h2>
<p>PostGIS is able to store circular interpolated curves, as part of the
SQL Multimedia Applications Spatial specification (read about the
<a class="reference external" href="http://subs.emis.de/LNI/Proceedings/Proceedings26/GI-Proceedings.26-17.pdf">SQL/MM specification</a>).</p>
<p>For more information about PostGIS” support, see the <em>SQL-MM Part 3</em>
section in the PostGIS documentation, such as <a class="reference external" href="http://www.postgis.net/docs/manual-1.5/ch04.html#SQL_MM_Part3">here</a>.</p>
<p>As of MapServer 6.0, the PostGIS features CircularString,
CompoundCurve, CurvePolygon, MultiCurve, and MultiSurface can be drawn
through MapServer directly.</p>
<div class="section" id="example-1-circularstring-in-mapserver">
<h3><a class="toc-backref" href="#table-of-contents">Example#1: CircularString in MapServer</a><a class="headerlink" href="#example-1-circularstring-in-mapserver" title="Lien permanent vers ce titre">¶</a></h3>
<p>The following is the Well Known Text of the feature loading into PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">test</span> <span class="p">(</span> <span class="n">g</span><span class="p">,</span> <span class="nb">id</span> <span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span> <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;CIRCULARSTRING(0 0,</span>
                                    <span class="mi">4</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span><span class="s1">&#39;, -1), 2);</span>
</pre></div>
</div>
<p>An example MapServer layer might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;curves_poly&quot;</span>
  <span class="n">STATUS</span> <span class="n">DEFAULT</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;user=postgres password=postgres dbname=curves host=localhost port=5432&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;g from test using SRID=-1 using unique id&quot;</span>
  <span class="n">CLASS</span>
    <span class="n">STYLE</span>
      <span class="n">COLOR</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>
      <span class="n">ANTIALIAS</span> <span class="n">true</span>
    <span class="n">END</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>And testing with <a class="reference internal" href="../../utilities/shp2img.html#shp2img"><span class="std std-ref">shp2img</span></a> should produce a map image of:</p>
<img alt="../../_images/circularstring.png" src="../../_images/circularstring.png" />
</div>
<div class="section" id="example-2-compoundcurve-in-mapserver">
<h3><a class="toc-backref" href="#table-of-contents">Example#2: CompoundCurve in MapServer</a><a class="headerlink" href="#example-2-compoundcurve-in-mapserver" title="Lien permanent vers ce titre">¶</a></h3>
<p>The following is the Well Known Text of the feature loading into PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">test</span> <span class="p">(</span> <span class="n">g</span><span class="p">,</span> <span class="nb">id</span> <span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span> <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;COMPOUNDCURVE(</span>
                  <span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">),(</span><span class="mi">1</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">))</span><span class="s1">&#39;, -1), 3);</span>
</pre></div>
</div>
<p>An example MapServer layer might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;curves_poly&quot;</span>
  <span class="n">STATUS</span> <span class="n">DEFAULT</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;user=postgres password=postgres dbname=curves host=localhost port=5432&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;g from test using SRID=-1 using unique id&quot;</span>
  <span class="n">CLASS</span>
    <span class="n">STYLE</span>
      <span class="n">COLOR</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>
      <span class="n">ANTIALIAS</span> <span class="n">true</span>
    <span class="n">END</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>And testing with <a class="reference internal" href="../../utilities/shp2img.html#shp2img"><span class="std std-ref">shp2img</span></a> should produce a map image of:</p>
<img alt="../../_images/compoundcurve.png" src="../../_images/compoundcurve.png" />
</div>
<div class="section" id="example-3-curvepolygon-in-mapserver">
<h3><a class="toc-backref" href="#table-of-contents">Example#3: CurvePolygon in MapServer</a><a class="headerlink" href="#example-3-curvepolygon-in-mapserver" title="Lien permanent vers ce titre">¶</a></h3>
<p>The following is the Well Known Text of the feature loading into PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">test</span> <span class="p">(</span> <span class="n">g</span><span class="p">,</span> <span class="nb">id</span> <span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span> <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;CURVEPOLYGON(</span>
                  <span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">),(</span><span class="mi">1</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">,</span>
                  <span class="mi">3</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span><span class="s1">&#39;, -1), 4);</span>
</pre></div>
</div>
<p>An example MapServer layer might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;curves_poly&quot;</span>
  <span class="n">STATUS</span> <span class="n">DEFAULT</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;user=postgres password=postgres dbname=curves host=localhost port=5432&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;g from test using SRID=-1 using unique id&quot;</span>
  <span class="n">CLASS</span>
    <span class="n">STYLE</span>
      <span class="n">COLOR</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>
      <span class="n">ANTIALIAS</span> <span class="n">true</span>
    <span class="n">END</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>And testing with <a class="reference internal" href="../../utilities/shp2img.html#shp2img"><span class="std std-ref">shp2img</span></a> should produce a map image of:</p>
<img alt="../../_images/curvepolygon.png" src="../../_images/curvepolygon.png" />
</div>
<div class="section" id="example-4-multicurve-in-mapserver">
<h3><a class="toc-backref" href="#table-of-contents">Example#4: MultiCurve in MapServer</a><a class="headerlink" href="#example-4-multicurve-in-mapserver" title="Lien permanent vers ce titre">¶</a></h3>
<p>The following is the Well Known Text of the feature loading into PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">test</span> <span class="p">(</span> <span class="n">g</span><span class="p">,</span> <span class="nb">id</span> <span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span> <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;MULTICURVE((0 0,</span>
                  <span class="mi">5</span> <span class="mi">5</span><span class="p">),</span><span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">4</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span> <span class="mi">4</span><span class="p">))</span><span class="s1">&#39;, -1), 6);</span>
</pre></div>
</div>
<p>An example MapServer layer might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;curves_poly&quot;</span>
  <span class="n">STATUS</span> <span class="n">DEFAULT</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;user=postgres password=postgres dbname=curves host=localhost port=5432&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;g from test using SRID=-1 using unique id&quot;</span>
  <span class="n">CLASS</span>
    <span class="n">STYLE</span>
      <span class="n">COLOR</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>
      <span class="n">ANTIALIAS</span> <span class="n">true</span>
    <span class="n">END</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>And testing with <a class="reference internal" href="../../utilities/shp2img.html#shp2img"><span class="std std-ref">shp2img</span></a> should produce a map image of:</p>
<img alt="../../_images/multicurve.png" src="../../_images/multicurve.png" />
</div>
<div class="section" id="example-5-multisurface-in-mapserver">
<h3><a class="toc-backref" href="#table-of-contents">Example#5: MultiSurface in MapServer</a><a class="headerlink" href="#example-5-multisurface-in-mapserver" title="Lien permanent vers ce titre">¶</a></h3>
<p>The following is the Well Known Text of the feature loading into PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">test</span> <span class="p">(</span> <span class="n">g</span><span class="p">,</span> <span class="nb">id</span> <span class="p">)</span> <span class="n">VALUES</span> <span class="p">(</span> <span class="n">ST_GeomFromText</span><span class="p">(</span><span class="s1">&#39;MULTISURFACE(</span>
                  <span class="n">CURVEPOLYGON</span><span class="p">(</span><span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span> <span class="mi">4</span><span class="p">,</span>
                  <span class="mi">0</span> <span class="mi">0</span><span class="p">),(</span><span class="mi">1</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)),((</span><span class="mi">10</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span> <span class="mi">10</span><span class="p">,</span>
                  <span class="mi">10</span> <span class="mi">10</span><span class="p">),(</span><span class="mi">11</span> <span class="mi">11</span><span class="p">,</span> <span class="mf">11.5</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span> <span class="mf">11.5</span><span class="p">,</span> <span class="mi">11</span> <span class="mi">11</span><span class="p">)))</span><span class="s1">&#39;, -1), 7);</span>
</pre></div>
</div>
<p>An example MapServer layer might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;curves_poly&quot;</span>
  <span class="n">STATUS</span> <span class="n">DEFAULT</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;user=postgres password=postgres dbname=curves host=localhost port=5432&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;g from test using SRID=-1 using unique id&quot;</span>
  <span class="n">CLASS</span>
    <span class="n">STYLE</span>
      <span class="n">COLOR</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>
      <span class="n">ANTIALIAS</span> <span class="n">true</span>
    <span class="n">END</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
<p>And testing with <a class="reference internal" href="../../utilities/shp2img.html#shp2img"><span class="std std-ref">shp2img</span></a> should produce a map image of:</p>
<img alt="../../_images/multisurface.png" src="../../_images/multisurface.png" />
</div>
<div class="section" id="using-mapserver-6-0">
<h3><a class="toc-backref" href="#table-of-contents">Using MapServer &lt; 6.0</a><a class="headerlink" href="#using-mapserver-6-0" title="Lien permanent vers ce titre">¶</a></h3>
<p>If you cannot upgrade to MapServer 6.0, then you can use the PostGIS function <em>ST_CurveToLine()</em> in your
MapServer LAYER to draw the curves (note that this is much slower however):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LAYER</span>
  <span class="n">NAME</span> <span class="s2">&quot;curves_poly&quot;</span>
  <span class="n">STATUS</span> <span class="n">DEFAULT</span>
  <span class="n">TYPE</span> <span class="n">POLYGON</span>
  <span class="n">CONNECTIONTYPE</span> <span class="n">postgis</span>
  <span class="n">CONNECTION</span> <span class="s2">&quot;user=postgres password=postgres dbname=curves host=localhost port=5432&quot;</span>
  <span class="n">DATA</span> <span class="s2">&quot;wkb_geometry from (select c.id, ST_CurveToLine(c.g) as</span>
                           <span class="n">wkb_geometry</span> <span class="kn">from</span> <span class="nn">c</span><span class="p">)</span> <span class="k">as</span> <span class="n">subquery</span> <span class="n">using</span>
                           <span class="n">unique</span> <span class="nb">id</span> <span class="n">using</span> <span class="n">SRID</span><span class="o">=-</span><span class="mi">1</span><span class="s2">&quot;</span>
  <span class="n">CLASS</span>
    <span class="n">STYLE</span>
      <span class="n">COLOR</span> <span class="mi">128</span> <span class="mi">128</span> <span class="mi">128</span>
      <span class="n">ANTIALIAS</span> <span class="n">true</span>
    <span class="n">END</span>
  <span class="n">END</span>
<span class="n">END</span>
</pre></div>
</div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../../development/index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">PostGIS/PostgreSQL</a><ul>
<li><a class="reference internal" href="#id1">PostGIS/PostgreSQL</a></li>
<li><a class="reference internal" href="#data-access-connection-method">Data Access /Connection Method</a></li>
<li><a class="reference internal" href="#ogrinfo-examples">OGRINFO Examples</a></li>
<li><a class="reference internal" href="#mapfile-example">Mapfile Example</a></li>
<li><a class="reference internal" href="#support-for-2-5d-geometries">Support for 2.5D geometries</a></li>
<li><a class="reference internal" href="#support-for-sql-mm-curves">Support for SQL/MM Curves</a><ul>
<li><a class="reference internal" href="#example-1-circularstring-in-mapserver">Example#1: CircularString in MapServer</a></li>
<li><a class="reference internal" href="#example-2-compoundcurve-in-mapserver">Example#2: CompoundCurve in MapServer</a></li>
<li><a class="reference internal" href="#example-3-curvepolygon-in-mapserver">Example#3: CurvePolygon in MapServer</a></li>
<li><a class="reference internal" href="#example-4-multicurve-in-mapserver">Example#4: MultiCurve in MapServer</a></li>
<li><a class="reference internal" href="#example-5-multisurface-in-mapserver">Example#5: MultiSurface in MapServer</a></li>
<li><a class="reference internal" href="#using-mapserver-6-0">Using MapServer &lt; 6.0</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="sdts.html" title="SDTS"
             >suivant</a> |</li>
        <li class="right" >
          <a href="oracle.html" title="Oracle Spatial"
             >précédent</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../documentation.html" >MapServer 7.6.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Data Input</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Vector Data</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">PostGIS/PostgreSQL</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../../copyright.html">Copyright</a> 2020, Open Source Geospatial Foundation.
      Mis à jour le 2020-10-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>