<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tile Indexes &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Vector Data Management &amp; Optimization" href="vector.html" />
    <link rel="prev" title="Raster Management &amp; Optimization" href="raster.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../ar/optimization/tileindex.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../de/optimization/tileindex.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../el/optimization/tileindex.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../es/optimization/tileindex.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../fr/optimization/tileindex.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../id/optimization/tileindex.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../it/optimization/tileindex.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../ja/optimization/tileindex.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../nl_NL/optimization/tileindex.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../pl/optimization/tileindex.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../ru/optimization/tileindex.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../sq/optimization/tileindex.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../tr/optimization/tileindex.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="vector.html" title="Vector Data Management &amp; Optimization"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="raster.html" title="Raster Management &amp; Optimization"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Optimization</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tile Indexes</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tile-indexes">
<span id="tileindex"></span><span id="index-0"></span><h1><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Tile Indexes</a><a class="headerlink" href="#tile-indexes" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Jeff McKenna</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>jmckenna at gatewaygeomatics.com</p>
</dd>
<dt class="field-odd">Original Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>HostGIS</p>
</dd>
<dt class="field-even">Last Updated<span class="colon">:</span></dt>
<dd class="field-even"><p>2021-03-23</p>
</dd>
</dl>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#tile-indexes" id="id1">Tile Indexes</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#what-is-a-tileindex-and-how-do-i-make-one" id="id3">What is a tileindex and how do I make one?</a></p></li>
<li><p><a class="reference internal" href="#using-the-tileindex-in-your-mapfile" id="id4">Using the tileindex in your mapfile</a></p></li>
<li><p><a class="reference internal" href="#tileindexes-may-make-your-map-faster" id="id5">Tileindexes may make your map faster</a></p></li>
<li><p><a class="reference internal" href="#tileindexes-with-tiles-in-different-projections" id="id6">Tileindexes with tiles in different projections</a></p></li>
<li><p><a class="reference internal" href="#note-for-wcs-layers" id="id7">Note for WCS layers</a></p></li>
<li><p><a class="reference internal" href="#long-ogrtindex-example" id="id8">Long ogrtindex example</a></p></li>
<li><p><a class="reference internal" href="#long-gdaltindex-example" id="id9">Long gdaltindex example</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Tileindexes are MapServer’s method for doing on-the-fly mosaicing.</p>
</section>
<section id="what-is-a-tileindex-and-how-do-i-make-one">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">What is a tileindex and how do I make one?</a><a class="headerlink" href="#what-is-a-tileindex-and-how-do-i-make-one" title="Link to this heading">¶</a></h2>
<p>A tileindex is a dataset (usually a shapefile) that ties together several
datasets into a single layer. Therefore, you don’t need to create separate
layers for each piece of imagery or each county’s road data; make a tileindex
and let MapServer piece the mosaic together on the fly.</p>
<p>Making a tileindex is easy using <a class="reference external" href="https://gdal.org/programs/gdaltindex.html">gdaltindex</a>
for GDAL data sources (rasters) and <a class="reference external" href="https://gdal.org/programs/ogrtindex.html">ogrtindex</a>
for OGR data sources (vectors). You just run them, specifying
the index file to create and the list of data sources to add to the index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is also the <a class="reference internal" href="../utilities/tile4ms.html#tile4ms"><span class="std std-ref">tile4ms</span></a> utility, but it only handles shapefile
mosaic/indexing.</p>
</div>
<p id="index-1">For example, to make a mosaic of several GeoTIFFs, creating an index file
named <em>tileindex-tif.shp</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdaltindex</span> <span class="n">tileindex</span><span class="o">-</span><span class="n">tif</span><span class="o">.</span><span class="n">shp</span> <span class="n">folder</span><span class="o">/*.</span><span class="n">tif</span>
</pre></div>
</div>
<p id="index-2">And to make a mosaic of vectors, creating an index file
named <em>tileindex-tiger.shp</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrtindex</span> <span class="n">tileindex</span><span class="o">-</span><span class="n">tiger</span><span class="o">.</span><span class="n">shp</span> <span class="n">tiger</span><span class="o">/</span><span class="n">CA</span><span class="o">/*.</span><span class="n">shp</span> <span class="n">tiger</span><span class="o">/</span><span class="n">NV</span><span class="o">/*.</span><span class="n">shp</span>
</pre></div>
</div>
<p>If your data files are in different subfolders, you can use the <em>–optfile</em>
switch for <a class="reference external" href="https://gdal.org/programs/vector_common_options.html#cmdoption-optfile">vectors</a>
or <a class="reference external" href="https://gdal.org/programs/raster_common_options.html#raster-common-options-optfile">rasters</a>
to pass a file list to ogrtindex/gdaltindex, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#windows (create a file listing all .tif in subfolders)</span>
<span class="nb">dir</span> <span class="o">/</span><span class="n">s</span><span class="o">/</span><span class="n">b</span> <span class="o">*.</span><span class="n">tif</span> <span class="o">&gt;</span> <span class="n">tif_list</span><span class="o">.</span><span class="n">txt</span>
<span class="c1">#unix</span>
<span class="n">find</span> <span class="o">.</span> <span class="o">-</span><span class="n">name</span> <span class="s2">&quot;*.tif&quot;</span> <span class="o">&gt;</span> <span class="n">tif_list</span><span class="o">.</span><span class="n">txt</span>

<span class="c1">#call gdaltindex with the --optfile switch</span>
<span class="n">gdaltindex</span> <span class="n">gdaltindex</span><span class="o">-</span><span class="n">dirs</span><span class="o">.</span><span class="n">shp</span> <span class="o">--</span><span class="n">optfile</span> <span class="n">tif_list</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ogrtindex and gdaltindex <strong>add</strong> the specified files to the index.
Sometimes you’ll have to delete the index file to avoid creating duplicate
entries.</p>
</div>
</section>
<section id="using-the-tileindex-in-your-mapfile">
<span id="index-3"></span><h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Using the tileindex in your mapfile</a><a class="headerlink" href="#using-the-tileindex-in-your-mapfile" title="Link to this heading">¶</a></h2>
<p>Using a tileindex as a layer is best explained by an example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
    <span class="k">NAME</span> <span class="s">&quot;Roads&quot;</span>
    <span class="k">STATUS</span> <span class="nb">ON</span>
    <span class="k">TYPE</span> <span class="nb">LINE</span>
    <span class="k">TILEINDEX</span> <span class="s">&quot;tiger/index.shp&quot;</span>
    <span class="k">TILEITEM</span> <span class="s">&quot;LOCATION&quot;</span>
<span class="k">END</span>
</pre></div>
</div>
<p>There are two items of note here: <a class="reference internal" href="../mapfile/layer.html#tileindex-keyword"><span class="std std-ref">TILEINDEX</span></a> and
<a class="reference internal" href="../mapfile/layer.html#tileitem"><span class="std std-ref">TILEITEM</span></a>. TILEINDEX is simply
the path to the index file, and TILEITEM specifies the field in the shapefile
which contains the filenames referenced by the index. The TILEITEM will
usually be “LOCATION” unless you specified the <em>-tileindex</em> option when
running gdaltindex or ogrtindex.</p>
<p>Two important notes about the pathnames:</p>
<blockquote>
<div><ul class="simple">
<li><p>The path to TILEINDEX follows the same conventions as for any other data
source, e.g. using the SHAPEPATH or else being relative to the location of
the mapfile.</p></li>
<li><p>The filenames specified on the command line to gdaltindex or ogrtindex will
be used with the same conventions as well, following the SHAPEPATH or else
being relative to the mapfile’s location. You might find it useful to change
into the SHAPEPATH directory and then run ogrtindex/gdaltindex from there;
this ensures correct pathnames.</p></li>
</ul>
</div></blockquote>
</section>
<section id="tileindexes-may-make-your-map-faster">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Tileindexes may make your map faster</a><a class="headerlink" href="#tileindexes-may-make-your-map-faster" title="Link to this heading">¶</a></h2>
<p>A tileindex is often a performance boost for two reasons:</p>
<blockquote>
<div><ul class="simple">
<li><p>It’s more efficient than having several separate layers.</p></li>
<li><p>MapServer will examine the tileindex to determine which datasets fall into
the map’s view, and will open only those datasets. This can result in a
great savings for a large dataset, especially for use cases where most of
the time only a very small spatial region of the data is being used. (for
example, citywide maps with nationwide street imagery)</p></li>
</ul>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can also run <a class="reference internal" href="../utilities/shptree.html#shptree"><span class="std std-ref">shptree</span></a> on your tileindex file, so that MapServer
can locate the associated feature/record faster.</p>
</div>
<p>A tileindex will not help in the case where all/most of the data sources will
usually be opened anyway (e.g. street data by county, showing states or larger
regions). In that case, it may even result in a decrease in performance, since
it may be slower to open 100 files than to open one giant file.</p>
<p>The ideal case for a tileindex is when the most typically requested map areas
fall into very few tiles. For example, if you’re showing state and larger
regions, try fitting your data into state-sized blocks instead of county-sized
blocks; and if you’re showing cities and counties, go for county-sized blocks.</p>
<p>You’ll just have to experiment with it and see what works best for your use
cases.</p>
</section>
<section id="tileindexes-with-tiles-in-different-projections">
<span id="tileindex-mixed-srs"></span><h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Tileindexes with tiles in different projections</a><a class="headerlink" href="#tileindexes-with-tiles-in-different-projections" title="Link to this heading">¶</a></h2>
<p>Starting with MapServer 6.4 for raster layers, and MapServer 7.2 for vector
layers, a tileindex can contain rasters/layers in
different projections. Such tileindex can be generated with
<a class="reference external" href="https://gdal.org/programs/gdaltindex.html">gdaltindex</a> (GDAL
1.11 or later) and <a class="reference external" href="https://gdal.org/programs/ogrtindex.html">ogrtindex</a>
(GDAL 2.2 or later), with the -t_srs and -src_srs_name options. The -t_srs instructs
gdaltindex/ogrtindex to write the envelope of each tile into a common target
projection, so that the geometries written in the tile index are consistent.
This common projection must be the projection of the raster/vector layer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdaltindex</span> <span class="o">-</span><span class="n">t_srs</span> <span class="n">EPSG</span><span class="p">:</span><span class="mi">4326</span> <span class="o">-</span><span class="n">src_srs_name</span> <span class="n">src_srs</span> <span class="n">imagery</span><span class="o">.</span><span class="n">shp</span> <span class="n">imagery</span><span class="o">/*.</span><span class="n">tif</span>
</pre></div>
</div>
<p>The corresponding LAYER definition will need to specify the
<a class="reference internal" href="../mapfile/layer.html#tilesrs"><span class="std std-ref">TILESRS</span></a> keyword with the value of the -src_srs_name option.</p>
<p>e.g:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
    <span class="k">NAME</span> <span class="s">&quot;My Imagery&quot;</span>
    <span class="k">STATUS</span> <span class="nb">ON</span>
    <span class="k">TYPE</span> <span class="nb">RASTER</span>
    <span class="k">TILEINDEX</span> <span class="s">&quot;imagery.shp&quot;</span>
    <span class="k">TILEITEM</span> <span class="s">&quot;LOCATION&quot;</span>
    <span class="k">TILESRS</span> <span class="s">&quot;src_srs&quot;</span>
    <span class="k">PROJECTION</span>
        <span class="nb">AUTO</span>
        <span class="c"># or :</span>
        <span class="c"># &quot;+init=EPSG:4326&quot;</span>
    <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<p>MapServer will then be able to proceed to on-the-fly mosaicing and reprojection.</p>
</section>
<section id="note-for-wcs-layers">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Note for WCS layers</a><a class="headerlink" href="#note-for-wcs-layers" title="Link to this heading">¶</a></h2>
<p>For layers that must be exposed as WCS layers, a few metadata fields
(“wcs_extent”, “wcs_size”, “wcs_resolution”) must be specified in the LAYER
definition, so as to define a “virtual dataset” coverage (see <a class="reference internal" href="../ogc/wcs_server.html#wcs-server"><span class="std std-ref">WCS Server</span></a>).
The GDAL wcs_virtds_params.py sample script can help generating those metadata
fields.</p>
</section>
<section id="long-ogrtindex-example">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Long ogrtindex example</a><a class="headerlink" href="#long-ogrtindex-example" title="Link to this heading">¶</a></h2>
<p>This example uses TIGER Census data, where the data contains files
divided up by county. In this example we will show how to display
all lakes for the state of Minnesota.  The TIGER
Census data for Minnesota is made up of 85 different counties, each
containing its own lakes file (‘xxxx_areawater.shp’).</p>
<p><strong>Figure 1: County lake files displayed in QGIS</strong></p>
<img alt="../_images/tileindex-qgis-shps.png" class="no-scaled-link" src="../_images/tileindex-qgis-shps.png" style="width: 800px; height: 433px;" />
<p>Our directory structure looks like the following (‘tiger2020’ contains
the 85 shapefiles):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">mainfolder</span>
   <span class="o">-</span> <span class="n">data</span>
     <span class="o">-</span> <span class="n">tiger2020</span>
   <span class="o">-</span> <span class="n">tileindex</span><span class="o">.</span><span class="n">map</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>We need to generate the index file with ogrtindex.  First we will change
directory into the <em>data</em> folder, so that the index file is generated there,
then execute ogrtindex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">data</span>
<span class="n">ogrtindex</span> <span class="n">lakes</span><span class="o">-</span><span class="n">ogrtindex</span><span class="o">.</span><span class="n">shp</span> <span class="n">tiger2020</span><span class="o">/*.</span><span class="n">shp</span>
</pre></div>
</div>
</li>
<li><p>We can now load that new index file <em>lakes-ogrtindex.shp</em> into QGIS to
examine it.</p>
<p><strong>Figure 2: Index file created by ogrtindex utility</strong></p>
<img alt="../_images/tileindex-qgis-shps-index.png" class="no-scaled-link" src="../_images/tileindex-qgis-shps-index.png" style="width: 800px; height: 436px;" />
<p><strong>Figure 3: Attributes of index file created by ogrtindex utility</strong></p>
<img alt="../_images/tileindex-qgis-shps-index-attributes.png" class="no-scaled-link" src="../_images/tileindex-qgis-shps-index-attributes.png" style="width: 595px; height: 567px;" />
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice the relative paths in the LOCATION field, which is the default
(and recommended) for ogrtindex.   If you need full/absolute paths you
can use the <em>-write_absolute_path</em> switch.</p>
</div>
<ol class="arabic" start="3">
<li><p>A protip is to then run <a class="reference internal" href="../utilities/shptree.html#shptree"><span class="std std-ref">shptree</span></a> on the ogrtindex file and all
of the .shp files used, so MapServer can access them quickly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">data</span>
<span class="c1">#windows command:</span>
<span class="k">for</span> <span class="o">/</span><span class="n">R</span> <span class="o">%</span><span class="n">f</span> <span class="ow">in</span> <span class="p">(</span><span class="o">*.</span><span class="n">shp</span><span class="p">)</span> <span class="n">do</span> <span class="n">shptree</span> <span class="o">%</span><span class="n">f</span>
<span class="c1">#unix command:</span>
<span class="n">find</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span> <span class="o">-</span><span class="n">name</span> <span class="s2">&quot;*.shp&quot;</span> <span class="o">-</span><span class="n">exec</span> <span class="n">shptree</span> <span class="p">{}</span> \<span class="p">;</span>
</pre></div>
</div>
<p>You should now see associated <em>.qix</em> files created for each shapefile.</p>
</li>
<li><p>The final step is to use this in your mapfile.</p>
<ul class="simple">
<li><p>LAYER object’s TILEINDEX - must point to the location of the
index file</p></li>
<li><p>LAYER object’s TILEITEM - specify the name of the field in the
index file containing the paths (default is ‘location’)</p></li>
<li><p>do not need to use the LAYER’s DATA parameter</p></li>
<li><p>the location path inside your tileindex file will be relative to
the SHAPEPATH, as shown below:</p></li>
</ul>
<p>For example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="k">NAME</span> <span class="s">&quot;tileindex-map&quot;</span>
  <span class="k">STATUS</span> <span class="nb">ON</span>
  <span class="k">SIZE</span> <span class="mi">600</span> <span class="mi">400</span>
  <span class="k">SYMBOLSET</span> <span class="s">&quot;../etc/symbols.txt&quot;</span>
  <span class="k">EXTENT</span> <span class="p">-</span><span class="mf">99.99</span> <span class="mf">43.13</span> <span class="p">-</span><span class="mf">86.70</span> <span class="mf">49.60</span>
  <span class="k">UNITS</span> <span class="nb">DD</span>
  <span class="k">SHAPEPATH</span> <span class="s">&quot;./data&quot;</span>
  <span class="k">IMAGECOLOR</span> <span class="mi">255</span> <span class="mi">255</span> <span class="mi">255</span>
  <span class="k">FONTSET</span> <span class="s">&quot;../etc/fonts.txt&quot;</span>
  <span class="k">PROJECTION</span>
    <span class="s">&quot;init=epsg:4269&quot;</span>
  <span class="k">END</span> <span class="c"># projection</span>

  <span class="o">/*</span> <span class="err">Lakes:</span> <span class="err">Tiger</span> <span class="err">Census</span> <span class="mi">2020</span> <span class="o">*/</span>
  <span class="k">LAYER</span>
    <span class="k">NAME</span> <span class="s">&quot;lakes&quot;</span>
    <span class="k">TYPE</span> <span class="nb">POLYGON</span>
    <span class="k">STATUS</span> <span class="nb">OFF</span>
    <span class="k">TILEITEM</span> <span class="s">&quot;LOCATION&quot;</span>
    <span class="k">TILEINDEX</span> <span class="s">&quot;lakes-ogrtindex.shp&quot;</span>
    <span class="k">PROJECTION</span>
      <span class="s">&quot;init=epsg:4269&quot;</span>
    <span class="k">END</span> <span class="c"># projection</span>
    <span class="k">CLASS</span>
      <span class="k">NAME</span> <span class="s">&quot;Lakes&quot;</span>
      <span class="k">STYLE</span>
        <span class="k">COLOR</span> <span class="mi">134</span> <span class="mi">204</span> <span class="mi">249</span>
      <span class="k">END</span> <span class="c"># style</span>
    <span class="k">END</span> <span class="c"># class</span>
  <span class="k">END</span> <span class="c"># layer</span>

<span class="k">END</span> <span class="c"># Map File</span>
</pre></div>
</div>
</li>
<li><p>And of course use <a class="reference internal" href="../utilities/map2img.html#map2img"><span class="std std-ref">map2img</span></a> to generate your map image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">map2img</span> <span class="o">-</span><span class="n">m</span> <span class="n">tileindex</span><span class="o">.</span><span class="n">map</span> <span class="o">-</span><span class="n">o</span> <span class="n">ttt</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">map_debug</span> <span class="mi">3</span>
</pre></div>
</div>
<img alt="../_images/tileindex-lakes.png" class="no-scaled-link" src="../_images/tileindex-lakes.png" style="width: 600px; height: 400px;" />
<p>When you view the layer in a MapServer application, you will notice
that when you are zoomed into a small area of the state (such as
a single county) only the necessary lake shapefiles are loaded,
which speeds up the application.</p>
</li>
</ol>
</section>
<section id="long-gdaltindex-example">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Long gdaltindex example</a><a class="headerlink" href="#long-gdaltindex-example" title="Link to this heading">¶</a></h2>
<p>This example uses NAIP ortho imagery, for counties in the
state of Minnesota.  The format is MrSID.  Since the data is
so large, for this exercise 6 counties were used (so 6 MrSID
raster files).  An example filename in this case is
<em>ortho_xxxx.sid</em></p>
<p><strong>Figure 1: MrSID imagery displayed in QGIS</strong></p>
<img alt="../_images/tileindex-qgis-mrsid.png" class="no-scaled-link" src="../_images/tileindex-qgis-mrsid.png" style="width: 800px; height: 433px;" />
<p>Our directory structure looks like the following (‘naip2019’ contains
the 6 MrSID images):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">mainfolder</span>
   <span class="o">-</span> <span class="n">data</span>
     <span class="o">-</span> <span class="n">naip2019</span>
   <span class="o">-</span> <span class="n">tileindex</span><span class="o">.</span><span class="n">map</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>We need to generate the index file with gdaltindex.  First we will change
directory into the <em>data</em> folder, so that the index file is generated there,
then execute gdaltindex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">data</span>
<span class="n">gdaltindex</span> <span class="n">naip</span><span class="o">-</span><span class="n">imagery</span><span class="o">-</span><span class="n">gdaltindex</span><span class="o">.</span><span class="n">shp</span> <span class="n">naip2019</span><span class="o">/*.</span><span class="n">sid</span>
</pre></div>
</div>
</li>
<li><p>We can now load that new index file <em>naip-imagery-gdaltindex.shp</em> into QGIS to
examine it.</p>
<p><strong>Figure 2: Index file created by gdaltindex utility</strong></p>
<img alt="../_images/tileindex-qgis-mrsid-index.png" class="no-scaled-link" src="../_images/tileindex-qgis-mrsid-index.png" style="width: 800px; height: 436px;" />
<p><strong>Figure 3: Attributes of index file created by gdaltindex utility</strong></p>
<img alt="../_images/tileindex-qgis-mrsid-index-attributes.png" class="no-scaled-link" src="../_images/tileindex-qgis-mrsid-index-attributes.png" style="width: 448px; height: 342px;" />
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice the relative paths in the LOCATION field, which is the default
(and recommended) for gdaltindex.   If you need full/absolute paths you
can use the <em>-write_absolute_path</em> switch.</p>
</div>
<ol class="arabic" start="3">
<li><p>A protip is to then run <a class="reference internal" href="../utilities/shptree.html#shptree"><span class="std std-ref">shptree</span></a> on the gdaltindex file so
MapServer can access it quickly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">data</span>
<span class="n">shptree</span> <span class="n">naip</span><span class="o">-</span><span class="n">imagery</span><span class="o">-</span><span class="n">gdaltindex</span><span class="o">.</span><span class="n">shp</span>
</pre></div>
</div>
<p>You should now see a <em>.qix</em> file created.</p>
</li>
<li><p>The final step is to use this in your mapfile.</p>
<ul class="simple">
<li><p>LAYER object’s TILEINDEX - must point to the location of the
index file</p></li>
<li><p>LAYER object’s TILEITEM - specify the name of the field in the
index file containing the paths (default is ‘location’)</p></li>
<li><p>do not need to use the LAYER’s DATA parameter</p></li>
<li><p>the location path inside your tileindex file will be relative to
the SHAPEPATH, as shown below:</p></li>
</ul>
<p>For example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="k">NAME</span> <span class="s">&quot;tileindex-map&quot;</span>
  <span class="k">STATUS</span> <span class="nb">ON</span>
  <span class="k">SIZE</span> <span class="mi">600</span> <span class="mi">400</span>
  <span class="k">SYMBOLSET</span> <span class="s">&quot;../etc/symbols.txt&quot;</span>
  <span class="k">EXTENT</span> <span class="p">-</span><span class="mf">99.99</span> <span class="mf">43.13</span> <span class="p">-</span><span class="mf">86.70</span> <span class="mf">49.60</span>
  <span class="k">UNITS</span> <span class="nb">DD</span>
  <span class="k">SHAPEPATH</span> <span class="s">&quot;./data&quot;</span>
  <span class="k">IMAGECOLOR</span> <span class="mi">255</span> <span class="mi">255</span> <span class="mi">255</span>
  <span class="k">FONTSET</span> <span class="s">&quot;../etc/fonts.txt&quot;</span>
  <span class="k">PROJECTION</span>
    <span class="s">&quot;init=epsg:4269&quot;</span>
  <span class="k">END</span> <span class="c"># projection</span>

  <span class="o">/*</span> <span class="err">Ortho</span> <span class="err">imagery:</span> <span class="err">NAIP</span> <span class="mi">2019</span> <span class="o">*/</span>
  <span class="k">LAYER</span>
    <span class="k">NAME</span> <span class="s">&quot;ortho&quot;</span>
    <span class="k">TYPE</span> <span class="nb">RASTER</span>
    <span class="k">STATUS</span> <span class="nb">ON</span>
    <span class="k">TILEITEM</span> <span class="s">&quot;LOCATION&quot;</span>
    <span class="k">TILEINDEX</span> <span class="s">&quot;naip-imagery-gdaltindex.shp&quot;</span>
    <span class="k">PROJECTION</span>
      <span class="s">&quot;init=epsg:26915&quot;</span>
    <span class="k">END</span> <span class="c"># projection</span>
  <span class="k">END</span> <span class="c"># layer</span>

<span class="k">END</span> <span class="c"># Map File</span>
</pre></div>
</div>
</li>
<li><p>And of course use <a class="reference internal" href="../utilities/map2img.html#map2img"><span class="std std-ref">map2img</span></a> to generate your map image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">map2img</span> <span class="o">-</span><span class="n">m</span> <span class="n">tileindex</span><span class="o">.</span><span class="n">map</span> <span class="o">-</span><span class="n">o</span> <span class="n">ttt</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">map_debug</span> <span class="mi">3</span>
</pre></div>
</div>
<img alt="../_images/tileindex-mrsid.png" class="no-scaled-link" src="../_images/tileindex-mrsid.png" style="width: 600px; height: 400px;" />
<p>When you view the layer in a MapServer application, you will notice
that when you are zoomed into a small area of the state
(such as a single county) only the necessary MrSID images are loaded,
which speeds up the application.</p>
</li>
</ol>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">Tile Indexes</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#what-is-a-tileindex-and-how-do-i-make-one">What is a tileindex and how do I make one?</a></li>
<li><a class="reference internal" href="#using-the-tileindex-in-your-mapfile">Using the tileindex in your mapfile</a></li>
<li><a class="reference internal" href="#tileindexes-may-make-your-map-faster">Tileindexes may make your map faster</a></li>
<li><a class="reference internal" href="#tileindexes-with-tiles-in-different-projections">Tileindexes with tiles in different projections</a></li>
<li><a class="reference internal" href="#note-for-wcs-layers">Note for WCS layers</a></li>
<li><a class="reference internal" href="#long-ogrtindex-example">Long ogrtindex example</a></li>
<li><a class="reference internal" href="#long-gdaltindex-example">Long gdaltindex example</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="vector.html" title="Vector Data Management &amp; Optimization"
             >next</a> |</li>
        <li class="right" >
          <a href="raster.html" title="Raster Management &amp; Optimization"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Optimization</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Tile Indexes</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>