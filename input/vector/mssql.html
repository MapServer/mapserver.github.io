<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MSSQL &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="MySQL" href="mysql.html" />
    <link rel="prev" title="MapInfo" href="mapinfo.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../../index.html" title="Home"><img src="../../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../../index.html" title="Home">Home</a> |
      <a href="../../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../../ar/input/vector/mssql.html"><img src="../../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../../de/input/vector/mssql.html"><img src="../../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../../el/input/vector/mssql.html"><img src="../../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../../es/input/vector/mssql.html"><img src="../../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../../fr/input/vector/mssql.html"><img src="../../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../../id/input/vector/mssql.html"><img src="../../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../../it/input/vector/mssql.html"><img src="../../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../../ja/input/vector/mssql.html"><img src="../../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../../nl_NL/input/vector/mssql.html"><img src="../../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../../pl/input/vector/mssql.html"><img src="../../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../../ru/input/vector/mssql.html"><img src="../../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../../sq/input/vector/mssql.html"><img src="../../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../../tr/input/vector/mssql.html"><img src="../../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="mysql.html" title="MySQL"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mapinfo.html" title="MapInfo"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Data Input</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Vector Data</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MSSQL</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="index-0">
<span id="mssql"></span><span id="id1"></span><h1><a class="toc-backref" href="#contents" role="doc-backlink">MSSQL</a><a class="headerlink" href="#index-0" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tamas Szekeres</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>szekerest at gmail.com</p>
</dd>
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Jeff McKenna</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>jmckenna at gatewaygeomatics.com</p>
</dd>
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Seth Girvin</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>sethg at geographika.co.uk</p>
</dd>
<dt class="field-odd">Last Updated<span class="colon">:</span></dt>
<dd class="field-odd"><p>2021-05-05</p>
</dd>
</dl>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#index-0" id="id2">MSSQL</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id3">Introduction</a></p></li>
<li><p><a class="reference internal" href="#creating-spatial-data-tables-in-mssql" id="id4">Creating Spatial Data Tables in MSSQL</a></p></li>
<li><p><a class="reference internal" href="#connecting-to-spatial-data-in-mssql" id="id5">Connecting to Spatial Data in MSSQL</a></p>
<ul>
<li><p><a class="reference internal" href="#option-1-connect-through-ogr" id="id6">OPTION 1: Connect Through OGR</a></p>
<ul>
<li><p><a class="reference internal" href="#verify-local-support-for-mssqlspatial" id="id7">Verify Local Support for MSSQLSpatial</a></p></li>
<li><p><a class="reference internal" href="#test-ogr-connection-parameters" id="id8">Test OGR Connection Parameters</a></p></li>
<li><p><a class="reference internal" href="#create-mapserver-layer-using-connectiontype-ogr" id="id9">Create MapServer Layer using CONNECTIONTYPE OGR</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#option-2-connect-through-mapserver-plugin" id="id10">OPTION 2: Connect Through MapServer Plugin</a></p>
<ul>
<li><p><a class="reference internal" href="#create-mapserver-layer" id="id11">Create MapServer Layer</a></p></li>
<li><p><a class="reference internal" href="#selecting-the-type-of-the-geometry-column" id="id12">Selecting the Type of the Geometry Column</a></p></li>
<li><p><a class="reference internal" href="#expected-location-of-the-mssql-plugin" id="id13">Expected Location of the MSSQL Plugin</a></p></li>
<li><p><a class="reference internal" href="#binaries-containing-the-mssql-plugin" id="id14">Binaries Containing the MSSQL Plugin</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-spatial-indexes" id="id15">Using Spatial Indexes</a></p></li>
<li><p><a class="reference internal" href="#layer-processing-options" id="id16">Layer Processing Options</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Microsoft SQL Server supports storing spatial data by using the
built-in geometry/geography data types. MapServer can connect to MSSQL through either:
1) an OGR connectiontype, or 2) a driver that accesses these tables containing spatial
columns, which is compiled as a plugin (“msplugin_mssql2008.dll”).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even though the driver refers to <em>mssql2008</em> all versions of MSSQL since MSSQL 2008 are supported.</p>
</div>
<p>More Information:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gdal.org/drivers/vector/mssqlspatial.html">OGR MSSQL Spatial driver page</a> (describes the OGR MSSQL support)</p></li>
<li><p><a class="reference external" href="https://gdal.org/programs/ogr2ogr.html">ogr2ogr application</a> (describes the ogr2ogr commandline application)</p></li>
<li><p><a class="reference internal" href="index.html#vector"><span class="std std-ref">Vector Data</span></a> (MapServer Vector Data Access Guide)</p></li>
</ul>
</section>
<section id="creating-spatial-data-tables-in-mssql">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Creating Spatial Data Tables in MSSQL</a><a class="headerlink" href="#creating-spatial-data-tables-in-mssql" title="Link to this heading">¶</a></h2>
<p>There are several ways to create spatial data tables in MSSQL. You can easily upload existing data to an MSSQL
table by using the <a class="reference external" href="https://gdal.org/programs/ogr2ogr.html">ogr2ogr</a>
commandline tool and the OGR’s <a class="reference external" href="https://gdal.org/drivers/vector/mssqlspatial.html">MSSQL Spatial driver</a>.  Here is an example that uploads
a shapefile (province.shp) into an MSSQL instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="n">MSSQLSpatial</span> <span class="o">-</span><span class="n">a_srs</span> <span class="n">EPSG</span><span class="p">:</span><span class="mi">4326</span> <span class="s2">&quot;MSSQL:server=.\SQLEXPRESS;database=geo;trusted_connection=yes&quot;</span> <span class="n">province</span><span class="o">.</span><span class="n">shp</span>
</pre></div>
</div>
</section>
<section id="connecting-to-spatial-data-in-mssql">
<h2><a class="toc-backref" href="#contents" role="doc-backlink">Connecting to Spatial Data in MSSQL</a><a class="headerlink" href="#connecting-to-spatial-data-in-mssql" title="Link to this heading">¶</a></h2>
<p>In order to connect to a MSSQL spatial database you should set
up a valid connection string to the database like the following
examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Server</span><span class="o">=.</span>\<span class="n">MSSQLSERVER2008</span><span class="p">;</span><span class="n">Database</span><span class="o">=</span><span class="n">Maps</span><span class="p">;</span><span class="n">Integrated</span> <span class="n">Security</span><span class="o">=</span><span class="n">true</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Server</span><span class="o">=</span><span class="mf">55.55.55.55</span><span class="p">,</span><span class="mi">1433</span><span class="p">;</span><span class="n">uid</span><span class="o">=</span><span class="n">a_user</span><span class="p">;</span><span class="n">pwd</span><span class="o">=</span><span class="n">a_password</span><span class="p">;</span><span class="n">database</span><span class="o">=</span><span class="n">a_database</span><span class="p">;</span>
       <span class="n">Integrated</span> <span class="n">Security</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Server</span><span class="o">=</span><span class="mf">55.55.55.55</span>\<span class="n">SQLEXPRESS</span><span class="p">,</span><span class="mi">1433</span><span class="p">;</span><span class="n">uid</span><span class="o">=</span><span class="n">a_user</span><span class="p">;</span><span class="n">pwd</span><span class="o">=</span><span class="n">a_password</span><span class="p">;</span>
       <span class="n">database</span><span class="o">=</span><span class="n">a_database</span><span class="p">;</span><span class="n">Integrated</span> <span class="n">Security</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
<p>If you don’t specify Driver in the connection string, it uses the “SQL Server” driver (sqlsrv32.dll)
which was last updated in 2010. To use a newer driver you can specify this in the connection string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">=</span><span class="p">{</span><span class="n">ODBC</span> <span class="n">Driver</span> <span class="mi">17</span> <span class="k">for</span> <span class="n">SQL</span> <span class="n">Server</span><span class="p">};</span><span class="n">server</span><span class="o">=</span><span class="mf">55.55.55.55</span>\<span class="n">SQLEXPRESS</span><span class="p">,</span><span class="mi">1433</span><span class="p">;</span><span class="n">uid</span><span class="o">=</span><span class="n">a_user</span><span class="p">;</span><span class="n">pwd</span><span class="o">=</span><span class="n">a_password</span><span class="p">;</span>
    <span class="n">database</span><span class="o">=</span><span class="n">a_database</span><span class="p">;</span><span class="n">Integrated</span> <span class="n">Security</span><span class="o">=</span><span class="kc">False</span>
</pre></div>
</div>
<p>The “SQL Server Native Client” drivers are also supported.</p>
<section id="option-1-connect-through-ogr">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">OPTION 1: Connect Through OGR</a><a class="headerlink" href="#option-1-connect-through-ogr" title="Link to this heading">¶</a></h3>
<p>GDAL/OGR (and therefore MapServer) can read spatial tables in MSSQL 2008 through the
<a class="reference external" href="https://gdal.org/drivers/vector/mssqlspatial.html">MSSQLSpatial driver</a>.</p>
<section id="verify-local-support-for-mssqlspatial">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Verify Local Support for MSSQLSpatial</a><a class="headerlink" href="#verify-local-support-for-mssqlspatial" title="Link to this heading">¶</a></h4>
<p>Use the command <em>ogrinfo –formats</em> to verify that your local GDAL is built with support for MSSQL;
the response should contain “MSSQLSpatial” such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Supported</span> <span class="n">Formats</span><span class="p">:</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;OCI&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;ESRI Shapefile&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;MapInfo File&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
  <span class="o">...</span>
  <span class="o">-&gt;</span> <span class="s2">&quot;MSSQLSpatial&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
  <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="test-ogr-connection-parameters">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Test OGR Connection Parameters</a><a class="headerlink" href="#test-ogr-connection-parameters" title="Link to this heading">¶</a></h4>
<p>Use the <em>ogrinfo</em> commandline utility to test your connection through the MSSQLSpatial driver, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="s2">&quot;MSSQL:server=.\SQLEXPRESS;database=geo;trusted_connection=yes&quot;</span> <span class="n">province</span> <span class="o">-</span><span class="n">summary</span>
</pre></div>
</div>
</section>
<section id="create-mapserver-layer-using-connectiontype-ogr">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Create MapServer Layer using CONNECTIONTYPE OGR</a><a class="headerlink" href="#create-mapserver-layer-using-connectiontype-ogr" title="Link to this heading">¶</a></h4>
<p>Your layer should contain a CONNECTIONTYPE OGR statement, as well as a CONNECTION.
The connection should also contact a “tables=” parameter, and also the name of the
geometry column in brackets.  You do not need to specify the DATA parameter unless you
define an sql select statement starting with the ‘WHERE’ keyword.  For example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="k">NAME</span> <span class="s">&quot;provinces&quot;</span>
  <span class="k">TYPE</span> <span class="nb">POLYGON</span>
  <span class="k">STATUS</span> <span class="nb">ON</span>
  <span class="c">####</span>
  <span class="k">CONNECTIONTYPE</span> <span class="nb">OGR</span>
  <span class="k">CONNECTION</span> <span class="s">&quot;MSSQL:server=.\SQLEXPRESS;uid=xx;pwd=xxx;database=geo;trusted_connection=yes;tables=province(ogr_geometry)&quot;</span>
  <span class="c">####</span>
  <span class="k">PROJECTION</span>
    <span class="s">&quot;init=epsg:4326&quot;</span>
  <span class="k">END</span>
  <span class="k">CLASS</span>
    <span class="k">NAME</span> <span class="s">&quot;Land&quot;</span>
    <span class="k">STYLE</span>
      <span class="k">COLOR</span> <span class="mi">240</span> <span class="mi">240</span> <span class="mi">240</span>
      <span class="k">OUTLINECOLOR</span> <span class="mi">199</span> <span class="mi">199</span> <span class="mi">199</span>
    <span class="k">END</span>
  <span class="k">END</span>
  <span class="k">PROCESSING</span> <span class="s">&#39;CLOSE_CONNECTION=DEFER&#39;</span>
<span class="k">END</span> <span class="c"># layer</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The usual CONNECTIONTYPE terms ‘using unique’ and ‘using srid’ are not meaningful
for the OGR driver in this case, as these parameters are automatically retrieved
from the ‘geometry_columns’ metadata table.</p>
</div>
</section>
</section>
<section id="option-2-connect-through-mapserver-plugin">
<span id="mssql-plugin"></span><h3><a class="toc-backref" href="#contents" role="doc-backlink">OPTION 2: Connect Through MapServer Plugin</a><a class="headerlink" href="#option-2-connect-through-mapserver-plugin" title="Link to this heading">¶</a></h3>
<section id="create-mapserver-layer">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Create MapServer Layer</a><a class="headerlink" href="#create-mapserver-layer" title="Link to this heading">¶</a></h4>
<p>Once the connection can be established to the server the layer can be
configured to access MSSQL as follows:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="k">NAME</span> <span class="s">&quot;rivers_mssql_spatial&quot;</span>
  <span class="k">TYPE</span> <span class="nb">POLYGON</span>
  <span class="k">STATUS</span> <span class="nb">DEFAULT</span>
  <span class="k">CONNECTIONTYPE</span> <span class="nb">PLUGIN</span>
  <span class="nb">PLUGIN</span> <span class="s">&quot;msplugin_mssql2008.dll&quot;</span>
  <span class="k">CONNECTION</span> <span class="s">&quot;Server=.\MSSQLSERVER2008;Database=Maps;Integrated Security=true&quot;</span>
  <span class="k">DATA</span> <span class="s">&quot;ogr_geometry from rivers USING UNIQUE ogr_fid USING SRID=4326&quot;</span>
  <span class="p">...</span>
<span class="k">END</span>
</pre></div>
</div>
<p>The DATA parameter is used to perform the SQL select statement to
access your table in MSSQL.  The geometry column is required in the
select statement; in the above example the ogr_geometry column is the
geometry column in the rivers table. The table should also have an
unique column (ogr_fid) which is provided for random access to the
features in the feature query operations.</p>
<p>The DATA section should also contain the spatial reference id (SRID)
of the features in the data table The SRID is used when specifying the
search shapes during the intersect operations which should match with
the SRID of the features otherwise no features are returned in a
particular query.  if you omit specifying the SRID value in the DATA
section the diver will use SRID=0 when defining the search shapes.</p>
</section>
<section id="selecting-the-type-of-the-geometry-column">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Selecting the Type of the Geometry Column</a><a class="headerlink" href="#selecting-the-type-of-the-geometry-column" title="Link to this heading">¶</a></h4>
<p>For the geometry columns MSSQL supports 2 data types: “geometry” and
“geography”.  By default the driver considers the type of the geometry
column is “geometry”.  In case if the type of the geometry column is
“geography” we must specify the data type in the DATA section
explicitly, like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DATA</span> <span class="s2">&quot;ogr_geometry(geography) from rivers USING UNIQUE ogr_fid USING SRID=4326&quot;</span>
</pre></div>
</div>
</section>
<section id="expected-location-of-the-mssql-plugin">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Expected Location of the MSSQL Plugin</a><a class="headerlink" href="#expected-location-of-the-mssql-plugin" title="Link to this heading">¶</a></h4>
<p>On Windows platforms the DLLs needed by the program are searched for
in the following order:</p>
<ol class="arabic simple">
<li><p>The directory from which the application loaded.</p></li>
<li><p>The current directory.</p></li>
<li><p>The system directory. Use the <a class="reference external" href="http://msdn.microsoft.com/en-us/library/ms724373.aspx">GetSystemDirectory</a> function
to get the path of this directory.</p></li>
<li><p>The 16-bit system directory.</p></li>
<li><p>The Windows directory. Use the <a class="reference external" href="http://msdn.microsoft.com/en-us/library/ms724454.aspx">GetWindowsDirectory</a> function
to get the path of this directory.</p></li>
<li><p>The directories that are listed in the PATH environment variable.</p></li>
</ol>
</section>
<section id="binaries-containing-the-mssql-plugin">
<h4><a class="toc-backref" href="#contents" role="doc-backlink">Binaries Containing the MSSQL Plugin</a><a class="headerlink" href="#binaries-containing-the-mssql-plugin" title="Link to this heading">¶</a></h4>
<p>Currently the following binary distributions contain
msplugin_mssql2008.dll:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.gisinternals.com">GISInternals</a></p></li>
<li><p><a class="reference external" href="https://ms4w.com">MS4W</a></p></li>
</ul>
</section>
</section>
<section id="using-spatial-indexes">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Using Spatial Indexes</a><a class="headerlink" href="#using-spatial-indexes" title="Link to this heading">¶</a></h3>
<p>In order to speed up the access to the features a spatial index should
be created to the geometry column which could easily be done with the
OGR MSSQL Spatial driver like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="o">-</span><span class="n">sql</span> <span class="s2">&quot;create spatial index on rivers&quot;</span>
             <span class="s2">&quot;MSSQL:server=.\MSSQLSERVER2008;database=Maps;</span>
              <span class="n">Integrated</span> <span class="n">Security</span><span class="o">=</span><span class="n">true</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>In general we can safely rely on the query optimizer to select the
most appropriate index in the sql query operations. In some cases -
however - we should force the optimizer to use the spatial index by
specifying the index hint in the DATA section like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DATA</span> <span class="s2">&quot;ogr_geometry from rivers using index ogr_geometry_sidx</span>
      <span class="n">USING</span> <span class="n">UNIQUE</span> <span class="n">ogr_fid</span> <span class="n">USING</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
<section id="layer-processing-options">
<h3><a class="toc-backref" href="#contents" role="doc-backlink">Layer Processing Options</a><a class="headerlink" href="#layer-processing-options" title="Link to this heading">¶</a></h3>
<p>We can control the behaviour of the MSSQL driver by using the
following PROCESSING options:</p>
<ul class="simple" id="index-1">
<li><p><strong>CLOSE_CONNECTION=DEFER</strong> - This is where you can enable connection
pooling for certain layer types. Connection pooling will allow
MapServer to share the handle to an open database or layer
connection throughout a single map draw process.</p></li>
</ul>
<ul class="simple" id="index-2">
<li><p><strong>MSSQL_READ_WKB=TRUE</strong> - Uses WKB (Well Known Binary) format
instead of native format when fetching geometries.</p></li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../../about.html" title="About">About</a><br>
<a href="../../products.html" title="Products">Products</a><br>
<a href="../../community/index.html" title="Community">Community</a><br>
<a href="../../development/index.html" title="Development">Development</a><br>
<a href="../../download.html" title="Downloads">Downloads</a><br>
<a href="../../documentation.html" title="Documentation">Documentation</a><br>
<a href="../../faq.html" title="FAQ">FAQ</a><br>
<a href="../../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">MSSQL</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#creating-spatial-data-tables-in-mssql">Creating Spatial Data Tables in MSSQL</a></li>
<li><a class="reference internal" href="#connecting-to-spatial-data-in-mssql">Connecting to Spatial Data in MSSQL</a><ul>
<li><a class="reference internal" href="#option-1-connect-through-ogr">OPTION 1: Connect Through OGR</a><ul>
<li><a class="reference internal" href="#verify-local-support-for-mssqlspatial">Verify Local Support for MSSQLSpatial</a></li>
<li><a class="reference internal" href="#test-ogr-connection-parameters">Test OGR Connection Parameters</a></li>
<li><a class="reference internal" href="#create-mapserver-layer-using-connectiontype-ogr">Create MapServer Layer using CONNECTIONTYPE OGR</a></li>
</ul>
</li>
<li><a class="reference internal" href="#option-2-connect-through-mapserver-plugin">OPTION 2: Connect Through MapServer Plugin</a><ul>
<li><a class="reference internal" href="#create-mapserver-layer">Create MapServer Layer</a></li>
<li><a class="reference internal" href="#selecting-the-type-of-the-geometry-column">Selecting the Type of the Geometry Column</a></li>
<li><a class="reference internal" href="#expected-location-of-the-mssql-plugin">Expected Location of the MSSQL Plugin</a></li>
<li><a class="reference internal" href="#binaries-containing-the-mssql-plugin">Binaries Containing the MSSQL Plugin</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-spatial-indexes">Using Spatial Indexes</a></li>
<li><a class="reference internal" href="#layer-processing-options">Layer Processing Options</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="mysql.html" title="MySQL"
             >next</a> |</li>
        <li class="right" >
          <a href="mapinfo.html" title="MapInfo"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Data Input</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Vector Data</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MSSQL</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>