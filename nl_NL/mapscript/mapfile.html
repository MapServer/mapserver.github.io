
<!DOCTYPE html>

<html lang="nl_NL">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mapfile Manipulation &#8212; MapServer 7.6.2 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="shortcut icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="Over deze documenten" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Zoeken" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Querying" href="querying.html" />
    <link rel="prev" title="Python MapScript Image Generation" href="imagery.html" /> 
  </head><body>

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../mapscript/mapfile.html"><img src="../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../ar/mapscript/mapfile.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../de/mapscript/mapfile.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../el/mapscript/mapfile.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        
          
            <a href="../../es/mapscript/mapfile.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
          
        
        
          
            <a href="../../fr/mapscript/mapfile.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
          
        
        
          
            <a href="../../id/mapscript/mapfile.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../it/mapscript/mapfile.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        
          
            <a href="../../ja/mapscript/mapfile.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
          
        
        <img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" width="18px" height="13px"/>
        
          
            <a href="../../pl/mapscript/mapfile.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../ru/mapscript/mapfile.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../sq/mapscript/mapfile.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../tr/mapscript/mapfile.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigatie</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Algemene index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="querying.html" title="Querying"
             accesskey="N">volgende</a> |</li>
        <li class="right" >
          <a href="imagery.html" title="Python MapScript Image Generation"
             accesskey="P">vorige</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.6.2 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">MapScript</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Mapfile Manipulation</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="index-0"></span><div class="section" id="mapfile-manipulation">
<h1><a class="toc-backref" href="#inhoud">Mapfile Manipulation</a><a class="headerlink" href="#mapfile-manipulation" title="Permalink naar deze titel">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Sean Gillies</p>
</dd>
</dl>
<div class="contents topic" id="inhoud">
<p class="topic-title">Inhoud</p>
<ul class="simple">
<li><p><a class="reference internal" href="#mapfile-manipulation" id="id1">Mapfile Manipulation</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#mapfile-overview" id="id3">Mapfile Overview</a></p></li>
<li><p><a class="reference internal" href="#the-mapobj-class" id="id4">The mapObj Class</a></p></li>
<li><p><a class="reference internal" href="#children-of-mapobj" id="id5">Children of mapObj</a></p></li>
<li><p><a class="reference internal" href="#metadata" id="id6">Metadata</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#inhoud">Introduction</a><a class="headerlink" href="#introduction" title="Permalink naar deze titel">¶</a></h2>
<p>The MapScript HowTo docs are intended to complement the API reference with
examples of usage for specific subjects.  All examples in this document refer
to the mapfile and testing layers distributed with MapServer 4.2+ and found
under mapserver/tests.</p>
<div class="section" id="pseudocode">
<h3>Pseudocode<a class="headerlink" href="#pseudocode" title="Permalink naar deze titel">¶</a></h3>
<p>All examples will use a pseudocode that is consistent with the language
independent API reference.  Each line is a statement. For object attributes
and methods we use the dot, ‘.’, operator.  Creation and deletion of objects
will be indicated by ‘new’ and ‘del’ keywords.  Other than that, the
pseudocode looks a lot like Python.</p>
</div>
</div>
<div class="section" id="mapfile-overview">
<h2><a class="toc-backref" href="#inhoud">Mapfile Overview</a><a class="headerlink" href="#mapfile-overview" title="Permalink naar deze titel">¶</a></h2>
<p>By “Mapfile” here, I mean all the elements that can occur in (nearly)
arbitrary numbers within a MapScript mapObj: Layers, Classes, and Styles.
MapServer 4.4 has greatly improved capability to manipulate these objects.</p>
</div>
<div class="section" id="the-mapobj-class">
<span id="index-1"></span><h2><a class="toc-backref" href="#inhoud">The mapObj Class</a><a class="headerlink" href="#the-mapobj-class" title="Permalink naar deze titel">¶</a></h2>
<p>An instance of mapObj is a parent for zero to many layerObj children.</p>
<div class="section" id="new-instances">
<h3>New instances<a class="headerlink" href="#new-instances" title="Permalink naar deze titel">¶</a></h3>
<p>The mapfile path argument to the mapscript.mapObj constructor is now optional</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">empty_map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">mapObj</span>
</pre></div>
</div>
<p>generates a default mapObj with no layers.  A mapObj is initialized from a
mapfile on disk in the usual manner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test_map</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">mapObj</span><span class="p">(</span><span class="s1">&#39;tests/test.map&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="cloning">
<span id="index-2"></span><h3>Cloning<a class="headerlink" href="#cloning" title="Permalink naar deze titel">¶</a></h3>
<p>An independent copy, less result and label caches, of a mapObj can be produced
by the new mapObj.clone() method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clone_map</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Notitie</p>
<p>the Java MapScript module implements a “cloneMap” method to avoid
conflict with the clone method of Java’s Object class.</p>
</div>
</div>
<div class="section" id="saving">
<span id="index-3"></span><h3>Saving<a class="headerlink" href="#saving" title="Permalink naar deze titel">¶</a></h3>
<p>A mapObj can be saved to disk using the save method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clone_map</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;clone.map&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Frankly, the msSaveMap() function which is the foundation for mapObj::save
is incomplete.  Your mileage may vary.</p>
</div>
</div>
<div class="section" id="children-of-mapobj">
<h2><a class="toc-backref" href="#inhoud">Children of mapObj</a><a class="headerlink" href="#children-of-mapobj" title="Permalink naar deze titel">¶</a></h2>
<p>There is a common parent/child object API for Layers, Classes, and Styles in
MapServer 4.4.</p>
<div class="section" id="referencing-a-child">
<h3>Referencing a Child<a class="headerlink" href="#referencing-a-child" title="Permalink naar deze titel">¶</a></h3>
<p>References to Layer, Class, and Style children are obtained by “getChild”-like
methods of their parent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer_i</span>   <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">getLayer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">class_ij</span>  <span class="o">=</span>  <span class="n">layer_i</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="n">style_ijk</span> <span class="o">=</span> <span class="n">class_ij</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
<p>These references are for convenience only.  MapScript doesn’t have any
reference counting, and you are certain to run into trouble if you try to use
these references after the parent mapObj has been deleted and freed from
memory.</p>
</div>
<div class="section" id="cloning-a-child">
<span id="index-4"></span><h3>Cloning a Child<a class="headerlink" href="#cloning-a-child" title="Permalink naar deze titel">¶</a></h3>
<p>A completely independent Layer, Class, or Style can be created using the clone
method of layerObj, classObj, and styleObj:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clone_layer</span> <span class="o">=</span> <span class="n">layer_i</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</pre></div>
</div>
<p>This instance has no parent, and is self-owned.</p>
</div>
<div class="section" id="new-children">
<h3>New Children<a class="headerlink" href="#new-children" title="Permalink naar deze titel">¶</a></h3>
<p>Uninitialized instances of layerObj, classObj, or styleObj can be created
with the new constructors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">layerObj</span>
<span class="n">new_class</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">classObj</span>
<span class="n">new_style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">styleObj</span>
</pre></div>
</div>
<p>and are added to a parent object using “insertChild”-like methods of the
parent which returns the index at which the child was inserted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">li</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">insertLayer</span><span class="p">(</span><span class="n">new_layer</span><span class="p">)</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">getLayer</span><span class="p">(</span><span class="n">li</span><span class="p">)</span><span class="o">.</span><span class="n">insertClass</span><span class="p">(</span><span class="n">new_class</span><span class="p">)</span>
<span class="n">si</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">getLayer</span><span class="p">(</span><span class="n">li</span><span class="p">)</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span><span class="o">.</span><span class="n">insertStyle</span><span class="p">(</span><span class="n">new_style</span><span class="p">)</span>
</pre></div>
</div>
<p>The insert* methods create a completely new copy of the object and store it
in the parent with all ownership taken on by the parent.</p>
<p>see the API reference for more details.</p>
</div>
<div class="section" id="backwards-compatibility">
<h3>Backwards Compatibility<a class="headerlink" href="#backwards-compatibility" title="Permalink naar deze titel">¶</a></h3>
<p>The old style child object constructors with the parent object as a single
argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_layer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">layerObj</span><span class="p">(</span><span class="n">test_map</span><span class="p">)</span>
<span class="n">new_class</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">classObj</span><span class="p">(</span><span class="n">new_layer</span><span class="p">)</span>
<span class="n">new_style</span> <span class="o">=</span> <span class="n">new</span> <span class="n">mapscript</span><span class="o">.</span><span class="n">styleObj</span><span class="p">(</span><span class="n">new_class</span><span class="p">)</span>
</pre></div>
</div>
<p>remain in MapServer 4.4.</p>
</div>
<div class="section" id="removing-children">
<h3>Removing Children<a class="headerlink" href="#removing-children" title="Permalink naar deze titel">¶</a></h3>
<p>Child objects can be removed with “removeChild”-like methods of parents, which
return independent copies of the removed object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># following from the insertion example ...</span>
<span class="c1"># remove the inserted style, returns a copy of the original new_style</span>
<span class="n">removed_style</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">getLayer</span><span class="p">(</span><span class="n">li</span><span class="p">)</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span><span class="o">.</span><span class="n">removeStyle</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>
<span class="n">removed_class</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">getLayer</span><span class="p">(</span><span class="n">li</span><span class="p">)</span><span class="o">.</span><span class="n">removeClass</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span>
<span class="n">removed_layer</span> <span class="o">=</span> <span class="n">test_map</span><span class="o">.</span><span class="n">removeLayer</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="metadata">
<h2><a class="toc-backref" href="#inhoud">Metadata</a><a class="headerlink" href="#metadata" title="Permalink naar deze titel">¶</a></h2>
<p>Map, Layer, and Class metadata are the other arbitrarily numbered elements
(well, up to the built-in limit of 41) of a mapfile.</p>
<div class="section" id="new-api">
<h3>New API<a class="headerlink" href="#new-api" title="Permalink naar deze titel">¶</a></h3>
<p>In MapServer 4.4, the metadata attributes of mapObj.web, layerObj, and classObj
are instances of hashTableObj, a class which functions like a limited
dictionary</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;wms_name&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wms_name&#39;</span><span class="p">)</span>   <span class="c1"># returns &#39;foo&#39;</span>
</pre></div>
</div>
<p>You can iterate over all keys in a hashTableObj like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">key</span> <span class="o">=</span> <span class="n">NULL</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">nextKey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">NULL</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>See the API Reference (mapscript.txt) for more details.</p>
</div>
<div class="section" id="backwards-compatibility-for-metadata">
<h3>Backwards Compatibility for Metadata<a class="headerlink" href="#backwards-compatibility-for-metadata" title="Permalink naar deze titel">¶</a></h3>
<p>The old getMetaData and setMetaData methods of mapObj, layerObj, and classObj
remain for use by older programs.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Snel zoeken</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Zoek" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">Mapfile Manipulation</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#pseudocode">Pseudocode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mapfile-overview">Mapfile Overview</a></li>
<li><a class="reference internal" href="#the-mapobj-class">The mapObj Class</a><ul>
<li><a class="reference internal" href="#new-instances">New instances</a></li>
<li><a class="reference internal" href="#cloning">Cloning</a></li>
<li><a class="reference internal" href="#saving">Saving</a></li>
</ul>
</li>
<li><a class="reference internal" href="#children-of-mapobj">Children of mapObj</a><ul>
<li><a class="reference internal" href="#referencing-a-child">Referencing a Child</a></li>
<li><a class="reference internal" href="#cloning-a-child">Cloning a Child</a></li>
<li><a class="reference internal" href="#new-children">New Children</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards Compatibility</a></li>
<li><a class="reference internal" href="#removing-children">Removing Children</a></li>
</ul>
</li>
<li><a class="reference internal" href="#metadata">Metadata</a><ul>
<li><a class="reference internal" href="#new-api">New API</a></li>
<li><a class="reference internal" href="#backwards-compatibility-for-metadata">Backwards Compatibility for Metadata</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigatie</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Algemene index"
             >index</a></li>
        <li class="right" >
          <a href="querying.html" title="Querying"
             >volgende</a> |</li>
        <li class="right" >
          <a href="imagery.html" title="Python MapScript Image Generation"
             >vorige</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.6.2 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >MapScript</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Mapfile Manipulation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2021, Open Source Geospatial Foundation.
      Laatste aanpassing op 2021-03-21.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.3.
    </div>
  </body>
</html>