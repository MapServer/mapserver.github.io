<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GEOMTRANSFORM - Geometry Transformations &mdash; MapServer 7.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '7.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="MapServer 7.0.0 documentation" href="../index.html" />
    <link rel="up" title="Mapfile" href="index.html" />
    <link rel="next" title="GRID" href="grid.html" />
    <link rel="prev" title="FONTSET" href="fontset.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../faq.html" title="FAQ">FAQ</a> |
      <a href="../download.html" title="Download">Download </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../ar/mapfile/geomtransform.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../de/mapfile/geomtransform.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../el/mapfile/geomtransform.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../es/mapfile/geomtransform.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../fr/mapfile/geomtransform.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../id/mapfile/geomtransform.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../it/mapfile/geomtransform.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../ja/mapfile/geomtransform.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../nl_NL/mapfile/geomtransform.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../pl/mapfile/geomtransform.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../ru/mapfile/geomtransform.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../sq/mapfile/geomtransform.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../tr/mapfile/geomtransform.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        
        
          <a href="../uk/mapfile/geomtransform.html"><img src="../_static/flagicons/uk.png" alt="uk" title="uk" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="grid.html" title="GRID"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fontset.html" title="FONTSET"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.0.0 Documentation</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Mapfile</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="geomtransform-geometry-transformations">
<span id="geomtransform"></span><span id="index-0"></span><h1>GEOMTRANSFORM - Geometry Transformations<a class="headerlink" href="#geomtransform-geometry-transformations" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Håvard Tveite</td>
</tr>
<tr class="field-even field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:havard&#46;tveite&#37;&#52;&#48;nmbu&#46;no">havard<span>&#46;</span>tveite<span>&#64;</span>nmbu<span>&#46;</span>no</a></td>
</tr>
</tbody>
</table>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#transformations-for-simple-styling-class-style-only" id="id23">Transformations for simple styling (<cite>CLASS</cite> <cite>STYLE</cite> only)</a><ul>
<li><a class="reference internal" href="#bbox" id="id24">bbox</a></li>
<li><a class="reference internal" href="#centroid" id="id25">centroid</a></li>
<li><a class="reference internal" href="#end-and-start" id="id26"><cite>end</cite> and <cite>start</cite></a></li>
<li><a class="reference internal" href="#vertices" id="id27">vertices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#labels-label-style-only" id="id28">Labels (<cite>LABEL</cite> <cite>STYLE</cite> only)</a><ul>
<li><a class="reference internal" href="#labelpnt-and-labelpoly" id="id29">labelpnt and labelpoly</a></li>
</ul>
</li>
<li><a class="reference internal" href="#expressions-and-advanced-transformations-layer-and-class-style" id="id30">Expressions and advanced transformations (<cite>LAYER</cite> and <cite>CLASS</cite> <cite>STYLE</cite>)</a><ul>
<li><a class="reference internal" href="#combining-chaining-expressions" id="id31">Combining / chaining expressions</a><ul>
<li><a class="reference internal" href="#buffer" id="id32">buffer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generalize-shape-tolerance" id="id33">generalize ([shape], tolerance)</a></li>
<li><a class="reference internal" href="#simplify-shape-tolerance" id="id34">simplify([shape], tolerance)</a></li>
<li><a class="reference internal" href="#simplifypt-shape-tolerance" id="id35">simplifypt([shape], tolerance)</a></li>
<li><a class="reference internal" href="#smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing" id="id36">smoothsia ( [shape], smoothing_size, smoothing_iterations, preprocessing )</a><ul>
<li><a class="reference internal" href="#tuning-the-behaviour-of-smoothsia" id="id37">Tuning the behaviour of smoothsia</a></li>
<li><a class="reference internal" href="#dataset-resolution-is-too-high" id="id38">Dataset resolution is too high</a></li>
<li><a class="reference internal" href="#dataset-resolution-is-too-low" id="id39">Dataset resolution is too low</a></li>
<li><a class="reference internal" href="#curves" id="id40">Curves</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#javascript-transformation" id="id41">Javascript transformation</a><ul>
<li><a class="reference internal" href="#introduction" id="id42">Introduction</a></li>
<li><a class="reference internal" href="#usage" id="id43">Usage</a><ul>
<li><a class="reference internal" href="#example-1-simple-geomtransform" id="id44">Example 1. Simple Geomtransform</a></li>
<li><a class="reference internal" href="#example-2-printing-logs-in-mapserver-logs" id="id45">Example 2. Printing logs in MapServer logs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-api" id="id46">Basic API</a><ul>
<li><a class="reference internal" href="#pointobj" id="id47">pointObj</a><ul>
<li><a class="reference internal" href="#constructor" id="id48">Constructor</a></li>
<li><a class="reference internal" href="#members" id="id49">Members</a></li>
<li><a class="reference internal" href="#methods" id="id50">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lineobj" id="id51">lineObj</a><ul>
<li><a class="reference internal" href="#id1" id="id52">Constructor</a></li>
<li><a class="reference internal" href="#id2" id="id53">Members</a></li>
<li><a class="reference internal" href="#id3" id="id54">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shapeobj" id="id55">shapeObj</a><ul>
<li><a class="reference internal" href="#id4" id="id56">Constructor</a></li>
<li><a class="reference internal" href="#id5" id="id57">Members</a></li>
<li><a class="reference internal" href="#id6" id="id58">Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Geometry transformations return a new geometry.
The purpose of a geometry transformation can be to achieve special
effects for symbol rendering and labeling.</p>
<p>Geometry transformation is available at the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level and the
<a class="reference internal" href="style.html#style"><span>STYLE</span></a> level.  At the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level (since 6.4), the
original vector geometry (&#8220;real world&#8221; coordinates) is used.  At the
<a class="reference internal" href="style.html#style"><span>STYLE</span></a> level, pixel coordinates are used.</p>
<p>It may be useful to apply pixel values also at the <cite>LAYER</cite> level, and
that is possible.  If <cite>UNITS</cite> is defined in the <cite>LAYER</cite>, the
[map_cellsize] variable can be used to convert to pixel values at the
<cite>LAYER</cite> level:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">simplify</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="p">[</span><span class="n">map_cellsize</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="transformations-for-simple-styling-class-style-only">
<h2><a class="toc-backref" href="#table-of-contents">Transformations for simple styling (<cite>CLASS</cite> <cite>STYLE</cite> only)</a><a class="headerlink" href="#transformations-for-simple-styling-class-style-only" title="Permalink to this headline">¶</a></h2>
<p>The following simple geometry transformations are available at
the <cite>CLASS</cite> <cite>STYLE</cite> level:</p>
<ul class="simple">
<li>bbox</li>
<li>centroid</li>
<li>end</li>
<li>start</li>
<li>vertices</li>
</ul>
<div class="section" id="bbox">
<span id="index-1"></span><h3><a class="toc-backref" href="#table-of-contents">bbox</a><a class="headerlink" href="#bbox" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>GEOMTRANSFORM bbox</cite> returns the bounding box of the geometry.<ul>
<li>GEOMTRANSFORM &#8220;bbox&#8221;</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only available for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../_images/geomtrans-bbox.png"><img alt="../_images/geomtrans-bbox.png" src="../_images/geomtrans-bbox.png" style="width: 200px; height: 100px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform bbox</span></p>
</div>
<p>Class definitions for the example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>CLASS
  STYLE
    COLOR 0 0 0
    WIDTH 6
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;bbox&quot;
    OUTLINECOLOR 255 0 0
    WIDTH 1
    PATTERN 1 2 END
  END # STYLE
END # CLASS
</pre></div>
</div>
</div>
<div class="section" id="centroid">
<span id="index-2"></span><h3><a class="toc-backref" href="#table-of-contents">centroid</a><a class="headerlink" href="#centroid" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>GEOMTRANSFORM centroid</cite> returns the centroid of the geometry.<ul>
<li>GEOMTRANSFORM &#8220;centroid&#8221;</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only available for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="../_images/geomtrans-centroid.png"><img alt="../_images/geomtrans-centroid.png" src="../_images/geomtrans-centroid.png" style="width: 200px; height: 100px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform centroid</span></p>
</div>
<p>Style definitions for the example.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>STYLE
  GEOMTRANSFORM &quot;centroid&quot;
  COLOR 255 0 0
  SYMBOL circlef
  SIZE 5
END # STYLE
</pre></div>
</div>
<p>Symbol definition for the <cite>circlef</cite> symbol:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>SYMBOL
  NAME &quot;circlef&quot;
  TYPE ellipse
  FILLED true
  POINTS
    1 1
  END # POINTS
END # SYMBOL
</pre></div>
</div>
<span class="target" id="index-3"></span></div>
<div class="section" id="end-and-start">
<span id="index-4"></span><h3><a class="toc-backref" href="#table-of-contents"><cite>end</cite> and <cite>start</cite></a><a class="headerlink" href="#end-and-start" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>GEOMTRANSFORM end</cite> returns the end point of a line.</li>
<li><cite>GEOMTRANSFORM start</cite> returns the start point of a line.<ul>
<li>GEOMTRANSFORM &#8220;start&#8221;</li>
<li>GEOMTRANSFORM &#8220;end&#8221; (since <cite>END</cite> is used to end objects in the
map file, <cite>end</cite> must be embedded in quotes)</li>
</ul>
</li>
</ul>
<p>The direction of the line at the start / end point is available for
rendering effects.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only available for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../_images/geomtrans-startend.png"><img alt="../_images/geomtrans-startend.png" src="../_images/geomtrans-startend.png" style="width: 200px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform start and end usage</span></p>
</div>
<p>Class definitions for the example.</p>
<p>Lower part of the figure:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>CLASS
  STYLE
    GEOMTRANSFORM &quot;start&quot;
    SYMBOL &quot;circlef&quot;
    COLOR 255 0 0
    SIZE 20
  END # STYLE
  STYLE
    COLOR 0 0 0
    WIDTH 4
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;end&quot;
    SYMBOL &quot;circlef&quot;
    COLOR 0 255 0
    SIZE 20
  END # STYLE
END # CLASS
</pre></div>
</div>
<p>Upper part of the figure:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>CLASS
  STYLE
    COLOR 0 0 0
    WIDTH 4
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;start&quot;
    SYMBOL &quot;startarrow&quot;
    COLOR 255 0 0
    SIZE 20
    ANGLE auto
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;start&quot;
    SYMBOL &quot;circlef&quot;
    COLOR 0 0 255
    SIZE 5
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;end&quot;
    SYMBOL &quot;endarrow&quot;
    COLOR 0 255 0
    SIZE 20
    ANGLE auto
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;end&quot;
    SYMBOL &quot;circlef&quot;
    COLOR 0 0 255
    SIZE 5
  END # STYLE
END # CLASS
</pre></div>
</div>
<p>The startarrow symbol definition (endarrow is the same, except for
ANCHORPOINT (value for endarrow: 1 0.5):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>SYMBOL
  NAME &quot;startarrow&quot;
  TYPE vector
  FILLED true
  POINTS
    0 0.4
    3 0.4
    3 0
    5 0.8
    3 1.6
    3 1.2
    0 1.2
    0 0.4
  END # POINTS
  ANCHORPOINT 0 0.5
END # SYMBOL
</pre></div>
</div>
</div>
<div class="section" id="vertices">
<span id="index-5"></span><h3><a class="toc-backref" href="#table-of-contents">vertices</a><a class="headerlink" href="#vertices" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>GEOMTRANSFORM vertices</cite> produces the set of vertices of a line (with
direction information).<ul>
<li>GEOMTRANSFORM &#8220;vertices&#8221;</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only available for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../_images/geomtrans-vertices.png"><img alt="../_images/geomtrans-vertices.png" src="../_images/geomtrans-vertices.png" style="width: 200px; height: 100px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform vertices</span></p>
</div>
<p>Class definitions for the example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>CLASS
  STYLE
    COLOR 0 0 0
    WIDTH 4
  END # STYLE
  STYLE
    GEOMTRANSFORM &quot;vertices&quot;
    SYMBOL &quot;vertline&quot;
    COLOR 0 0 0
    WIDTH 2
    SIZE 20
    ANGLE AUTO
  END # STYLE
END # CLASS
</pre></div>
</div>
<p>The vertline symbol definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>SYMBOL
  NAME &quot;vertline&quot;
  TYPE vector
  POINTS
    0 0
    0 1
  END # POINTS
END # SYMBOL
</pre></div>
</div>
</div>
</div>
<div class="section" id="labels-label-style-only">
<h2><a class="toc-backref" href="#table-of-contents">Labels (<cite>LABEL</cite> <cite>STYLE</cite> only)</a><a class="headerlink" href="#labels-label-style-only" title="Permalink to this headline">¶</a></h2>
<p>The following simple geometry transformations are available at
the <a class="reference internal" href="label.html#label"><span>LABEL</span></a> <a class="reference internal" href="style.html#style"><span>STYLE</span></a> level:</p>
<ul class="simple">
<li>labelpnt</li>
<li>labelpoly</li>
</ul>
<p>These are used for label styling (background colour, background
shadow, background frame).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The result of using <cite>labelpnt</cite> is affected by the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a>
<cite>LABELCACHE</cite> setting.  If <cite>LABELCACHE</cite> is <cite>ON</cite> (the default), the
label will be shifted when a non-zero sized symbol is added using
<cite>labelpnt</cite>.</p>
</div>
<span class="target" id="index-6"></span><div class="section" id="labelpnt-and-labelpoly">
<span id="index-7"></span><h3><a class="toc-backref" href="#table-of-contents">labelpnt and labelpoly</a><a class="headerlink" href="#labelpnt-and-labelpoly" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>GEOMTRANSFORM labelpnt</cite> produces the geographic position the label
is attached to.  This corresponds to the center of the label text
only if the label is in position <cite>CC</cite>.<ul>
<li>GEOMTRANSFORM &#8220;labelpnt&#8221;</li>
</ul>
</li>
<li><cite>GEOMTRANSFORM labelpoly</cite> produces a polygon that covers the label
plus a 1 pixel padding.<ul>
<li>GEOMTRANSFORM &#8220;labelpoly&#8221;</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only available for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the <a class="reference internal" href="label.html#label"><span>LABEL</span></a> context.</p>
</div>
<p>These transformations can be used to make background rectangles for
labels and add symbols to the label points.</p>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../_images/geomtrans-label.png"><img alt="../_images/geomtrans-label.png" src="../_images/geomtrans-label.png" style="width: 200px; height: 100px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform labelpnt and labelpoly</span></p>
</div>
<p>Class definitions for the example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>CLASS
  STYLE
    OUTLINECOLOR 255 255 204
  END # STYLE
  LABEL
    SIZE giant
    POSITION UC
    STYLE # shadow
      GEOMTRANSFORM &quot;labelpoly&quot;
      COLOR 153 153 153
      OFFSET 3 3
    END # Style
    STYLE # background
      GEOMTRANSFORM &quot;labelpoly&quot;
      COLOR 204 255 204
    END # Style
    STYLE # outline
      GEOMTRANSFORM &quot;labelpoly&quot;
      OUTLINECOLOR 0 0 255
      WIDTH 1
    END # Style
    STYLE
      GEOMTRANSFORM &quot;labelpnt&quot;
      SYMBOL &#39;circlef&#39;
      COLOR 255 0 0
      SIZE 15
    END # Style
  END # Label
END # Class
</pre></div>
</div>
<p>Symbol definition for the <cite>circlef</cite> symbol:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>SYMBOL
  NAME &quot;circlef&quot;
  TYPE ellipse
  FILLED true
  POINTS
    1 1
  END # POINTS
END # SYMBOL
</pre></div>
</div>
</div>
</div>
<div class="section" id="expressions-and-advanced-transformations-layer-and-class-style">
<span id="index-8"></span><h2><a class="toc-backref" href="#table-of-contents">Expressions and advanced transformations (<cite>LAYER</cite> and <cite>CLASS</cite> <cite>STYLE</cite>)</a><a class="headerlink" href="#expressions-and-advanced-transformations-layer-and-class-style" title="Permalink to this headline">¶</a></h2>
<div class="section" id="combining-chaining-expressions">
<h3><a class="toc-backref" href="#table-of-contents">Combining / chaining expressions</a><a class="headerlink" href="#combining-chaining-expressions" title="Permalink to this headline">¶</a></h3>
<p>A geometry transformation produces a geometry, and that geometry can
be used as input to another geometry transformation.  There are (at
least) two ways to accomplish this.  One is to combine basic geometry
transformation expressions into more complex geometry transformation
expressions, and another is to combine a geometry transformation
expression at the <cite>LAYER</cite> level with a geometry transformation
expressions or a simple geometry transformation at the <cite>CLASS</cite> <cite>STYLE</cite>
level.</p>
<p><em>Combining geometry transformation expressions</em>
A geometry transformation expression contains a <cite>[shape]</cite> part.  The
<cite>[shape]</cite> part can be replaced by a geometry transformation
expression.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="nb">buffer</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>In this transformation, <cite>buffer</cite> is first applied on the geometry
(<cite>[shape]</cite>).  The resulting geometry is then used as input to
<cite>simplify</cite>.</p>
<p>A style that demonstrates this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>STYLE
  GEOMTRANSFORM (simplify(buffer([shape], 20),10))
  OUTLINECOLOR 255 0 0
  WIDTH 2
END # STYLE
</pre></div>
</div>
<p>The result of this transformation is shown at the top of the following
figure (red line).  The original polygon is shown with a full black
line and the buffer with a dashed black line.</p>
<p><em>Combining expressions with simple geometry transformations</em>
Simple geometry transformations are only available for <cite>CLASS</cite> <cite>STYLE</cite>,
but can be combined with geometry transformation expressions at the
<cite>LAYER</cite> level.</p>
<p>Excerpts from a layer definitions that does this kind of combination:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>LAYER
  ...
  GEOMTRANSFORM (simplify(buffer([shape], 10),5))
  CLASS
    ...
    STYLE
      GEOMTRANSFORM &quot;vertices&quot;
      COLOR 255 102 102
      SYMBOL vertline
      SIZE 20
      WIDTH 2
      ANGLE auto
    END # STYLE
  END # CLASS
END # LAYER
</pre></div>
</div>
<p>The result of this transformation is shown at the bottom of the
following figure (the red lines).  The result of the LAYER level
geomtransform is shown with a full black line.  The original polygon
is the same as the one used at the top of the figure.</p>
<div class="figure align-center" id="id12">
<a class="reference internal image-reference" href="../_images/geomtrans-expressions.png"><img alt="../_images/geomtrans-expressions.png" src="../_images/geomtrans-expressions.png" style="width: 200px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Combining geomtransform expressions</span></p>
</div>
<div class="section" id="buffer">
<span id="index-9"></span><h4><a class="toc-backref" href="#table-of-contents">buffer</a><a class="headerlink" href="#buffer" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><cite>GEOMTRANSFORM buffer</cite> returns the buffer of the original geometry.
The result is always a polygon geometry.<ul>
<li>GEOMTRANSFORM (buffer ([shape], buffersize))</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Negative values for <cite>buffersize</cite> (setback) is not supported.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can be used at the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Buffer does not seem to work for point geometries.</p>
</div>
<div class="figure align-center" id="id13">
<a class="reference internal image-reference" href="../_images/geomtrans-buffer.png"><img alt="../_images/geomtrans-buffer.png" src="../_images/geomtrans-buffer.png" style="width: 200px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform buffer</span></p>
</div>
<p>Some class definitions for the example.</p>
<p>Lower part (polygon with buffers):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>CLASS
  STYLE
    OUTLINECOLOR 0 255 0
    GEOMTRANSFORM (buffer([shape], 20))
    WIDTH 1
  END # STYLE
  STYLE
    OUTLINECOLOR 0 0 255
    GEOMTRANSFORM (buffer([shape], 10))  #
    WIDTH 1
  END # STYLE
  STYLE
    COLOR 255 0 0
    GEOMTRANSFORM (buffer([shape], 5))  #
  END # STYLE
  STYLE
    COLOR 0 0 0
  END # STYLE
END # CLASS
</pre></div>
</div>
<p>Upper right part (layer level geomtransform):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>LAYER  # line buffer layer
  STATUS DEFAULT
  TYPE LINE
  FEATURE
    POINTS
      80 70
      80 75
    END # Points
  END # Feature
  GEOMTRANSFORM (buffer([shape], 10))
  CLASS
    STYLE
      COLOR 0 0 255
    END # STYLE
  END # CLASS
END # LAYER
</pre></div>
</div>
</div>
</div>
<div class="section" id="generalize-shape-tolerance">
<span id="index-10"></span><h3><a class="toc-backref" href="#table-of-contents">generalize ([shape], tolerance)</a><a class="headerlink" href="#generalize-shape-tolerance" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><cite>GEOMTRANSFORM generalize</cite> simplifies a geometry ([shape]) in a way
comparable to FME’s ThinNoPoint algorithm.  See
<a class="reference external" href="http://trac.osgeo.org/gdal/ticket/966">http://trac.osgeo.org/gdal/ticket/966</a> for more information.</p>
<ul class="simple">
<li>GEOMTRANSFORM (generalize([shape], tolerance))</li>
</ul>
<p>tolerance is mandatory, and is a specification of the maximum
deviation allowed for the generalized line compared to the original
line.  A higher value for tolerance will give a more generalised /
simplified line.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can be used at the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Depends on GEOS.</p>
</div>
<p>The figure below shows the result of applying <cite>generalize</cite> at the
<a class="reference internal" href="style.html#style"><span>STYLE</span></a> level with increasing values for tolerance (10 - green,
20 - blue and 40 - red).</p>
<div class="figure align-center" id="id14">
<a class="reference internal image-reference" href="../_images/geomtrans-generalize.png"><img alt="../_images/geomtrans-generalize.png" src="../_images/geomtrans-generalize.png" style="width: 200px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform generalize</span></p>
</div>
<p>One of the <a class="reference internal" href="style.html#style"><span>STYLE</span></a> definitions for the example (tolerance 40):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>STYLE
  GEOMTRANSFORM (generalize([shape], 40))
  COLOR 255 0 0
  WIDTH 1
  PATTERN 3 3 END
END # STYLE
</pre></div>
</div>
</div>
<div class="section" id="simplify-shape-tolerance">
<span id="index-11"></span><h3><a class="toc-backref" href="#table-of-contents">simplify([shape], tolerance)</a><a class="headerlink" href="#simplify-shape-tolerance" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><cite>GEOMTRANSFORM simplify</cite> simplifies a geometry ([shape]) using the
standard Douglas-Peucker algorithm.</p>
<ul class="simple">
<li>GEOMTRANSFORM (simplify([shape], tolerance))</li>
</ul>
<p>tolerance is mandatory, and is a specification of the maximum
deviation allowed for the generalized line compared to the original
line.  A higher value for tolerance will give a more generalised /
simplified line.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can be used at the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<p>The figure below shows the result of applying <cite>simplify</cite> at the
<a class="reference internal" href="style.html#style"><span>STYLE</span></a> level with increasing values for tolerance (10 - green,
20 - blue and 40 - red).</p>
<div class="figure align-center" id="id15">
<a class="reference internal image-reference" href="../_images/geomtrans-simplify.png"><img alt="../_images/geomtrans-simplify.png" src="../_images/geomtrans-simplify.png" style="width: 200px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform simplify</span></p>
</div>
<p>One of the <a class="reference internal" href="style.html#style"><span>STYLE</span></a> definitions for the example (tolerance 40):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>STYLE
  GEOMTRANSFORM (simplify([shape], 40))
  COLOR 255 0 0
  WIDTH 1
  PATTERN 3 3 END
END # STYLE
</pre></div>
</div>
</div>
<div class="section" id="simplifypt-shape-tolerance">
<span id="index-12"></span><h3><a class="toc-backref" href="#table-of-contents">simplifypt([shape], tolerance)</a><a class="headerlink" href="#simplifypt-shape-tolerance" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><cite>GEOMTRANSFORM simplifypt</cite> simplifies a geometry ([shape]), ensuring
that the result is a valid geometry having the same dimension and
number of components as the input.  <cite>tolerance</cite> must be
non-negative.</p>
<ul class="simple">
<li>GEOMTRANSFORM (simplifypt([shape], tolerance))</li>
</ul>
<p>tolerance is mandatory, and is a specification of the maximum
deviation allowed for the generalized line compared to the original
line.  A higher value for tolerance will give a more generalised /
simplified line.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can be used at the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<p>The figure below shows the result of applying <cite>simplifypt</cite> at the
<a class="reference internal" href="style.html#style"><span>STYLE</span></a> level with increasing values for tolerance (10 - green,
20 - blue and 40 - red).</p>
<div class="figure align-center" id="id16">
<a class="reference internal image-reference" href="../_images/geomtrans-simplifypt.png"><img alt="../_images/geomtrans-simplifypt.png" src="../_images/geomtrans-simplifypt.png" style="width: 200px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Geomtransform simplifypt</span></p>
</div>
<p>One of the <a class="reference internal" href="style.html#style"><span>STYLE</span></a> definitions for the example (tolerance 40):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>STYLE
   GEOMTRANSFORM (simplifypt([shape], 40))
   COLOR 255 0 0
   WIDTH 1
   PATTERN 3 3 END
 END # STYLE
</pre></div>
</div>
<span class="target" id="index-13"></span><span class="target" id="index-14"></span></div>
<div class="section" id="smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing">
<span id="index-15"></span><h3><a class="toc-backref" href="#table-of-contents">smoothsia ( [shape], smoothing_size, smoothing_iterations, preprocessing )</a><a class="headerlink" href="#smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><cite>GEOMTRANSFORM smoothsia</cite> returns a smoothed version of a line.</p>
<ul class="simple">
<li>GEOMTRANSFORM (smoothsia ( [shape], smoothing_size,
smoothing_iterations, preprocessing ))</li>
</ul>
<p>The following parameters are used:</p>
<ul class="simple">
<li><em>shape</em> (mandatory).
Specify the geometry to be used</li>
<li><em>smoothing_size</em> (optional).
The window size (number of points) used by the algorithm.  The
default is 3.</li>
<li><em>smoothing_iterations</em> (optional).
The number of iterations of the algorithm. The default is 1.</li>
<li><em>preprocessing</em> (optional).
Preprocessing method to add more vertices to the geometry prior to
smoothing, described below.  There are two possible preprocessing
methods:<ul>
<li><em>all</em> Adds two intermediate vertices on each side of each original
vertex.  This is useful to preserve the general shape of the line
with low resolution data.</li>
<li><em>angle</em> Add vertices at some specific places based on angle
detection.</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Can be used at the <a class="reference internal" href="layer.html#layer"><span>LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span>STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span>CLASS</span></a> context.</p>
</div>
<p>Example of a simple layer definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>LAYER NAME &quot;my_layer&quot;
TYPE LINE
STATUS DEFAULT
DATA roads.shp
GEOMTRANSFORM (smoothsia([shape], 3, 1, &#39;angle&#39;))
CLASS
  STYLE
    WIDTH 2
    COLOR 255 0 0
  END
END
</pre></div>
</div>
<p>Here are some examples showing results with different parameter
values.</p>
<div class="figure align-center" id="id17">
<a class="reference internal image-reference" href="../_images/smoothing11.png"><img alt="../_images/smoothing11.png" src="../_images/smoothing11.png" style="width: 400px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Original geometry (left) and smoothsia with default parameters
(right)</span></p>
</div>
<div class="figure align-center" id="id18">
<a class="reference internal image-reference" href="../_images/smoothing21.png"><img alt="../_images/smoothing21.png" src="../_images/smoothing21.png" style="width: 400px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Smoothsia - Larger window size (left) and larger window size with
more iterations (right)</span></p>
</div>
<div class="section" id="tuning-the-behaviour-of-smoothsia">
<h4><a class="toc-backref" href="#table-of-contents">Tuning the behaviour of smoothsia</a><a class="headerlink" href="#tuning-the-behaviour-of-smoothsia" title="Permalink to this headline">¶</a></h4>
<p>smoothsia has several parameters that can be used to tune its
behaviour.  The following sections describe some cases / possibilities.</p>
</div>
<div class="section" id="dataset-resolution-is-too-high">
<h4><a class="toc-backref" href="#table-of-contents">Dataset resolution is too high</a><a class="headerlink" href="#dataset-resolution-is-too-high" title="Permalink to this headline">¶</a></h4>
<p>If you are trying to smooth a line that has a very high resolution
(high density of vertices at the current view scale), you may not get
the expected result because the vertices are too dense for the
smoothing window size.  In this case you might want to simplify the
geometries before the smoothing.  You can combine smoothing and
simplification in a single geomtransform for that:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">smoothsia</span><span class="p">(</span><span class="n">simplifypt</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">10</span><span class="p">)))</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../development/rfc/ms-rfc-89.html#rfc89"><span>RFC 89: Layer Geomtransform</span></a> for more info. Here&#8217;s a
visualization of the issue:</p>
<div class="figure align-center" id="id19">
<a class="reference internal image-reference" href="../_images/smoothing_highres1.png"><img alt="../_images/smoothing_highres1.png" src="../_images/smoothing_highres1.png" style="width: 600px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">High resolution geometry, smoothing and simplification</span></p>
</div>
</div>
<div class="section" id="dataset-resolution-is-too-low">
<h4><a class="toc-backref" href="#table-of-contents">Dataset resolution is too low</a><a class="headerlink" href="#dataset-resolution-is-too-low" title="Permalink to this headline">¶</a></h4>
<p>If you are trying to smooth a long line that has a low density of
vertices, you may not get the expected result in some situations.  You
may lose some important parts of the geometry during the smoothing,
for instance around acute angles.  You can improve the result by
enabling a preprocessing step to add intermediate vertices along the
line prior to smoothing.</p>
<p>This behavior is controlled using the <cite>all</cite> value in the preprocessing
argument of the <cite>smoothsia</cite> geomtransform:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">smoothsia</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This preprocessing will be performed before the smoothing.  It adds 2
intermediate vertices on each side of each original vertex. This is
useful if we really need to preserve the general shape of the low
resolution line.  Note that this might have an impact on the rendering
since there will be more vertices in the output.</p>
<p>Here&#8217;s a visualization of the issue:</p>
<div class="figure align-center" id="id20">
<a class="reference internal image-reference" href="../_images/smoothing_lowres1.png"><img alt="../_images/smoothing_lowres1.png" src="../_images/smoothing_lowres1.png" style="width: 600px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Effects of normal smoothing and preprocessing</span></p>
</div>
</div>
<div class="section" id="curves">
<h4><a class="toc-backref" href="#table-of-contents">Curves</a><a class="headerlink" href="#curves" title="Permalink to this headline">¶</a></h4>
<p>The preprocessing step might not be appropriate for all cases since it
can impact the smoothing result significantly.  However, without it,
you might notice bad smoothing for curved lines with large distances
between the line vertices. See this example:</p>
<div class="figure align-center" id="id21">
<a class="reference internal image-reference" href="../_images/smoothing_curve11.png"><img alt="../_images/smoothing_curve11.png" src="../_images/smoothing_curve11.png" style="width: 400px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Effects of normal smoothing (without preprocessing)</span></p>
</div>
<p>You can improve that by enabling another type of preprocessing:
<cite>angle</cite>. This one will add points at some specific places based on
angle detection to recognize the curves. Here&#8217;s how you can enable it:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">smoothsia</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="figure align-center" id="id22">
<a class="reference internal image-reference" href="../_images/smoothing_curve21.png"><img alt="../_images/smoothing_curve21.png" src="../_images/smoothing_curve21.png" style="width: 400px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">The use of <cite>angle</cite> with smoothsia</span></p>
</div>
</div>
</div>
</div>
<div class="section" id="javascript-transformation">
<span id="geomtransformjs"></span><span id="index-16"></span><h2><a class="toc-backref" href="#table-of-contents">Javascript transformation</a><a class="headerlink" href="#javascript-transformation" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Alan Boudreault</td>
</tr>
<tr class="field-even field"><th class="field-name">Contact:</th><td class="field-body">aboudreault at mapgears.com</td>
</tr>
<tr class="field-odd field"><th class="field-name">Last Updated:</th><td class="field-body">2013/16/12</td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h3><a class="toc-backref" href="#table-of-contents">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>Using <cite>GEOMTRANSFORM</cite> this way makes it possible to modify the geometry
programmatically in addition to the built-in geomtransform functions.</p>
</div>
<div class="section" id="usage">
<h3><a class="toc-backref" href="#table-of-contents">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>Simply declare the javascript plugin this way:</p>
<div class="highlight-mapfile"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="p">...</span>
  <span class="k">LAYER</span>
  <span class="p">...</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;javascript://transform.js&quot;</span> <span class="c"># relative path</span>
    <span class="k">CLASS</span>
    <span class="k">END</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<p>The path can also be absolute.</p>
<div class="highlight-mapfile"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="p">...</span>
  <span class="k">LAYER</span>
  <span class="p">...</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;javascript:///home/user/transform.js&quot;</span> <span class="c"># absolute path</span>
    <span class="k">CLASS</span>
    <span class="k">END</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<p>The javascript plugin has to implement a function named
<strong>geomtransform</strong> that will be automatically called.  This function
has to return a new shape.  Note that <em>only</em> the geometry of this new
shape will be used, so your original shape attributes will be
preserved.</p>
<p>Access to the feature attributes is made through the
<code class="docutils literal"><span class="pre">shape.attributes</span></code> javascript object.</p>
<p>The following javascript functions are available:</p>
<ul>
<li><dl class="first docutils">
<dt>alert(str1, str2, ..., str)</dt>
<dd><p class="first last">print some text in MapServer logs</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>print(str1, str2, ..., str)</dt>
<dd><p class="first last">print some text in MapServer logs</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>require(path_to_lib1, path_to_lib2, ..., path_to_lib)</dt>
<dd><p class="first last">include one or more javascript lib</p>
</dd>
</dl>
</li>
</ul>
<div class="section" id="example-1-simple-geomtransform">
<h4><a class="toc-backref" href="#table-of-contents">Example 1. Simple Geomtransform</a><a class="headerlink" href="#example-1-simple-geomtransform" title="Permalink to this headline">¶</a></h4>
<p>This example does a simple vertical translation ...</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">geomtransform</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">new_shape</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">shapeObj</span><span class="p">();</span>
  <span class="nx">new_shape</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">lineObj</span><span class="p">());</span>
  <span class="nx">new_point</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pointObj</span><span class="p">();</span>
  <span class="nx">new_point</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">x</span><span class="p">;</span>
  <span class="nx">new_point</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">y</span><span class="o">+</span><span class="mi">30000</span><span class="p">;</span>
  <span class="nx">new_shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">new_point</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">new_shape</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2-printing-logs-in-mapserver-logs">
<h4><a class="toc-backref" href="#table-of-contents">Example 2. Printing logs in MapServer logs</a><a class="headerlink" href="#example-2-printing-logs-in-mapserver-logs" title="Permalink to this headline">¶</a></h4>
<p>Extends example 1 by printing information to the MapServer log.</p>
<div class="highlight-mapfile"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="p">...</span>
  <span class="k">CONFIG</span>  <span class="s">&quot;MS_ERRORFILE&quot;</span> <span class="s">&quot;/tmp/mapserver.log&quot;</span>
  <span class="k">DEBUG</span> <span class="mi">1</span>
  <span class="k">LAYER</span>
  <span class="p">...</span>
     <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;javascript://transform.js&quot;</span>
  <span class="p">...</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">geomtransform</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">new_shape</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">shapeObj</span><span class="p">();</span>
  <span class="nx">new_shape</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">lineObj</span><span class="p">());</span>
  <span class="nx">new_point</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">pointObj</span><span class="p">();</span>
  <span class="nx">new_point</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">x</span><span class="p">;</span>
  <span class="nx">new_point</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">y</span><span class="o">+</span><span class="mi">30000</span><span class="p">;</span>
  <span class="nx">print</span><span class="p">(</span><span class="s1">&#39;Modified y value from: &#39;</span> <span class="o">+</span> <span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">y</span> <span class="o">+</span> <span class="s1">&#39; to: &#39;</span><span class="o">+</span><span class="nx">new_point</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
  <span class="nx">new_shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">new_point</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">new_shape</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="basic-api">
<h3><a class="toc-backref" href="#table-of-contents">Basic API</a><a class="headerlink" href="#basic-api" title="Permalink to this headline">¶</a></h3>
<p>A minimal API is currently available to create a new shape.</p>
<div class="section" id="pointobj">
<h4><a class="toc-backref" href="#table-of-contents">pointObj</a><a class="headerlink" href="#pointobj" title="Permalink to this headline">¶</a></h4>
<div class="section" id="constructor">
<h5><a class="toc-backref" href="#table-of-contents">Constructor</a><a class="headerlink" href="#constructor" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">new</span> <span class="nx">pointObj</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="members">
<h5><a class="toc-backref" href="#table-of-contents">Members</a><a class="headerlink" href="#members" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="14%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Name</th>
<th class="head">Note</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>double</td>
<td>x</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>y</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>double</td>
<td>z</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>double</td>
<td>m</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="methods">
<h5><a class="toc-backref" href="#table-of-contents">Methods</a><a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt>void setXY(double x, double y[, double m])</dt>
<dd>Set the x,y[,m] values.</dd>
<dt>void setXYZ(double x, double y, double Z[, double m])</dt>
<dd>Set the x,y,z[,m] values.</dd>
</dl>
</div>
</div>
<div class="section" id="lineobj">
<h4><a class="toc-backref" href="#table-of-contents">lineObj</a><a class="headerlink" href="#lineobj" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id1">
<h5><a class="toc-backref" href="#table-of-contents">Constructor</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">new</span> <span class="nx">lineObj</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5><a class="toc-backref" href="#table-of-contents">Members</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="14%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Name</th>
<th class="head">Note</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>int</td>
<td>numpoints</td>
<td>read-only</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h5><a class="toc-backref" href="#table-of-contents">Methods</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt>pointObj point(int index)</dt>
<dd>Returns the point at the <cite>index</cite> position.</dd>
<dt>void add(pointObj point)</dt>
<dd>Add a point to the line.</dd>
<dt>void addXY(double x, double y[, double m])</dt>
<dd>Add point to the line from an x,y[,m] values.</dd>
<dt>void addXYZ(double x, double y, double Z[, double m])</dt>
<dd>Add point to the line from an x,y,z[,m] values.</dd>
</dl>
</div>
</div>
<div class="section" id="shapeobj">
<h4><a class="toc-backref" href="#table-of-contents">shapeObj</a><a class="headerlink" href="#shapeobj" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id4">
<h5><a class="toc-backref" href="#table-of-contents">Constructor</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">new</span> <span class="nx">shapeObj</span><span class="p">(</span><span class="kr">int</span> <span class="nx">type</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;type&#8217; is one of shapeObj.Point, shapeObj.Line, shapeObj.Polygon or
shapeObj.Null</p>
</div>
<div class="section" id="id5">
<h5><a class="toc-backref" href="#table-of-contents">Members</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="14%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Name</th>
<th class="head">Note</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>int</td>
<td>numvalues</td>
<td>read-only</td>
</tr>
<tr class="row-odd"><td>int</td>
<td>numlines</td>
<td>read-only</td>
</tr>
<tr class="row-even"><td>int</td>
<td>index</td>
<td>read-only</td>
</tr>
<tr class="row-odd"><td>int</td>
<td>type</td>
<td>read-only</td>
</tr>
<tr class="row-even"><td>int</td>
<td>tileindex</td>
<td>read-only</td>
</tr>
<tr class="row-odd"><td>int</td>
<td>classindex</td>
<td>read-only</td>
</tr>
<tr class="row-even"><td>text</td>
<td>text</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>object</td>
<td>attributes</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id6">
<h5><a class="toc-backref" href="#table-of-contents">Methods</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt>shapeObj clone()</dt>
<dd>Returns a clone of the shape.</dd>
<dt>lineObj line(int index)</dt>
<dd>Returns the line at the <cite>index</cite> position.</dd>
<dt>void add(lineObj line)</dt>
<dd>Add a line to the shape.</dd>
<dt>void setGeometry(shapeObj shape)</dt>
<dd>Replace the geometry of the object with the <cite>shape</cite> geometry.</dd>
</dl>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a>
</p>
  <h3>Current Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">GEOMTRANSFORM - Geometry Transformations</a><ul>
<li><a class="reference internal" href="#transformations-for-simple-styling-class-style-only">Transformations for simple styling (<cite>CLASS</cite> <cite>STYLE</cite> only)</a><ul>
<li><a class="reference internal" href="#bbox">bbox</a></li>
<li><a class="reference internal" href="#centroid">centroid</a></li>
<li><a class="reference internal" href="#end-and-start"><cite>end</cite> and <cite>start</cite></a></li>
<li><a class="reference internal" href="#vertices">vertices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#labels-label-style-only">Labels (<cite>LABEL</cite> <cite>STYLE</cite> only)</a><ul>
<li><a class="reference internal" href="#labelpnt-and-labelpoly">labelpnt and labelpoly</a></li>
</ul>
</li>
<li><a class="reference internal" href="#expressions-and-advanced-transformations-layer-and-class-style">Expressions and advanced transformations (<cite>LAYER</cite> and <cite>CLASS</cite> <cite>STYLE</cite>)</a><ul>
<li><a class="reference internal" href="#combining-chaining-expressions">Combining / chaining expressions</a><ul>
<li><a class="reference internal" href="#buffer">buffer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generalize-shape-tolerance">generalize ([shape], tolerance)</a></li>
<li><a class="reference internal" href="#simplify-shape-tolerance">simplify([shape], tolerance)</a></li>
<li><a class="reference internal" href="#simplifypt-shape-tolerance">simplifypt([shape], tolerance)</a></li>
<li><a class="reference internal" href="#smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing">smoothsia ( [shape], smoothing_size, smoothing_iterations, preprocessing )</a><ul>
<li><a class="reference internal" href="#tuning-the-behaviour-of-smoothsia">Tuning the behaviour of smoothsia</a></li>
<li><a class="reference internal" href="#dataset-resolution-is-too-high">Dataset resolution is too high</a></li>
<li><a class="reference internal" href="#dataset-resolution-is-too-low">Dataset resolution is too low</a></li>
<li><a class="reference internal" href="#curves">Curves</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#javascript-transformation">Javascript transformation</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#example-1-simple-geomtransform">Example 1. Simple Geomtransform</a></li>
<li><a class="reference internal" href="#example-2-printing-logs-in-mapserver-logs">Example 2. Printing logs in MapServer logs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-api">Basic API</a><ul>
<li><a class="reference internal" href="#pointobj">pointObj</a><ul>
<li><a class="reference internal" href="#constructor">Constructor</a></li>
<li><a class="reference internal" href="#members">Members</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lineobj">lineObj</a><ul>
<li><a class="reference internal" href="#id1">Constructor</a></li>
<li><a class="reference internal" href="#id2">Members</a></li>
<li><a class="reference internal" href="#id3">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shapeobj">shapeObj</a><ul>
<li><a class="reference internal" href="#id4">Constructor</a></li>
<li><a class="reference internal" href="#id5">Members</a></li>
<li><a class="reference internal" href="#id6">Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Open Source Geospatial Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
    </div>

    

    
  </body>
</html>