<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GEOMTRANSFORM - Geometry Transformations &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="GRID" href="grid.html" />
    <link rel="prev" title="FONTSET" href="fontset.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../ar/mapfile/geomtransform.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../de/mapfile/geomtransform.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../el/mapfile/geomtransform.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../es/mapfile/geomtransform.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../fr/mapfile/geomtransform.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../id/mapfile/geomtransform.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../it/mapfile/geomtransform.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../ja/mapfile/geomtransform.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../nl_NL/mapfile/geomtransform.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../pl/mapfile/geomtransform.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../ru/mapfile/geomtransform.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../sq/mapfile/geomtransform.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../tr/mapfile/geomtransform.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="grid.html" title="GRID"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fontset.html" title="FONTSET"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Mapfile</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">GEOMTRANSFORM - Geometry Transformations</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="geomtransform-geometry-transformations">
<span id="geomtransform"></span><span id="index-0"></span><h1>GEOMTRANSFORM - Geometry Transformations<a class="headerlink" href="#geomtransform-geometry-transformations" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Håvard Tveite</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Jeff McKenna</p>
</dd>
<dt class="field-odd">Contact<span class="colon">:</span></dt>
<dd class="field-odd"><p>jmckenna at gatewaygeomatics.com</p>
</dd>
<dt class="field-even">Last Updated<span class="colon">:</span></dt>
<dd class="field-even"><p>2022-08-14</p>
</dd>
</dl>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#transformations-for-simple-styling-class-style-only" id="id23">Transformations for simple styling (<cite>CLASS</cite> <cite>STYLE</cite> only)</a></p>
<ul>
<li><p><a class="reference internal" href="#bbox" id="id24">bbox</a></p></li>
<li><p><a class="reference internal" href="#centroid" id="id25">centroid</a></p></li>
<li><p><a class="reference internal" href="#end-and-start" id="id26"><cite>end</cite> and <cite>start</cite></a></p></li>
<li><p><a class="reference internal" href="#vertices" id="id27">vertices</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#labels-label-style-only" id="id28">Labels (<cite>LABEL</cite> <cite>STYLE</cite> only)</a></p>
<ul>
<li><p><a class="reference internal" href="#labelpnt-and-labelpoly" id="id29">labelpnt and labelpoly</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#expressions-and-advanced-transformations-layer-and-class-style" id="id30">Expressions and advanced transformations (<cite>LAYER</cite> and <cite>CLASS</cite> <cite>STYLE</cite>)</a></p>
<ul>
<li><p><a class="reference internal" href="#combining-chaining-expressions" id="id31">Combining / chaining expressions</a></p></li>
<li><p><a class="reference internal" href="#buffer" id="id32">buffer</a></p></li>
<li><p><a class="reference internal" href="#centerline" id="id33">centerline</a></p></li>
<li><p><a class="reference internal" href="#densify" id="id34">densify</a></p></li>
<li><p><a class="reference internal" href="#generalize-shape-tolerance" id="id35">generalize ([shape], tolerance)</a></p></li>
<li><p><a class="reference internal" href="#inner" id="id36">inner</a></p></li>
<li><p><a class="reference internal" href="#simplify-shape-tolerance" id="id37">simplify([shape], tolerance)</a></p></li>
<li><p><a class="reference internal" href="#simplifypt-shape-tolerance" id="id38">simplifypt([shape], tolerance)</a></p></li>
<li><p><a class="reference internal" href="#smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing" id="id39">smoothsia ( [shape], smoothing_size, smoothing_iterations, preprocessing )</a></p>
<ul>
<li><p><a class="reference internal" href="#tuning-the-behaviour-of-smoothsia" id="id40">Tuning the behaviour of smoothsia</a></p></li>
<li><p><a class="reference internal" href="#dataset-resolution-is-too-high" id="id41">Dataset resolution is too high</a></p></li>
<li><p><a class="reference internal" href="#dataset-resolution-is-too-low" id="id42">Dataset resolution is too low</a></p></li>
<li><p><a class="reference internal" href="#curves" id="id43">Curves</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#outer" id="id44">outer</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#javascript-transformation" id="id45">Javascript transformation</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id46">Introduction</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id47">Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-simple-geomtransform" id="id48">Example 1. Simple Geomtransform</a></p></li>
<li><p><a class="reference internal" href="#example-2-printing-logs-in-mapserver-logs" id="id49">Example 2. Printing logs in MapServer logs</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#basic-api" id="id50">Basic API</a></p>
<ul>
<li><p><a class="reference internal" href="#pointobj" id="id51">pointObj</a></p>
<ul>
<li><p><a class="reference internal" href="#constructor" id="id52">Constructor</a></p></li>
<li><p><a class="reference internal" href="#members" id="id53">Members</a></p></li>
<li><p><a class="reference internal" href="#methods" id="id54">Methods</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#lineobj" id="id55">lineObj</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id56">Constructor</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id57">Members</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id58">Methods</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#shapeobj" id="id59">shapeObj</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id60">Constructor</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id61">Members</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id62">Methods</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<p>Geometry transformations return a new geometry.
The purpose of a geometry transformation can be to achieve special
effects for symbol rendering and labeling.</p>
<p>Geometry transformation is available at the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level and the
<a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> level.  At the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level (since MapServer 6.4), the
original vector geometry (“real world” coordinates) is used.  At the
<a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> level (since MapServer 6.0), pixel coordinates are used.</p>
<p>It may be useful to apply pixel values also at the <cite>LAYER</cite> level, and
that is possible.  If <cite>UNITS</cite> is defined in the <cite>LAYER</cite>, the
[map_cellsize] variable can be used to convert to pixel values at the
<cite>LAYER</cite> level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">simplify</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="p">[</span><span class="n">map_cellsize</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<section id="transformations-for-simple-styling-class-style-only">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Transformations for simple styling (<cite>CLASS</cite> <cite>STYLE</cite> only)</a><a class="headerlink" href="#transformations-for-simple-styling-class-style-only" title="Link to this heading">¶</a></h2>
<p>The following simple geometry transformations are available at
the <cite>CLASS</cite> <cite>STYLE</cite> level:</p>
<ul class="simple">
<li><p>bbox</p></li>
<li><p>centroid</p></li>
<li><p>end</p></li>
<li><p>start</p></li>
<li><p>vertices</p></li>
</ul>
<section id="bbox">
<span id="index-1"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">bbox</a><a class="headerlink" href="#bbox" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>GEOMTRANSFORM bbox</cite> returns the bounding box of the geometry.</p>
<ul>
<li><p>GEOMTRANSFORM “bbox”</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only available for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<figure class="align-center" id="id7">
<img alt="../_images/geomtrans-bbox.png" class="no-scaled-link" src="../_images/geomtrans-bbox.png" style="width: 200px; height: 100px;" />
<figcaption>
<p><span class="caption-text">Geomtransform bbox</span><a class="headerlink" href="#id7" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Class definitions for the example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">WIDTH</span> <span class="mi">6</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;bbox&quot;</span>
    <span class="k">OUTLINECOLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">WIDTH</span> <span class="mi">1</span>
    <span class="k">PATTERN</span> <span class="mi">1</span> <span class="mi">2</span> <span class="k">END</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
<span class="k">END</span> <span class="c"># CLASS</span>
</pre></div>
</div>
</section>
<section id="centroid">
<span id="index-2"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">centroid</a><a class="headerlink" href="#centroid" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>GEOMTRANSFORM centroid</cite> returns the centroid of the geometry.</p>
<ul>
<li><p>GEOMTRANSFORM “centroid”</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only available for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<figure class="align-center" id="id8">
<img alt="../_images/geomtrans-centroid.png" class="no-scaled-link" src="../_images/geomtrans-centroid.png" style="width: 200px; height: 100px;" />
<figcaption>
<p><span class="caption-text">Geomtransform centroid</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Style definitions for the example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">STYLE</span>
  <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;centroid&quot;</span>
  <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
  <span class="k">SYMBOL</span> <span class="err">circlef</span>
  <span class="k">SIZE</span> <span class="mi">5</span>
<span class="k">END</span> <span class="c"># STYLE</span>
</pre></div>
</div>
<p>Symbol definition for the <cite>circlef</cite> symbol:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">SYMBOL</span>
  <span class="k">NAME</span> <span class="s">&quot;circlef&quot;</span>
  <span class="k">TYPE</span> <span class="nb">ellipse</span>
  <span class="k">FILLED</span> <span class="nb">true</span>
  <span class="k">POINTS</span>
    <span class="mi">1</span> <span class="mi">1</span>
  <span class="k">END</span> <span class="c"># POINTS</span>
<span class="k">END</span> <span class="c"># SYMBOL</span>
</pre></div>
</div>
</section>
<section id="end-and-start">
<span id="index-4"></span><span id="index-3"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink"><cite>end</cite> and <cite>start</cite></a><a class="headerlink" href="#end-and-start" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>GEOMTRANSFORM end</cite> returns the end point of a line.</p></li>
<li><p><cite>GEOMTRANSFORM start</cite> returns the start point of a line.</p>
<ul>
<li><p>GEOMTRANSFORM “start”</p></li>
<li><p>GEOMTRANSFORM “end” (since <cite>END</cite> is used to end objects in the
map file, <cite>end</cite> must be embedded in quotes)</p></li>
</ul>
</li>
</ul>
<p>The direction of the line at the start / end point is available for
rendering effects.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only available for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<figure class="align-center" id="id9">
<img alt="../_images/geomtrans-startend.png" class="no-scaled-link" src="../_images/geomtrans-startend.png" style="width: 200px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Geomtransform start and end usage</span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Class definitions for the example.</p>
<p>Lower part of the figure:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;start&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;circlef&quot;</span>
    <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">SIZE</span> <span class="mi">20</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">WIDTH</span> <span class="mi">4</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;end&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;circlef&quot;</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">255</span> <span class="mi">0</span>
    <span class="k">SIZE</span> <span class="mi">20</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
<span class="k">END</span> <span class="c"># CLASS</span>
</pre></div>
</div>
<p>Upper part of the figure:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">WIDTH</span> <span class="mi">4</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;start&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;startarrow&quot;</span>
    <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">SIZE</span> <span class="mi">20</span>
    <span class="k">ANGLE</span> <span class="nb">auto</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;start&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;circlef&quot;</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">255</span>
    <span class="k">SIZE</span> <span class="mi">5</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;end&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;endarrow&quot;</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">255</span> <span class="mi">0</span>
    <span class="k">SIZE</span> <span class="mi">20</span>
    <span class="k">ANGLE</span> <span class="nb">auto</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;end&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;circlef&quot;</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">255</span>
    <span class="k">SIZE</span> <span class="mi">5</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
<span class="k">END</span> <span class="c"># CLASS</span>
</pre></div>
</div>
<p>The startarrow symbol definition (endarrow is the same, except for
ANCHORPOINT (value for endarrow: 1 0.5):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">SYMBOL</span>
  <span class="k">NAME</span> <span class="s">&quot;startarrow&quot;</span>
  <span class="k">TYPE</span> <span class="nb">vector</span>
  <span class="k">FILLED</span> <span class="nb">true</span>
  <span class="k">POINTS</span>
    <span class="mi">0</span> <span class="mf">0.4</span>
    <span class="mi">3</span> <span class="mf">0.4</span>
    <span class="mi">3</span> <span class="mi">0</span>
    <span class="mi">5</span> <span class="mf">0.8</span>
    <span class="mi">3</span> <span class="mf">1.6</span>
    <span class="mi">3</span> <span class="mf">1.2</span>
    <span class="mi">0</span> <span class="mf">1.2</span>
    <span class="mi">0</span> <span class="mf">0.4</span>
  <span class="k">END</span> <span class="c"># POINTS</span>
  <span class="k">ANCHORPOINT</span> <span class="mi">0</span> <span class="mf">0.5</span>
<span class="k">END</span> <span class="c"># SYMBOL</span>
</pre></div>
</div>
</section>
<section id="vertices">
<span id="index-5"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">vertices</a><a class="headerlink" href="#vertices" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>GEOMTRANSFORM vertices</cite> produces the set of vertices of a line (with
direction information).</p>
<ul>
<li><p>GEOMTRANSFORM “vertices”</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only available for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the <a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<figure class="align-center" id="id10">
<img alt="../_images/geomtrans-vertices.png" class="no-scaled-link" src="../_images/geomtrans-vertices.png" style="width: 200px; height: 100px;" />
<figcaption>
<p><span class="caption-text">Geomtransform vertices</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Class definitions for the example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">WIDTH</span> <span class="mi">4</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;vertices&quot;</span>
    <span class="k">SYMBOL</span> <span class="s">&quot;vertline&quot;</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">WIDTH</span> <span class="mi">2</span>
    <span class="k">SIZE</span> <span class="mi">20</span>
    <span class="k">ANGLE</span> <span class="nb">AUTO</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
<span class="k">END</span> <span class="c"># CLASS</span>
</pre></div>
</div>
<p>The vertline symbol definition:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">SYMBOL</span>
  <span class="k">NAME</span> <span class="s">&quot;vertline&quot;</span>
  <span class="k">TYPE</span> <span class="nb">vector</span>
  <span class="k">POINTS</span>
    <span class="mi">0</span> <span class="mi">0</span>
    <span class="mi">0</span> <span class="mi">1</span>
  <span class="k">END</span> <span class="c"># POINTS</span>
<span class="k">END</span> <span class="c"># SYMBOL</span>
</pre></div>
</div>
</section>
</section>
<section id="labels-label-style-only">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Labels (<cite>LABEL</cite> <cite>STYLE</cite> only)</a><a class="headerlink" href="#labels-label-style-only" title="Link to this heading">¶</a></h2>
<p>The following simple geometry transformations are available at
the <a class="reference internal" href="label.html#label"><span class="std std-ref">LABEL</span></a> <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> level:</p>
<ul class="simple">
<li><p>labelpnt</p></li>
<li><p>labelpoly</p></li>
</ul>
<p>These are used for label styling (background colour, background
shadow, background frame).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The result of using <cite>labelpnt</cite> is affected by the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a>
<cite>LABELCACHE</cite> setting.  If <cite>LABELCACHE</cite> is <cite>ON</cite> (the default), the
label will be shifted when a non-zero sized symbol is added using
<cite>labelpnt</cite>.</p>
</div>
<section id="labelpnt-and-labelpoly">
<span id="index-7"></span><span id="index-6"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">labelpnt and labelpoly</a><a class="headerlink" href="#labelpnt-and-labelpoly" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>GEOMTRANSFORM labelpnt</cite> produces the geographic position the label
is attached to.  This corresponds to the center of the label text
only if the label is in position <cite>CC</cite>.</p>
<ul>
<li><p>GEOMTRANSFORM “labelpnt”</p></li>
</ul>
</li>
<li><p><cite>GEOMTRANSFORM labelpoly</cite> produces a polygon that covers the label
plus a 1 pixel padding.</p>
<ul>
<li><p>GEOMTRANSFORM “labelpoly”</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only available for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the <a class="reference internal" href="label.html#label"><span class="std std-ref">LABEL</span></a> context.</p>
</div>
<p>These transformations can be used to make background rectangles for
labels and add symbols to the label points.</p>
<figure class="align-center" id="id11">
<img alt="../_images/geomtrans-label.png" class="no-scaled-link" src="../_images/geomtrans-label.png" style="width: 200px; height: 100px;" />
<figcaption>
<p><span class="caption-text">Geomtransform labelpnt and labelpoly</span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Class definitions for the example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">OUTLINECOLOR</span> <span class="mi">255</span> <span class="mi">255</span> <span class="mi">204</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">LABEL</span>
    <span class="k">SIZE</span> <span class="nb">giant</span>
    <span class="k">POSITION</span> <span class="nb">UC</span>
    <span class="k">STYLE</span> <span class="c"># shadow</span>
      <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;labelpoly&quot;</span>
      <span class="k">COLOR</span> <span class="mi">153</span> <span class="mi">153</span> <span class="mi">153</span>
      <span class="k">OFFSET</span> <span class="mi">3</span> <span class="mi">3</span>
    <span class="k">END</span> <span class="c"># Style</span>
    <span class="k">STYLE</span> <span class="c"># background</span>
      <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;labelpoly&quot;</span>
      <span class="k">COLOR</span> <span class="mi">204</span> <span class="mi">255</span> <span class="mi">204</span>
    <span class="k">END</span> <span class="c"># Style</span>
    <span class="k">STYLE</span> <span class="c"># outline</span>
      <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;labelpoly&quot;</span>
      <span class="k">OUTLINECOLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">255</span>
      <span class="k">WIDTH</span> <span class="mi">1</span>
    <span class="k">END</span> <span class="c"># Style</span>
    <span class="k">STYLE</span>
      <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;labelpnt&quot;</span>
      <span class="k">SYMBOL</span> <span class="s">&#39;circlef&#39;</span>
      <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
      <span class="k">SIZE</span> <span class="mi">15</span>
    <span class="k">END</span> <span class="c"># Style</span>
  <span class="k">END</span> <span class="c"># Label</span>
<span class="k">END</span> <span class="c"># Class</span>
</pre></div>
</div>
<p>Symbol definition for the <cite>circlef</cite> symbol:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">SYMBOL</span>
  <span class="k">NAME</span> <span class="s">&quot;circlef&quot;</span>
  <span class="k">TYPE</span> <span class="nb">ellipse</span>
  <span class="k">FILLED</span> <span class="nb">true</span>
  <span class="k">POINTS</span>
    <span class="mi">1</span> <span class="mi">1</span>
  <span class="k">END</span> <span class="c"># POINTS</span>
<span class="k">END</span> <span class="c"># SYMBOL</span>
</pre></div>
</div>
</section>
</section>
<section id="expressions-and-advanced-transformations-layer-and-class-style">
<span id="index-8"></span><h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Expressions and advanced transformations (<cite>LAYER</cite> and <cite>CLASS</cite> <cite>STYLE</cite>)</a><a class="headerlink" href="#expressions-and-advanced-transformations-layer-and-class-style" title="Link to this heading">¶</a></h2>
<section id="combining-chaining-expressions">
<h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Combining / chaining expressions</a><a class="headerlink" href="#combining-chaining-expressions" title="Link to this heading">¶</a></h3>
<p>A geometry transformation produces a geometry, and that geometry can
be used as input to another geometry transformation.  There are (at
least) two ways to accomplish this.  One is to combine basic geometry
transformation expressions into more complex geometry transformation
expressions, and another is to combine a geometry transformation
expression at the <cite>LAYER</cite> level with a geometry transformation
expressions or a simple geometry transformation at the <cite>CLASS</cite> <cite>STYLE</cite>
level.</p>
<p><em>Combining geometry transformation expressions</em>
A geometry transformation expression contains a <cite>[shape]</cite> part.  The
<cite>[shape]</cite> part can be replaced by a geometry transformation
expression.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="n">buffer</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>In this transformation, <cite>buffer</cite> is first applied on the geometry
(<cite>[shape]</cite>).  The resulting geometry is then used as input to
<cite>simplify</cite>.</p>
<p>A style that demonstrates this:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">STYLE</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">simplify</span><span class="p">(</span><span class="k">buffer</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span><span class="mi">10</span><span class="p">))</span>
  <span class="k">OUTLINECOLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
  <span class="k">WIDTH</span> <span class="mi">2</span>
<span class="k">END</span> <span class="c"># STYLE</span>
</pre></div>
</div>
<p>The result of this transformation is shown at the top of the following
figure (red line).  The original polygon is shown with a full black
line and the buffer with a dashed black line.</p>
<p><em>Combining expressions with simple geometry transformations</em>
Simple geometry transformations are only available for <cite>CLASS</cite> <cite>STYLE</cite>,
but can be combined with geometry transformation expressions at the
<cite>LAYER</cite> level.</p>
<p>Excerpts from a layer definitions that does this kind of combination:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="p">...</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">simplify</span><span class="p">(</span><span class="k">buffer</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">10</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span>
  <span class="k">CLASS</span>
    <span class="p">...</span>
    <span class="k">STYLE</span>
      <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;vertices&quot;</span>
      <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">102</span> <span class="mi">102</span>
      <span class="k">SYMBOL</span> <span class="err">vert</span><span class="nb">line</span>
      <span class="k">SIZE</span> <span class="mi">20</span>
      <span class="k">WIDTH</span> <span class="mi">2</span>
      <span class="k">ANGLE</span> <span class="nb">auto</span>
    <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">END</span> <span class="c"># CLASS</span>
<span class="k">END</span> <span class="c"># LAYER</span>
</pre></div>
</div>
<p>The result of this transformation is shown at the bottom of the
following figure (the red lines).  The result of the LAYER level
geomtransform is shown with a full black line.  The original polygon
is the same as the one used at the top of the figure.</p>
<figure class="align-center" id="id12">
<img alt="../_images/geomtrans-expressions.png" class="no-scaled-link" src="../_images/geomtrans-expressions.png" style="width: 200px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Combining geomtransform expressions</span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="buffer">
<span id="index-9"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">buffer</a><a class="headerlink" href="#buffer" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>GEOMTRANSFORM buffer</cite> returns the buffer of the original geometry.
The result is always a polygon geometry.</p>
<ul>
<li><p>GEOMTRANSFORM (buffer ([shape], buffersize))</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Negative values for <cite>buffersize</cite> (setback) is not supported.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used at the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Buffer does not seem to work for point geometries.</p>
</div>
<figure class="align-center" id="id13">
<img alt="../_images/geomtrans-buffer.png" class="no-scaled-link" src="../_images/geomtrans-buffer.png" style="width: 200px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Geomtransform buffer</span><a class="headerlink" href="#id13" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Some class definitions for the example.</p>
<p>Lower part (polygon with buffers):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">OUTLINECOLOR</span> <span class="mi">0</span> <span class="mi">255</span> <span class="mi">0</span>
    <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="k">buffer</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">20</span><span class="p">))</span>
    <span class="k">WIDTH</span> <span class="mi">1</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">OUTLINECOLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">255</span>
    <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="k">buffer</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">10</span><span class="p">))</span>  <span class="c">#</span>
    <span class="k">WIDTH</span> <span class="mi">1</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="k">buffer</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">5</span><span class="p">))</span>  <span class="c">#</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">STYLE</span>
    <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
  <span class="k">END</span> <span class="c"># STYLE</span>
<span class="k">END</span> <span class="c"># CLASS</span>
</pre></div>
</div>
<p>Upper right part (layer level geomtransform):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>  <span class="c"># line buffer layer</span>
  <span class="k">STATUS</span> <span class="nb">DEFAULT</span>
  <span class="k">TYPE</span> <span class="nb">LINE</span>
  <span class="k">FEATURE</span>
    <span class="k">POINTS</span>
      <span class="mi">80</span> <span class="mi">70</span>
      <span class="mi">80</span> <span class="mi">75</span>
    <span class="k">END</span> <span class="c"># Points</span>
  <span class="k">END</span> <span class="c"># Feature</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="k">buffer</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">10</span><span class="p">))</span>
  <span class="k">CLASS</span>
    <span class="k">STYLE</span>
      <span class="k">COLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">255</span>
    <span class="k">END</span> <span class="c"># STYLE</span>
  <span class="k">END</span> <span class="c"># CLASS</span>
<span class="k">END</span> <span class="c"># LAYER</span>
</pre></div>
</div>
</section>
<section id="centerline">
<span id="index-10"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">centerline</a><a class="headerlink" href="#centerline" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 8.0: </span>centerline()</p>
</div>
<ul>
<li><p><em>(centerline([shape])</em>:  Useful for labeling polygons, creates a
centered line (<cite>[shape]</cite>) using a Voronoi diagram generated by GEOS
and then additional simplification. Requires GEOS &gt;= 3.5
Centerlines can <em>only</em> be computed for polygon shapes.</p>
<ul>
<li><p>an example showing a generated red centerline that is used
to label lakes, from a polygon datasource <cite>lakes.db</cite> (and uses
<cite>densify()</cite> to add more verticies to the generated red line, so it
follows the lake’s shape) :</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="k">NAME</span> <span class="s">&quot;red-line&quot;</span>
  <span class="k">TYPE</span> <span class="nb">LINE</span>
  <span class="k">CONNECTIONTYPE</span> <span class="nb">OGR</span>
  <span class="k">CONNECTION</span> <span class="s">&quot;lakes.db&quot;</span>
  <span class="k">DATA</span> <span class="s">&quot;lakes&quot;</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">center</span><span class="nb">line</span><span class="p">(</span><span class="err">densify</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">)))</span>
  <span class="p">...</span>
  <span class="k">CLASS</span>
    <span class="k">NAME</span> <span class="s">&quot;red&quot;</span>
    <span class="k">STYLE</span>
      <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">END</span> <span class="c">#style</span>
    <span class="k">LABEL</span>
      <span class="k">COLOR</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
      <span class="k">FONT</span> <span class="err">sans</span>
      <span class="k">TYPE</span> <span class="nb">truetype</span>
      <span class="k">SIZE</span> <span class="mi">7</span>
      <span class="k">POSITION</span> <span class="nb">cc</span>
      <span class="k">FORCE</span> <span class="nb">TRUE</span>
      <span class="k">ANGLE</span> <span class="nb">FOLLOW</span>
    <span class="k">END</span> <span class="c">#label</span>
  <span class="k">END</span> <span class="c">#class</span>
  <span class="p">...</span>
<span class="k">END</span> <span class="c">#layer</span>
</pre></div>
</div>
<img alt="../_images/centerline-greatlakes.png" class="no-scaled-link" src="../_images/centerline-greatlakes.png" style="width: 400px; height: 300px;" />
</li>
</ul>
</li>
</ul>
</section>
<section id="densify">
<span id="index-11"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">densify</a><a class="headerlink" href="#densify" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 8.0: </span>densify()</p>
</div>
<ul class="simple">
<li><p><em>(densify([shape],tolerance)</em>:  Add more verticies to the
feature (<cite>[shape]</cite>). Requires a positive tolerance
value.  Might be useful in combination with <cite>centerline()</cite> to
add more verticies to the generated labeled line.</p></li>
</ul>
</section>
<section id="generalize-shape-tolerance">
<span id="index-12"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">generalize ([shape], tolerance)</a><a class="headerlink" href="#generalize-shape-tolerance" title="Link to this heading">¶</a></h3>
<ul>
<li><p><cite>GEOMTRANSFORM generalize</cite> simplifies a geometry ([shape]) in a way
comparable to FME’s ThinNoPoint algorithm.  See
<a class="reference external" href="http://trac.osgeo.org/gdal/ticket/966">http://trac.osgeo.org/gdal/ticket/966</a> for more information.</p>
<ul class="simple">
<li><p>GEOMTRANSFORM (generalize([shape], tolerance))</p></li>
</ul>
<p>tolerance is mandatory, and is a specification of the maximum
deviation allowed for the generalized line compared to the original
line.  A higher value for tolerance will give a more generalised /
simplified line.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used at the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depends on GEOS.</p>
</div>
<p>The figure below shows the result of applying <cite>generalize</cite> at the
<a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> level with increasing values for tolerance (10 - green,
20 - blue and 40 - red).</p>
<figure class="align-center" id="id14">
<img alt="../_images/geomtrans-generalize.png" class="no-scaled-link" src="../_images/geomtrans-generalize.png" style="width: 200px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Geomtransform generalize</span><a class="headerlink" href="#id14" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>One of the <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> definitions for the example (tolerance 40):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">STYLE</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">generalize</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">40</span><span class="p">))</span>
  <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
      <span class="k">WIDTH</span> <span class="mi">1</span>
  <span class="k">PATTERN</span> <span class="mi">3</span> <span class="mi">3</span> <span class="k">END</span>
<span class="k">END</span> <span class="c"># STYLE</span>
</pre></div>
</div>
</section>
<section id="inner">
<span id="index-13"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">inner</a><a class="headerlink" href="#inner" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 8.0: </span>inner()</p>
</div>
<ul class="simple">
<li><p><em>(inner([shape])</em>:
creates an inner corresponding ring from an input polygon, as a
new <cite>[shape]</cite></p></li>
</ul>
</section>
<section id="simplify-shape-tolerance">
<span id="index-14"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">simplify([shape], tolerance)</a><a class="headerlink" href="#simplify-shape-tolerance" title="Link to this heading">¶</a></h3>
<ul>
<li><p><cite>GEOMTRANSFORM simplify</cite> simplifies a geometry ([shape]) using the
standard Douglas-Peucker algorithm.</p>
<ul class="simple">
<li><p>GEOMTRANSFORM (simplify([shape], tolerance))</p></li>
</ul>
<p>tolerance is mandatory, and is a specification of the maximum
deviation allowed for the generalized line compared to the original
line.  A higher value for tolerance will give a more generalised /
simplified line.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used at the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<p>The figure below shows the result of applying <cite>simplify</cite> at the
<a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> level with increasing values for tolerance (10 - green,
20 - blue and 40 - red).</p>
<figure class="align-center" id="id15">
<img alt="../_images/geomtrans-simplify.png" class="no-scaled-link" src="../_images/geomtrans-simplify.png" style="width: 200px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Geomtransform simplify</span><a class="headerlink" href="#id15" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>One of the <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> definitions for the example (tolerance 40):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">STYLE</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">simplify</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">40</span><span class="p">))</span>
  <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
      <span class="k">WIDTH</span> <span class="mi">1</span>
  <span class="k">PATTERN</span> <span class="mi">3</span> <span class="mi">3</span> <span class="k">END</span>
<span class="k">END</span> <span class="c"># STYLE</span>
</pre></div>
</div>
<ul>
<li><p>an example showing a generated red centerline that is used
to label a province, from a polygon datasource <cite>ns.db</cite> (and uses
<cite>simplify()</cite> to reduce the verticies in the generated line) :</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="k">NAME</span> <span class="s">&quot;red-line&quot;</span>
  <span class="k">TYPE</span> <span class="nb">LINE</span>
  <span class="k">STATUS</span> <span class="nb">ON</span>
  <span class="k">CONNECTIONTYPE</span> <span class="nb">OGR</span>
  <span class="k">CONNECTION</span> <span class="s">&quot;ns.db&quot;</span>
  <span class="k">DATA</span> <span class="s">&quot;ns&quot;</span>
  <span class="p">...</span>
  <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">simplify</span><span class="p">((</span><span class="err">center</span><span class="nb">line</span><span class="p">([</span><span class="err">shape</span><span class="p">])),</span> <span class="mi">10000</span><span class="p">))</span>
  <span class="k">CLASS</span>
    <span class="k">NAME</span> <span class="s">&quot;red&quot;</span>
    <span class="k">STYLE</span>
      <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="k">END</span> <span class="c">#style</span>
    <span class="k">LABEL</span>
      <span class="k">COLOR</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
      <span class="k">FONT</span> <span class="err">sans</span>
      <span class="k">TYPE</span> <span class="nb">truetype</span>
      <span class="k">SIZE</span> <span class="mi">10</span>
      <span class="k">POSITION</span> <span class="nb">AUTO</span>
      <span class="k">MINFEATURESIZE</span> <span class="nb">AUTO</span>
      <span class="k">ANGLE</span> <span class="nb">FOLLOW</span>
    <span class="k">END</span> <span class="c">#label</span>
  <span class="k">END</span> <span class="c">#class</span>
  <span class="p">...</span>
<span class="k">END</span> <span class="c">#layer</span>
</pre></div>
</div>
<img alt="../_images/centerline-novascotia.png" class="no-scaled-link" src="../_images/centerline-novascotia.png" style="width: 400px; height: 300px;" />
</li>
</ul>
</section>
<section id="simplifypt-shape-tolerance">
<span id="index-15"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">simplifypt([shape], tolerance)</a><a class="headerlink" href="#simplifypt-shape-tolerance" title="Link to this heading">¶</a></h3>
<ul>
<li><p><cite>GEOMTRANSFORM simplifypt</cite> simplifies a geometry ([shape]), ensuring
that the result is a valid geometry having the same dimension and
number of components as the input.  <cite>tolerance</cite> must be
non-negative.</p>
<ul class="simple">
<li><p>GEOMTRANSFORM (simplifypt([shape], tolerance))</p></li>
</ul>
<p>tolerance is mandatory, and is a specification of the maximum
deviation allowed for the generalized line compared to the original
line.  A higher value for tolerance will give a more generalised /
simplified line.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used at the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<p>The figure below shows the result of applying <cite>simplifypt</cite> at the
<a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> level with increasing values for tolerance (10 - green,
20 - blue and 40 - red).</p>
<figure class="align-center" id="id16">
<img alt="../_images/geomtrans-simplifypt.png" class="no-scaled-link" src="../_images/geomtrans-simplifypt.png" style="width: 200px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Geomtransform simplifypt</span><a class="headerlink" href="#id16" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>One of the <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> definitions for the example (tolerance 40):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">STYLE</span>
   <span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">simplifypt</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">40</span><span class="p">))</span>
   <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
       <span class="k">WIDTH</span> <span class="mi">1</span>
   <span class="k">PATTERN</span> <span class="mi">3</span> <span class="mi">3</span> <span class="k">END</span>
 <span class="k">END</span> <span class="c"># STYLE</span>
</pre></div>
</div>
</section>
<section id="smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing">
<span id="index-18"></span><span id="index-17"></span><span id="index-16"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">smoothsia ( [shape], smoothing_size, smoothing_iterations, preprocessing )</a><a class="headerlink" href="#smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing" title="Link to this heading">¶</a></h3>
<ul>
<li><p><cite>GEOMTRANSFORM smoothsia</cite> returns a smoothed version of a line.</p>
<ul class="simple">
<li><p>GEOMTRANSFORM (smoothsia ( [shape], smoothing_size,
smoothing_iterations, preprocessing ))</p></li>
</ul>
<p>The following parameters are used:</p>
<ul class="simple">
<li><p><em>shape</em> (mandatory).
Specify the geometry to be used</p></li>
<li><p><em>smoothing_size</em> (optional).
The window size (number of points) used by the algorithm.  The
default is 3.</p></li>
<li><p><em>smoothing_iterations</em> (optional).
The number of iterations of the algorithm. The default is 1.</p></li>
<li><p><em>preprocessing</em> (optional).
Preprocessing method to add more vertices to the geometry prior to
smoothing, described below.  There are two possible preprocessing
methods:</p>
<ul>
<li><p><em>all</em> Adds two intermediate vertices on each side of each original
vertex.  This is useful to preserve the general shape of the line
with low resolution data.</p></li>
<li><p><em>angle</em> Add vertices at some specific places based on angle
detection.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used at the <a class="reference internal" href="layer.html#layer"><span class="std std-ref">LAYER</span></a> level and for <a class="reference internal" href="style.html#style"><span class="std std-ref">STYLE</span></a> in the
<a class="reference internal" href="class.html#class"><span class="std std-ref">CLASS</span></a> context.</p>
</div>
<p>Example of a simple layer definition:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span> <span class="k">NAME</span> <span class="s">&quot;my_layer&quot;</span>
<span class="k">TYPE</span> <span class="nb">LINE</span>
<span class="k">STATUS</span> <span class="nb">DEFAULT</span>
<span class="k">DATA</span> <span class="err">roads</span><span class="p">.</span><span class="err">shp</span>
<span class="k">GEOMTRANSFORM</span> <span class="p">(</span><span class="err">smoothsia</span><span class="p">([</span><span class="err">shape</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;angle&#39;</span><span class="p">))</span>
<span class="k">CLASS</span>
  <span class="k">STYLE</span>
    <span class="k">WIDTH</span> <span class="mi">2</span>
    <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<p>Here are some examples showing results with different parameter
values.</p>
<figure class="align-center" id="id17">
<img alt="../_images/smoothing1.png" class="no-scaled-link" src="../_images/smoothing1.png" style="width: 400px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Original geometry (left) and smoothsia with default parameters
(right)</span><a class="headerlink" href="#id17" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id18">
<img alt="../_images/smoothing2.png" class="no-scaled-link" src="../_images/smoothing2.png" style="width: 400px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Smoothsia - Larger window size (left) and larger window size with
more iterations (right)</span><a class="headerlink" href="#id18" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="tuning-the-behaviour-of-smoothsia">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Tuning the behaviour of smoothsia</a><a class="headerlink" href="#tuning-the-behaviour-of-smoothsia" title="Link to this heading">¶</a></h4>
<p>smoothsia has several parameters that can be used to tune its
behaviour.  The following sections describe some cases / possibilities.</p>
</section>
<section id="dataset-resolution-is-too-high">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Dataset resolution is too high</a><a class="headerlink" href="#dataset-resolution-is-too-high" title="Link to this heading">¶</a></h4>
<p>If you are trying to smooth a line that has a very high resolution
(high density of vertices at the current view scale), you may not get
the expected result because the vertices are too dense for the
smoothing window size.  In this case you might want to simplify the
geometries before the smoothing.  You can combine smoothing and
simplification in a single geomtransform for that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">smoothsia</span><span class="p">(</span><span class="n">simplifypt</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">10</span><span class="p">)))</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../development/rfc/ms-rfc-89.html#rfc89"><span class="std std-ref">RFC 89: Layer Geomtransform</span></a> for more info. Here’s a
visualization of the issue:</p>
<figure class="align-center" id="id19">
<img alt="../_images/smoothing_highres.png" class="no-scaled-link" src="../_images/smoothing_highres.png" style="width: 600px; height: 200px;" />
<figcaption>
<p><span class="caption-text">High resolution geometry, smoothing and simplification</span><a class="headerlink" href="#id19" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="dataset-resolution-is-too-low">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Dataset resolution is too low</a><a class="headerlink" href="#dataset-resolution-is-too-low" title="Link to this heading">¶</a></h4>
<p>If you are trying to smooth a long line that has a low density of
vertices, you may not get the expected result in some situations.  You
may lose some important parts of the geometry during the smoothing,
for instance around acute angles.  You can improve the result by
enabling a preprocessing step to add intermediate vertices along the
line prior to smoothing.</p>
<p>This behavior is controlled using the <cite>all</cite> value in the preprocessing
argument of the <cite>smoothsia</cite> geomtransform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">smoothsia</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This preprocessing will be performed before the smoothing.  It adds 2
intermediate vertices on each side of each original vertex. This is
useful if we really need to preserve the general shape of the low
resolution line.  Note that this might have an impact on the rendering
since there will be more vertices in the output.</p>
<p>Here’s a visualization of the issue:</p>
<figure class="align-center" id="id20">
<img alt="../_images/smoothing_lowres.png" class="no-scaled-link" src="../_images/smoothing_lowres.png" style="width: 600px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Effects of normal smoothing and preprocessing</span><a class="headerlink" href="#id20" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="curves">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Curves</a><a class="headerlink" href="#curves" title="Link to this heading">¶</a></h4>
<p>The preprocessing step might not be appropriate for all cases since it
can impact the smoothing result significantly.  However, without it,
you might notice bad smoothing for curved lines with large distances
between the line vertices. See this example:</p>
<figure class="align-center" id="id21">
<img alt="../_images/smoothing_curve1.png" class="no-scaled-link" src="../_images/smoothing_curve1.png" style="width: 400px; height: 200px;" />
<figcaption>
<p><span class="caption-text">Effects of normal smoothing (without preprocessing)</span><a class="headerlink" href="#id21" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>You can improve that by enabling another type of preprocessing:
<cite>angle</cite>. This one will add points at some specific places based on
angle detection to recognize the curves. Here’s how you can enable it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GEOMTRANSFORM</span> <span class="p">(</span><span class="n">smoothsia</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">))</span>
</pre></div>
</div>
<figure class="align-center" id="id22">
<img alt="../_images/smoothing_curve2.png" class="no-scaled-link" src="../_images/smoothing_curve2.png" style="width: 400px; height: 200px;" />
<figcaption>
<p><span class="caption-text">The use of <cite>angle</cite> with smoothsia</span><a class="headerlink" href="#id22" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="outer">
<span id="index-19"></span><h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">outer</a><a class="headerlink" href="#outer" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">New in version 8.0: </span>outer()</p>
</div>
<ul class="simple">
<li><p><em>(outer([shape])</em>:
creates an outer corresponding ring from an input polygon, as a
new <cite>[shape]</cite>.  This might be useful when you want to ignore islands
when labeling a lake.</p></li>
</ul>
</section>
</section>
<section id="javascript-transformation">
<span id="geomtransformjs"></span><span id="index-20"></span><h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Javascript transformation</a><a class="headerlink" href="#javascript-transformation" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Alan Boudreault</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>aboudreault at mapgears.com</p>
</dd>
<dt class="field-odd">Last Updated<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-12-16</p>
</dd>
</dl>
<section id="introduction">
<h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h3>
<p>Using <cite>GEOMTRANSFORM</cite> this way makes it possible to modify the geometry
programmatically in addition to the built-in geomtransform functions.</p>
</section>
<section id="usage">
<h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading">¶</a></h3>
<p>Simply declare the javascript plugin this way:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="p">...</span>
  <span class="k">LAYER</span>
  <span class="p">...</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;javascript://transform.js&quot;</span> <span class="c"># relative path</span>
    <span class="k">CLASS</span>
    <span class="k">END</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<p>The path can also be absolute.</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="p">...</span>
  <span class="k">LAYER</span>
  <span class="p">...</span>
    <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;javascript:///home/user/transform.js&quot;</span> <span class="c"># absolute path</span>
    <span class="k">CLASS</span>
    <span class="k">END</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<p>The javascript plugin has to implement a function named
<strong>geomtransform</strong> that will be automatically called.  This function
has to return a new shape.  Note that <em>only</em> the geometry of this new
shape will be used, so your original shape attributes will be
preserved.</p>
<p>Access to the feature attributes is made through the
<cite>shape.attributes</cite> javascript object.</p>
<p>The following javascript functions are available:</p>
<ul class="simple">
<li><dl class="simple">
<dt>alert(str1, str2, …, str)</dt><dd><p>print some text in MapServer logs</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>print(str1, str2, …, str)</dt><dd><p>print some text in MapServer logs</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>require(path_to_lib1, path_to_lib2, …, path_to_lib)</dt><dd><p>include one or more javascript lib</p>
</dd>
</dl>
</li>
</ul>
<section id="example-1-simple-geomtransform">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Example 1. Simple Geomtransform</a><a class="headerlink" href="#example-1-simple-geomtransform" title="Link to this heading">¶</a></h4>
<p>This example does a simple vertical translation …</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">geomtransform</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">new_shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">shapeObj</span><span class="p">();</span>
<span class="w">  </span><span class="nx">new_shape</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">lineObj</span><span class="p">());</span>
<span class="w">  </span><span class="nx">new_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">pointObj</span><span class="p">();</span>
<span class="w">  </span><span class="nx">new_point</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="nx">new_point</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">y</span><span class="o">+</span><span class="mf">30000</span><span class="p">;</span>
<span class="w">  </span><span class="nx">new_shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">new_point</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">new_shape</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="example-2-printing-logs-in-mapserver-logs">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Example 2. Printing logs in MapServer logs</a><a class="headerlink" href="#example-2-printing-logs-in-mapserver-logs" title="Link to this heading">¶</a></h4>
<p>Extends example 1 by printing information to the MapServer log.</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="p">...</span>
  <span class="k">CONFIG</span>  <span class="s">&quot;MS_ERRORFILE&quot;</span> <span class="s">&quot;/tmp/mapserver.log&quot;</span>
  <span class="k">DEBUG</span> <span class="mi">1</span>
  <span class="k">LAYER</span>
  <span class="p">...</span>
     <span class="k">GEOMTRANSFORM</span> <span class="s">&quot;javascript://transform.js&quot;</span>
  <span class="p">...</span>
  <span class="k">END</span>
<span class="k">END</span>
</pre></div>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">geomtransform</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">new_shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">shapeObj</span><span class="p">();</span>
<span class="w">  </span><span class="nx">new_shape</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">lineObj</span><span class="p">());</span>
<span class="w">  </span><span class="nx">new_point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">pointObj</span><span class="p">();</span>
<span class="w">  </span><span class="nx">new_point</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">x</span><span class="p">;</span>
<span class="w">  </span><span class="nx">new_point</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">y</span><span class="o">+</span><span class="mf">30000</span><span class="p">;</span>
<span class="w">  </span><span class="nx">print</span><span class="p">(</span><span class="s1">&#39;Modified y value from: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">point</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; to: &#39;</span><span class="o">+</span><span class="nx">new_point</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="w">  </span><span class="nx">new_shape</span><span class="p">.</span><span class="nx">line</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="nx">new_point</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">new_shape</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="basic-api">
<h3><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Basic API</a><a class="headerlink" href="#basic-api" title="Link to this heading">¶</a></h3>
<p>A minimal API is currently available to create a new shape.</p>
<section id="pointobj">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">pointObj</a><a class="headerlink" href="#pointobj" title="Link to this heading">¶</a></h4>
<section id="constructor">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Constructor</a><a class="headerlink" href="#constructor" title="Link to this heading">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="ow">new</span><span class="w"> </span><span class="nx">pointObj</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="members">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Members</a><a class="headerlink" href="#members" title="Link to this heading">¶</a></h5>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>double</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>double</p></td>
<td><p>y</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>double</p></td>
<td><p>z</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>double</p></td>
<td><p>m</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="methods">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Methods</a><a class="headerlink" href="#methods" title="Link to this heading">¶</a></h5>
<dl class="simple">
<dt>void setXY(double x, double y[, double m])</dt><dd><p>Set the x,y[,m] values.</p>
</dd>
<dt>void setXYZ(double x, double y, double Z[, double m])</dt><dd><p>Set the x,y,z[,m] values.</p>
</dd>
</dl>
</section>
</section>
<section id="lineobj">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">lineObj</a><a class="headerlink" href="#lineobj" title="Link to this heading">¶</a></h4>
<section id="id1">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Constructor</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="ow">new</span><span class="w"> </span><span class="nx">lineObj</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id2">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Members</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h5>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int</p></td>
<td><p>numpoints</p></td>
<td><p>read-only</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id3">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Methods</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h5>
<dl class="simple">
<dt>pointObj point(int index)</dt><dd><p>Returns the point at the <cite>index</cite> position.</p>
</dd>
<dt>void add(pointObj point)</dt><dd><p>Add a point to the line.</p>
</dd>
<dt>void addXY(double x, double y[, double m])</dt><dd><p>Add point to the line from an x,y[,m] values.</p>
</dd>
<dt>void addXYZ(double x, double y, double Z[, double m])</dt><dd><p>Add point to the line from an x,y,z[,m] values.</p>
</dd>
</dl>
</section>
</section>
<section id="shapeobj">
<h4><a class="toc-backref" href="#table-of-contents" role="doc-backlink">shapeObj</a><a class="headerlink" href="#shapeobj" title="Link to this heading">¶</a></h4>
<section id="id4">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Constructor</a><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h5>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="ow">new</span><span class="w"> </span><span class="nx">shapeObj</span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="nx">type</span><span class="p">)</span>
</pre></div>
</div>
<p>‘type’ is one of shapeObj.Point, shapeObj.Line, shapeObj.Polygon or
shapeObj.Null</p>
</section>
<section id="id5">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Members</a><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h5>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int</p></td>
<td><p>numvalues</p></td>
<td><p>read-only</p></td>
</tr>
<tr class="row-odd"><td><p>int</p></td>
<td><p>numlines</p></td>
<td><p>read-only</p></td>
</tr>
<tr class="row-even"><td><p>int</p></td>
<td><p>index</p></td>
<td><p>read-only</p></td>
</tr>
<tr class="row-odd"><td><p>int</p></td>
<td><p>type</p></td>
<td><p>read-only</p></td>
</tr>
<tr class="row-even"><td><p>int</p></td>
<td><p>tileindex</p></td>
<td><p>read-only</p></td>
</tr>
<tr class="row-odd"><td><p>int</p></td>
<td><p>classindex</p></td>
<td><p>read-only</p></td>
</tr>
<tr class="row-even"><td><p>text</p></td>
<td><p>text</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>object</p></td>
<td><p>attributes</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="id6">
<h5><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Methods</a><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h5>
<dl class="simple">
<dt>shapeObj clone()</dt><dd><p>Returns a clone of the shape.</p>
</dd>
<dt>lineObj line(int index)</dt><dd><p>Returns the line at the <cite>index</cite> position.</p>
</dd>
<dt>void add(lineObj line)</dt><dd><p>Add a line to the shape.</p>
</dd>
<dt>void setGeometry(shapeObj shape)</dt><dd><p>Replace the geometry of the object with the <cite>shape</cite> geometry.</p>
</dd>
</dl>
</section>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">GEOMTRANSFORM - Geometry Transformations</a><ul>
<li><a class="reference internal" href="#transformations-for-simple-styling-class-style-only">Transformations for simple styling (<cite>CLASS</cite> <cite>STYLE</cite> only)</a><ul>
<li><a class="reference internal" href="#bbox">bbox</a></li>
<li><a class="reference internal" href="#centroid">centroid</a></li>
<li><a class="reference internal" href="#end-and-start"><cite>end</cite> and <cite>start</cite></a></li>
<li><a class="reference internal" href="#vertices">vertices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#labels-label-style-only">Labels (<cite>LABEL</cite> <cite>STYLE</cite> only)</a><ul>
<li><a class="reference internal" href="#labelpnt-and-labelpoly">labelpnt and labelpoly</a></li>
</ul>
</li>
<li><a class="reference internal" href="#expressions-and-advanced-transformations-layer-and-class-style">Expressions and advanced transformations (<cite>LAYER</cite> and <cite>CLASS</cite> <cite>STYLE</cite>)</a><ul>
<li><a class="reference internal" href="#combining-chaining-expressions">Combining / chaining expressions</a></li>
<li><a class="reference internal" href="#buffer">buffer</a></li>
<li><a class="reference internal" href="#centerline">centerline</a></li>
<li><a class="reference internal" href="#densify">densify</a></li>
<li><a class="reference internal" href="#generalize-shape-tolerance">generalize ([shape], tolerance)</a></li>
<li><a class="reference internal" href="#inner">inner</a></li>
<li><a class="reference internal" href="#simplify-shape-tolerance">simplify([shape], tolerance)</a></li>
<li><a class="reference internal" href="#simplifypt-shape-tolerance">simplifypt([shape], tolerance)</a></li>
<li><a class="reference internal" href="#smoothsia-shape-smoothing-size-smoothing-iterations-preprocessing">smoothsia ( [shape], smoothing_size, smoothing_iterations, preprocessing )</a><ul>
<li><a class="reference internal" href="#tuning-the-behaviour-of-smoothsia">Tuning the behaviour of smoothsia</a></li>
<li><a class="reference internal" href="#dataset-resolution-is-too-high">Dataset resolution is too high</a></li>
<li><a class="reference internal" href="#dataset-resolution-is-too-low">Dataset resolution is too low</a></li>
<li><a class="reference internal" href="#curves">Curves</a></li>
</ul>
</li>
<li><a class="reference internal" href="#outer">outer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#javascript-transformation">Javascript transformation</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#example-1-simple-geomtransform">Example 1. Simple Geomtransform</a></li>
<li><a class="reference internal" href="#example-2-printing-logs-in-mapserver-logs">Example 2. Printing logs in MapServer logs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-api">Basic API</a><ul>
<li><a class="reference internal" href="#pointobj">pointObj</a><ul>
<li><a class="reference internal" href="#constructor">Constructor</a></li>
<li><a class="reference internal" href="#members">Members</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lineobj">lineObj</a><ul>
<li><a class="reference internal" href="#id1">Constructor</a></li>
<li><a class="reference internal" href="#id2">Members</a></li>
<li><a class="reference internal" href="#id3">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shapeobj">shapeObj</a><ul>
<li><a class="reference internal" href="#id4">Constructor</a></li>
<li><a class="reference internal" href="#id5">Members</a></li>
<li><a class="reference internal" href="#id6">Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="grid.html" title="GRID"
             >next</a> |</li>
        <li class="right" >
          <a href="fontset.html" title="FONTSET"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Mapfile</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">GEOMTRANSFORM - Geometry Transformations</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>