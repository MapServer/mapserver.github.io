<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>COMPOSITE &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="CONFIG" href="config.html" />
    <link rel="prev" title="CLUSTER" href="cluster.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../ar/mapfile/composite.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../de/mapfile/composite.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../el/mapfile/composite.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../es/mapfile/composite.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../fr/mapfile/composite.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../id/mapfile/composite.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../it/mapfile/composite.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../ja/mapfile/composite.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../nl_NL/mapfile/composite.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../pl/mapfile/composite.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../ru/mapfile/composite.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../sq/mapfile/composite.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../tr/mapfile/composite.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="config.html" title="CONFIG"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cluster.html" title="CLUSTER"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Mapfile</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">COMPOSITE</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="composite">
<span id="index-0"></span><span id="id1"></span><h1>COMPOSITE<a class="headerlink" href="#composite" title="Link to this heading">¶</a></h1>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">¶</a></h2>
<p>Available since MapServer 7.0, the <cite>COMPOSITE</cite> block is used to achieve
blending effects with MapServer.</p>
<p>Some cartographic renderings benefit from the addition of advanced
blending modes, as explained in detail in <a class="reference external" href="http://en.wikipedia.org/wiki/Blend_modes">Blend Modes</a>.  This
functionality is essential for more pleasant renderings of raster
hillshadings over vector surfaces.  It is also useful for simulating
different kinds of overprinting effects.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../development/rfc/ms-rfc-113.html#rfc113"><span class="std std-ref">MS RFC 113: Layer Compositing Pipeline</span></a></p>
</div>
<p>Performance is affected by advanced blending (all modes except
<cite>src-over</cite>).</p>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<dl id="mapfile-composite-compfilter">
<dt>COMPFILTER [string]</dt><dd><div class="versionadded">
<p><span class="versionmodified added">New in version 7.2.</span></p>
</div>
<p>Name of the compositing filter. The primary purpose is to enable soft shadow
and blurring effects, although other usages can exist or could be added in
the future. Several compfilters can be placed after another to create a combined
effect. For example a blur and translate effect can be combined to make a
soft shadow effect behind a feature.</p>
<p>The currently available filters are:</p>
<ul class="simple">
<li><p>blur(integer)</p></li>
<li><p>translate(integer,integer)</p></li>
<li><p>grayscale()</p></li>
<li><p>blacken()</p></li>
<li><p>whiten()</p></li>
</ul>
</dd>
</dl>
<dl id="mapfile-composite-compop">
<dt>COMPOP [string]</dt><dd><p>Name of the compositing operator to use when blending the temporary image
onto the main map image. See <cite>http://en.wikipedia.org/wiki/Blend_modes</cite>.
The default compositing operator is “src-over”.</p>
<p>Available operators are:</p>
<ul class="simple">
<li><dl class="simple">
<dt>clear</dt><dd><p>Both the color and the alpha of the destination are cleared.
Neither the source nor the destination are used. This is an
unusual compose method that essentially ignores the overlay
image completely, and just clears the background image.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>color-burn</dt><dd><p>Divides the inverted bottom layer by the top layer, and then
inverts the result. This darkens the top layer increasing the
contrast to reflect the color of the bottom layer. The darker
the bottom layer, the more its color is used.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>color-dodge</dt><dd><p>Divides the bottom layer by the inverted top layer. This
lightens the bottom layer depending on the value of the top
layer: the brighter the top layer, the more its color affects
the bottom layer. Blending any color with white gives
white. Blending with black does not change the image.</p>
</dd>
</dl>
</li>
<li><p>contrast*</p></li>
<li><dl class="simple">
<dt>darken</dt><dd><p>Creates a image that retains the smallest components of the
foreground and background pixels. If the foreground pixel has
the components r1, g1, and b1, and the background has r2, g2,
b2, the resultant pixel is [min(r1,r2), min(g1,g2), min(b1,b2)]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>difference</dt><dd><p>Subtracts the bottom layer from the top layer or the other way
round, to always get a positive value. Blending with black
produces no change, as values for all colors are 0. (The RGB
value for black is 0,0,0.) Blending with white inverts the
picture.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dst</dt><dd><p>This operator does nothing. The source, or overlay image, is
completely ignored and the destination, or background image, is
left unchanged. The method’s real use is as a means of ‘turning
off’ an alpha composition operation in other image operators.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dst-atop</dt><dd><p>The part of the source lying inside of the destination is
composited onto the destination.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dst-in</dt><dd><p>The part of the destination lying inside of the source replaces
the destination. Areas not overlaid are cleared. Will remove
the overlay image’s shape from the background image like a
cookie cutter which cuts out a cookie’s shape from cookie dough
(result is the cookie).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dst-out</dt><dd><p>The part of the destination lying outside of the source
replaces the destination. Using the ‘cookie dough’ metaphor of
‘dst-in’ the result of the ‘dst-out’ method is the dough that
was left behind once a cookie has been cut out. It can be used
to cut holes, or take bites out of the background image, using
the shape of the overlay. Any color in the overlay is again
completely ignored.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dst-over</dt><dd><p>The destination is composited over the source and the result
replaces the destination.  Equivalent to placing the source
overlay image ‘under’ the destination. The result is that only
the parts of our source or overlay image not hidden by the
destination or background image will be visible as they peek
out from underneath.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>exclusion</dt><dd><p>This is sort of an averaged difference. White on white will
produce black (no difference), the same with black on
black. However grey on grey will produce a grey result. White
and black naturally still produce white (maximum difference).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>hard-light</dt><dd><p>Hard Light is a combination of Multiply and Screen, each at
half strength. Hard Light effects the blend layer’s
relationship to the base layer in the same way Overlay effects
the base layer’s relationship to the blend layer.</p>
</dd>
</dl>
</li>
<li><p>invert*</p></li>
<li><p>invert-rgb*</p></li>
<li><dl class="simple">
<dt>lighten</dt><dd><p>Lighten has the opposite action of Darken. It selects the
maximum of each component from the foreground and background
pixels. If the foreground pixel has the components r1, g1, and
b1, and the background has r2, g2, b2, the resultant pixel is
[max(r1,r2), max(g1,g2), max(b1,b2)]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>minus*</dt><dd><p>Subtract the colors in the source image from the destination
image. When transparency is involved, opaque areas is
subtracted from any destination opaque areas.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>multiply</dt><dd><p>A simple multiply of the two images. Its formula is: [Src *
Dest]. This means that if one of the images is pure white, the
result will be the other image. On the other hand if one image
is black the result will be black. Between these extremes one
image will darken the destination image by the amount
given. Note that ‘Multiply’ will only darken an image, it will
never brighten it. That is, it ‘attenuates’ an image toward
black, which makes this compose method a ‘Burn’ style of
composition.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>overlay</dt><dd><p>Overlay combines Multiply and Screen blend modes, at half
strength. The parts of the top layer where the base layer is
light become lighter, the parts where the base layer is dark
become darker. Areas where the top layer are mid grey are
unaffected.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>plus</dt><dd><p>The source is added to the destination and replaces the
destination. This operator is useful for averaging or a
controlled merger of two images, rather than a direct overlay.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>screen</dt><dd><p>The source and destination are complemented and then multiplied
and then replace the destination. The resultant color is always
at least as light as either of the two constituent
colors. Screening any color with white produces
white. Screening any color with black leaves the original color
unchanged.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>soft-light</dt><dd><p>Soft light is most closely related to Overlay and is only
similar to Hard Light by name. Will add highlights and shadows
to an existing color image. However, the colors of the
destination image are modified to produce a softer contrast,
and smoother gradient in lighting effects.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>src</dt><dd><p>The source is copied to the destination. The destination is not
used as input, though it is cleared. This operator completely
replaces the background image with the overlay image. The
colors and transparency in the background are completely junked
leaving a blank image the same size as the original destination
over which is applied the source image.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>src-atop</dt><dd><p>The part of the source lying inside of the destination is
composited onto the destination. Like ‘src-over’ but limits the
result to the original shape of the background image. In other
words, the alpha channel on the destination is unchanged but
the image colors are overlaid by any non-transparent parts of
the source image. If the background image is fully opaque (no
transparency), this operation will act exactly like the normal
‘src-over’ composition. It only differs when the background
contains transparency which also clips the overlay. What makes
this useful is for overlaying lighting and shading effects that
are limited to the object (shape) of the destination.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>src-in</dt><dd><p>The part of the source lying inside of the destination replaces
the destination.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>src-out</dt><dd><p>The part of the source lying outside of the destination
replaces the destination.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>src-over</dt><dd><p>The source is composited over the destination. This is the
default composite option if no other is specified.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>xor</dt><dd><p>The part of the source that lies outside of the destination is
combined with the part of the destination that lies outside of
the source. Source or Destination, but not both.</p>
</dd>
</dl>
</li>
</ul>
<p>Operators marked with a star (*) will only be supported when using an AGG
backends <em>and</em> when pixman support is not enabled, and will fall back to
“src-over” when this is not the case.</p>
</dd>
</dl>
<span id="mapfile-composite-opacity"></span><dl class="simple" id="opacity">
<dt>OPACITY [integer]</dt><dd><p>Sets the opacity level (or the inability to see through the layer) of all
classed pixels for a given layer. Must be between 0 to 100. A value of 100 is opaque and
0 is fully transparent.</p>
</dd>
</dl>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>Simple transparency / opacity is achieved by only specifying the
<cite>OPACITY</cite> parameter (this achieves the same effect as the legacy
<cite>LAYER</cite> <cite>OPACITY</cite> parameter):</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="k">COMPOSITE</span>
    <span class="k">OPACITY</span> <span class="mi">70</span>
  <span class="k">END</span> <span class="c"># COMPOSITE</span>
<span class="p">...</span>
<span class="k">END</span> <span class="c"># LAYER</span>
</pre></div>
</div>
<p>The darkening effect is achieved by adding the <cite>COMPOP</cite> parameter with
the value <cite>darken</cite>:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">LAYER</span>
  <span class="k">COMPOSITE</span>
    <span class="k">OPACITY</span> <span class="mi">100</span>
    <span class="k">COMPOP</span> <span class="s">&quot;darken&quot;</span>
  <span class="k">END</span> <span class="c"># COMPOSITE</span>
<span class="p">...</span>
<span class="k">END</span> <span class="c"># LAYER</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">COMPOSITE</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="config.html" title="CONFIG"
             >next</a> |</li>
        <li class="right" >
          <a href="cluster.html" title="CLUSTER"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Mapfile</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">COMPOSITE</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>