<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SOS Server &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="MapScript Wrappers for WxS Services" href="mapscript.html" />
    <link rel="prev" title="WCS Use Cases" href="wcs_format.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../ar/ogc/sos_server.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../de/ogc/sos_server.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../el/ogc/sos_server.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../es/ogc/sos_server.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../fr/ogc/sos_server.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../id/ogc/sos_server.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../it/ogc/sos_server.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../ja/ogc/sos_server.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../nl_NL/ogc/sos_server.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../pl/ogc/sos_server.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../ru/ogc/sos_server.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../sq/ogc/sos_server.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../tr/ogc/sos_server.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="mapscript.html" title="MapScript Wrappers for WxS Services"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wcs_format.html" title="WCS Use Cases"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">OGC Support and Configuration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">SOS Server</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="sos-server">
<span id="index-0"></span><span id="id1"></span><h1><a class="toc-backref" href="#table-of-contents" role="doc-backlink">SOS Server</a><a class="headerlink" href="#sos-server" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Jeff McKenna</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>jmckenna at gatewaygeomatics.com</p>
</dd>
<dt class="field-odd">Last Updated<span class="colon">:</span></dt>
<dd class="field-odd"><p>2021-03-27</p>
</dd>
</dl>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sos-server" id="id2">SOS Server</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id3">Introduction</a></p></li>
<li><p><a class="reference internal" href="#setting-up-an-sos-server-using-mapserver" id="id4">Setting Up an SOS Server Using MapServer</a></p></li>
<li><p><a class="reference internal" href="#limitations-todo" id="id5">Limitations / TODO</a></p></li>
<li><p><a class="reference internal" href="#reference-section" id="id6">Reference Section</a></p></li>
<li><p><a class="reference internal" href="#use-of-sos-procedure-and-sos-procedure-item" id="id7">Use of sos_procedure and sos_procedure_item</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>SOS (Sensor Observation Service), currently an OGC discussion paper, is part of
of the OGC’s SensorWeb Enablement (SWE) group of specifications.  These
specifications describe how applications and services will be able to access
sensors of all types over the Web.  Specifically, SOS provides an API for
managing deployed sensors and retrieving sensor data.</p>
<p>SOS support is <strong>available in MapServer 4.10.0 or more recent</strong>. Note that no
client tools currently exist in MapServer for SOS; you can try <a class="reference external" href="https://qgis.org">QGIS</a>
desktop and its plugins, or try using a JavaScript library such as <a class="reference external" href="http://openlayers.org">OpenLayers</a>
as a client.</p>
<p>SOS support was implemented in MapServer to the guidelines of
MapServer <a class="reference internal" href="../development/rfc/ms-rfc-13.html#rfc13"><span class="std std-ref">MS RFC 13: Support of Sensor Observation Service in MapServer</span></a>.</p>
<p>This document assumes that you are already familiar with certain
aspects of MapServer:</p>
<ul class="simple">
<li><p>MapServer application development and setting up .map files.</p></li>
</ul>
<section id="links-to-sos-related-information">
<h3>Links to SOS-Related Information<a class="headerlink" href="#links-to-sos-related-information" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ogc.org/standards/sos">SOS specification documents</a></p></li>
<li><p>OGC’s <a class="reference external" href="https://www.ogc.org/projects/groups/sensorwebdwg">Sensor Web Enablement</a>  working group</p></li>
</ul>
</section>
<section id="relevant-definitions">
<h3>Relevant Definitions<a class="headerlink" href="#relevant-definitions" title="Link to this heading">¶</a></h3>
<p>The following is taken from the SOS 1.0.0 specification:</p>
<dl class="simple">
<dt>Observation</dt><dd><p>An observation is an event with a result which has a value
describing some phenomenon.</p>
</dd>
<dt>Observation Offering</dt><dd><p>An observation offering is a logical grouping of observations
offered by a service that are related in some way.</p>
</dd>
<dt>Observed Value</dt><dd><p>A value describing a natural phenomenon, which may use one of a
variety of scales including nominal, ordinal, ratio and interval.</p>
</dd>
<dt>Sensor</dt><dd><p>An entity capable of observing a phenomenon and returning an
observed value. A sensor can be an instrument or a living organism
(e.g. a person).</p>
</dd>
</dl>
</section>
</section>
<section id="setting-up-an-sos-server-using-mapserver">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Setting Up an SOS Server Using MapServer</a><a class="headerlink" href="#setting-up-an-sos-server-using-mapserver" title="Link to this heading">¶</a></h2>
<section id="install-the-required-software">
<h3>Install the Required Software<a class="headerlink" href="#install-the-required-software" title="Link to this heading">¶</a></h3>
<p>SOS requests are handled by the “<a class="reference internal" href="../cgi/mapserv.html#mapserv"><span class="std std-ref">mapserv</span></a>” CGI program. The
first step is to check that your mapserv executable includes SOS
support. One way to verify this is to use the “-v” command-line switch
and look for “SUPPORTS=SOS_SERVER”.</p>
<p>Example 1. On Unix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./mapserv -v
MapServer version 4.9 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP
OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=FREETYPE SUPPORTS=WMS_SERVER
SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT
SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=THREADS INPUT=JPEG
INPUT=OGR INPUT=GDAL INPUT=SHAPEFILE DEBUG=MSDEBUG
</pre></div>
</div>
<p>Example 2. On Windows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">MS4W</span>\<span class="n">Apache</span>\<span class="n">cgi</span><span class="o">-</span><span class="nb">bin</span><span class="o">&gt;</span> <span class="n">mapserv</span> <span class="o">-</span><span class="n">v</span>
<span class="n">MapServer</span> <span class="n">version</span> <span class="mf">4.9</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">GIF</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">PNG</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">JPEG</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">WBMP</span>
<span class="n">OUTPUT</span><span class="o">=</span><span class="n">SVG</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">PROJ</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">FREETYPE</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WMS_SERVER</span>
<span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WMS_CLIENT</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WFS_SERVER</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WFS_CLIENT</span>
<span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WCS_SERVER</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">SOS_SERVER</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">THREADS</span> <span class="n">INPUT</span><span class="o">=</span><span class="n">JPEG</span>
<span class="n">INPUT</span><span class="o">=</span><span class="n">OGR</span> <span class="n">INPUT</span><span class="o">=</span><span class="n">GDAL</span> <span class="n">INPUT</span><span class="o">=</span><span class="n">SHAPEFILE</span> <span class="n">DEBUG</span><span class="o">=</span><span class="n">MSDEBUG</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Windows users can install <a class="reference external" href="https://ms4w.com">MS4W</a> which supports SOS server.</p>
</div>
<p>If you don’t have SOS support in your MapServer build, then you must
compile MapServer with the following in mind:</p>
<ul class="simple">
<li><p>flag <em>-DUSE_SOS_SVR</em> is required</p></li>
<li><p>requires either <em>-DUSE_WMS_SVR</em> or <em>-DUSE_WFS_SVR</em> flags to be enabled</p></li>
<li><p>requires libxml2 and proj libraries</p></li>
<li><p>requires ICONV support (<em>-DUSE_ICONV</em>) on Windows</p></li>
</ul>
<p>For more help with MapServer compilation see the appropriate HowTo:
<a class="reference internal" href="../installation/unix.html#unix"><span class="std std-ref">Unix</span></a> / <a class="reference internal" href="../installation/win32.html#win32"><span class="std std-ref">Windows</span></a></p>
</section>
<section id="configure-a-mapfile-for-sos">
<span id="index-1"></span><h3>Configure a Mapfile For SOS<a class="headerlink" href="#configure-a-mapfile-for-sos" title="Link to this heading">¶</a></h3>
<p>Each instance of SOS server that you setup needs to have its own mapfile. It
is just a regular MapServer mapfile in which some parameters and some metadata
entries are mandatory. Most of the metadata is required in order to produce a
valid GetCapabilities output.</p>
<p>Here is the list of parameters and metadata items that usually optional with
MapServer, but are <strong>required (or strongly recommended) for a SOS
configuration:</strong></p>
<p><strong>MAP level:</strong></p>
<ul class="simple">
<li><p>Map NAME</p></li>
<li><p>Map PROJECTION</p></li>
<li><p>Map Metadata (in the WEB Object):</p>
<ul>
<li><p>sos_title</p></li>
<li><p>sos_onlineresource</p></li>
<li><p>sos_srs</p></li>
<li><p>sos_enable_request</p></li>
<li><p>see the <a class="reference internal" href="#reference-section">Reference Section</a> of this document for a full list of
metadata and descriptions</p></li>
</ul>
</li>
</ul>
<p><strong>LAYER level:</strong></p>
<ul class="simple">
<li><p>Layer NAME</p></li>
<li><p>Layer PROJECTION</p></li>
<li><p>Layer METADATA</p>
<ul>
<li><p>sos_offering_id</p></li>
<li><p>sos_observedproperty_id</p></li>
<li><p>sos_observedproperty_id</p></li>
<li><p>sos_describesensor_url</p></li>
<li><p>see the <a class="reference internal" href="#reference-section">Reference Section</a> of this document for a full list of
metadata and descriptions</p></li>
</ul>
</li>
</ul>
<section id="onlineresource-url">
<h4>Onlineresource URL<a class="headerlink" href="#onlineresource-url" title="Link to this heading">¶</a></h4>
<p>The sos_onlineresource metadata is set in the map’s web object
metadata and specifies the URL that should be used to access your
server. This is required for the GetCapabilities output. If
sos_onlineresource is not provided then MapServer will try to provide
a default one using the script name and hostname, but you shouldn’t
count on that too much. It is strongly recommended that you provide
the sos_onlineresource metadata.</p>
<p>Here is a valid online resource URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://my.host.com/cgi-bin/mapserv?map=mysos.map&amp;
</pre></div>
</div>
<p>By creating a wrapper script on the server it is possible to hide the “map=”
parameter from the URL and then your server’s online resource URL could be
something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://my.host.com/cgi-bin/mapserv?
</pre></div>
</div>
<p>This is covered in more detail in the “More About the Online Resource
URL” section of the <a class="reference internal" href="wms_server.html#online-resource-wms"><span class="std std-ref">WMS Server</span></a> document.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is strongly recommended to review the security steps for the <em>MAP=</em>
call to the MapServer executable, by setting <em>MS_MAP_PATTERN</em> or
<em>MS_MAP_NO_PATH</em> or hiding the <em>MAP=</em> parameter on public servers,
as recommended in the document <a class="reference internal" href="../optimization/limit_mapfile_access.html#limit-mapfile-access"><span class="std std-ref">Limit Mapfile Access</span></a>. All possible
environment variables to secure your server are listed in <a class="reference internal" href="../optimization/environment_variables.html#environment-variables"><span class="std std-ref">Environment Variables</span></a>.</p>
</div>
</section>
</section>
<section id="example-sos-server-mapfile">
<h3>Example SOS Server Mapfile<a class="headerlink" href="#example-sos-server-mapfile" title="Link to this heading">¶</a></h3>
<p>The following is an example of a bare minimum SOS Server mapfile. Note
the comments for the required parameters.</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="k">MAP</span>
  <span class="k">NAME</span> <span class="s">&quot;SOS_DEMO&quot;</span>
  <span class="k">STATUS</span> <span class="nb">ON</span>
  <span class="k">SIZE</span> <span class="mi">300</span> <span class="mi">300</span>
  <span class="k">EXTENT</span> <span class="p">-</span><span class="mi">66</span> <span class="mi">44</span> <span class="p">-</span><span class="mi">62</span> <span class="mi">45</span>
  <span class="k">UNITS</span> <span class="nb">METERS</span>
  <span class="k">SHAPEPATH</span> <span class="s">&quot;./data/&quot;</span>
  <span class="k">IMAGECOLOR</span> <span class="mi">255</span> <span class="mi">255</span> <span class="mi">0</span>
  <span class="k">SYMBOLSET</span> <span class="s">&quot;./etc/symbols.sym&quot;</span>

  <span class="k">IMAGETYPE</span> <span class="nb">png</span>

  <span class="k">WEB</span>
    <span class="k">IMAGEPATH</span> <span class="s">&quot;/ms4w/tmp/ms_tmp/&quot;</span>
    <span class="k">IMAGEURL</span> <span class="s">&quot;/ms_tmp/&quot;</span>

    <span class="k">METADATA</span>
      <span class="s">&quot;sos_onlineresource&quot;</span> <span class="s">&quot;http://127.0.0.1/mapserv?map=/sos/sos_test.map&quot;</span> <span class="c">## REQUIRED</span>
      <span class="s">&quot;sos_title&quot;</span>          <span class="s">&quot;My SOS Demo Server&quot;</span> <span class="c">## Recommended</span>
      <span class="s">&quot;sos_srs&quot;</span>            <span class="s">&quot;EPSG:4326&quot;</span> <span class="c">## REQUIRED</span>
      <span class="s">&quot;sos_enable_request&quot;</span> <span class="s">&quot;*&quot;</span> <span class="c">## REQUIRED</span>
    <span class="k">END</span>
  <span class="k">END</span>

  <span class="k">PROJECTION</span>
    <span class="s">&quot;init=epsg:4326&quot;</span>
  <span class="k">END</span>

  <span class="k">LAYER</span>
    <span class="k">NAME</span> <span class="s">&quot;test_sos_layer&quot;</span>
    <span class="k">METADATA</span>
      <span class="s">&quot;sos_procedure&quot;</span>  <span class="s">&quot;NS01EE0014&quot;</span> <span class="c">## REQUIRED</span>
      <span class="s">&quot;sos_offering_id&quot;</span> <span class="s">&quot;WQ1289&quot;</span> <span class="c">## REQUIRED</span>
      <span class="s">&quot;sos_observedproperty_id&quot;</span> <span class="s">&quot;Water Quality&quot;</span> <span class="c">## REQUIRED</span>
      <span class="s">&quot;sos_describesensor_url&quot;</span> <span class="s">&quot;http://some/url/NS01EE0014.xml&quot;</span> <span class="c">## REQUIRED</span>
    <span class="k">END</span>
    <span class="k">TYPE</span> <span class="nb">POINT</span>
    <span class="k">STATUS</span> <span class="nb">ON</span>
    <span class="k">DATA</span> <span class="s">&quot;sos_test&quot;</span>

    <span class="k">PROJECTION</span>
      <span class="s">&quot;init=epsg:4326&quot;</span>
    <span class="k">END</span>

    <span class="k">CLASS</span>
      <span class="k">NAME</span> <span class="s">&quot;water quality&quot;</span>
      <span class="k">STYLE</span>
        <span class="k">COLOR</span> <span class="mi">255</span> <span class="mi">0</span> <span class="mi">0</span>
        <span class="k">SYMBOL</span> <span class="s">&quot;circle&quot;</span>
        <span class="k">SIZE</span> <span class="mi">8</span>
      <span class="k">END</span>
    <span class="k">END</span>
  <span class="k">END</span>

<span class="k">END</span> <span class="c">#map</span>
</pre></div>
</div>
</section>
<section id="test-your-sos-server">
<h3>Test Your SOS Server<a class="headerlink" href="#test-your-sos-server" title="Link to this heading">¶</a></h3>
<section id="getcapabilities-request">
<h4>GetCapabilities Request<a class="headerlink" href="#getcapabilities-request" title="Link to this heading">¶</a></h4>
<p>The GetCapabilities request allows the clients to retrieve service
metadata about a specific service instance. For an SOS service, it
allows to identify such things as offerings and observed property
available, as well as information on sensors that are used.</p>
<p>Using a web browser, access your server’s online resource URL to which you add
the parameters “SERVICE=SOS&amp;REQUEST=GetCapabilities” to the end, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://my.host.com/cgi-bin/mapserv?MAP=mysos.map&amp;SERVICE=SOS&amp;REQUEST=GetCapabilities
</pre></div>
</div>
<p>If everything went well, you should have a complete XML capabilities document.
Search it for the word “WARNING”… MapServer inserts XML comments starting
with “&lt;!–WARNING: “ in the XML output if it detects missing mapfile parameters
or metadata items. If you notice any warning in your XML output then you have
to fix all of them before you can try your server with an SOS client, otherwise
things are likely not going to work.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SERVICE parameter is required for all SOS requests.</p>
</div>
</section>
<section id="getobservation-request">
<h4>GetObservation Request<a class="headerlink" href="#getobservation-request" title="Link to this heading">¶</a></h4>
<p>The GetObservation request is designed to query sensor systems to
retrieve observation data in the form defined in the Observation and
Measurement specification (O&amp;M), and more information on this O&amp;M spec
can be found at <a class="reference external" href="https://www.ogc.org/standards/om">https://www.ogc.org/standards/om</a>.
Upon receiving a GetObservation request, a SOS shall either satisfy
the request or return an exception report.</p>
<p>The following is a list of the possible parameters for a GetObservation request:</p>
<blockquote>
<div><p><strong>request</strong>:  (Required) value must be “GetObservation”.</p>
<p><strong>service</strong>:  (Required) value must be “SOS”.</p>
<p><strong>version</strong>:  (Required) value must be “1.0.0”.</p>
<p><strong>offering</strong>: (Required) The Offering identified in the capabilities document.</p>
<dl class="simple">
<dt><strong>observedProperty</strong>: (Required) The property identified in the</dt><dd><p>capabilities document.</p>
</dd>
<dt><strong>responseFormat</strong>: (Required) The format / encoding to be returned</dt><dd><p>by the response.</p>
</dd>
<dt><strong>eventTime</strong> (Optional) Specifies the time period for which</dt><dd><p>observations are requested.</p>
</dd>
<dt><strong>procedure</strong>: (Optional) The procedure specifies the sensor system</dt><dd><p>used. In this implementation, the procedure is equivalent to be
the sensor id that will be used when doing a DescribeSensor
request.</p>
</dd>
<dt><strong>featureOfInterest</strong>: (Optional) In this implementation, this will</dt><dd><p>be represented by a gml envelope defining the lower and upper
corners.</p>
</dd>
<dt><strong>Result</strong>: (Optional) The Result parameter provides a place to put</dt><dd><p>OGC filter expressions based on property values.</p>
</dd>
<dt><strong>resultModel</strong>: (Optional) Identifier of the result model to be</dt><dd><p>used for the requested data. The resultModel values supported by a
SOS server are listed in the contents section of the service
metadata (GetCapabilities).  MapServer currently supports
om:Observation and om:Measurement.  om:Measurement provides a flat
model of the geometry and attributes, similar to WFS GetFeature
output.  om:Observations provides a more compact definition which
includes an XML header of the field names and definitions, followed
by a “DataBlock” of delimited records (default is CSV delimited
output).  The default output is om:Measurement.</p>
</dd>
</dl>
<p><strong>srsName</strong>: (Optional) srs (EPSG code) of the output response.</p>
</div></blockquote>
<p>Here are some valid examples:</p>
<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://127.0.0.1/cgi-bin/mapserv.exe?map=D:/ms4w/apps/sos/sos_test.map&amp;
Request=GetObservation&amp;service=SOS&amp;Offering=WQ1289&amp;
observedproperty=Water Quality&amp;version=1.0.0&amp;
responseFormat=text/xml; subtype=&quot;om/1.0.0&quot;
</pre></div>
</div>
<p>Example 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://127.0.0.1/cgi-bin/mapserv.exe?map=D:/ms4w/apps/sos/sos_test.map&amp;
Request=GetObservation&amp;service=SOS&amp;Offering=WQ1289&amp;
observedproperty=Water Quality&amp;eventtime=&lt;ogc:TM_Equals&gt;&lt;gml:TimePeriod&gt;
&lt;gml:beginPosition&gt;1991-05-01&lt;/gml:beginPosition&gt;&lt;gml:endPosition&gt;
1993-02-02&lt;/gml:endPosition&gt;&lt;/gml:TimePeriod&gt;&lt;/ogc:TM_Equals&gt;
&amp;result=&lt;Filter&gt;&lt;Or&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;COLOUR
&lt;/PropertyName&gt;&lt;Literal&gt;180&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;
&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;COLOUR&lt;/PropertyName&gt;&lt;Literal&gt;200
&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/or&gt;&lt;/Filter&gt;&amp;version=1.0.0
&amp;responseFormat=text/xml; subtype=&quot;om/1.0.0&quot;
</pre></div>
</div>
<p>Example 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://127.0.0.1/cgi-bin/mapserv.exe?map=D:/ms4w/apps/sos/sos_test.map&amp;
Request=GetObservation&amp;service=SOS&amp;Offering=WQ1289&amp;
observedproperty=Water Quality&amp;featureofinterest=&lt;gml:Envelope&gt;
&lt;gml:lowerCorner srsName=&#39;EPSG:4326&#39;&gt;-66 43&lt;/gml:lowerCorner&gt;
&lt;gml:upperCorner srsName=&#39;EPSG:4326&#39;&gt;-64 45&lt;/gml:upperCorner&gt;
&lt;/gml:Envelope&gt;&amp;version=1.0.0&amp;
responseFormat=text/xml; subtype=&quot;om/1.0.0&quot;
</pre></div>
</div>
<p>Example 4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://127.0.0.1/cgi-bin/mapserv.exe?map=D:/ms4w/apps/sos/sos_test.map&amp;
Request=GetObservation&amp;service=SOS&amp;Offering=WQ1289&amp;
observedproperty=Water Quality&amp;version=1.0.0&amp;
responseFormat=text/xml; subtype=&quot;om/1.0.0&quot;&amp;resultModel=om:Observation
</pre></div>
</div>
</section>
<section id="describesensor-request">
<h4>DescribeSensor Request<a class="headerlink" href="#describesensor-request" title="Link to this heading">¶</a></h4>
<p>The DescribeSensor request gives the client the ability to retrieve the
characteristics of a particular sensor and return the information in a
SensorML xml document. In this implementation, MapServer does not generate the
SensorML document but only redirect the request to an existing SensorML
document.</p>
<p>The following is a list of the possible parameters for a DescribeSensor request:</p>
<blockquote>
<div><p><strong>request</strong>: (Required) value must be “DescribeSensor”</p>
<p><strong>service</strong>:  (Required) value must be “SOS”.</p>
<p><strong>version</strong>:  (Required) value must be “1.0.0”.</p>
<dl class="simple">
<dt><strong>procedure</strong>: (Required) This is the sensor id, which was specified</dt><dd><p>in the “sos_procedure” metadata.</p>
</dd>
<dt><strong>outputFormat</strong>: (Required) The format encoding to be returned by</dt><dd><p>the response.</p>
</dd>
</dl>
</div></blockquote>
<p>Here is a valid example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://127.0.0.1/cgi-bin/mapserv.exe?map=D:/ms4w/apps/sos/sos_test.map&amp;
Request=DescribeSensor&amp;procedure=urn:ogc:def:procedure:NS01EE0014&amp;
service=SOS&amp;version=1.0.0&amp;outputFormat=text/xml; subtype=&quot;sensorML/1.0.0&quot;
</pre></div>
</div>
</section>
</section>
</section>
<section id="limitations-todo">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Limitations / TODO</a><a class="headerlink" href="#limitations-todo" title="Link to this heading">¶</a></h2>
<p>1. Have MapServer generate the SensorML document, instead of redirecting the
request to an existing SensorML document.</p>
</section>
<section id="reference-section">
<span id="index-2"></span><h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Reference Section</a><a class="headerlink" href="#reference-section" title="Link to this heading">¶</a></h2>
<p>The following metadata are available in the setup of the SOS Server mapfile:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each of the metadata below can also be referred to as ‘ows_*’ instead of
‘sos_*’. MapServer tries the ‘sos_*’ metadata first, and if not found it
tries the corresponding ‘ows_*’ name. Using this reduces the amount of
duplication in mapfiles that support multiple OGC interfaces since “ows_*”
metadata can be used almost everywhere for common metadata items shared by
multiple OGC interfaces.</p>
</div>
<section id="web-object-metadata">
<span id="index-3"></span><h3>Web Object Metadata<a class="headerlink" href="#web-object-metadata" title="Link to this heading">¶</a></h3>
<p id="index-5"><span id="index-4"></span><strong>ows_allowed_ip_list</strong> (or sos_allowed_ip_list)</p>
<ul>
<li><p><em>Description:</em> (Optional) A list of IP addresses that will be
allowed access to the service.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">METADATA</span>
  <span class="s2">&quot;ows_allowed_ip_list&quot;</span> <span class="s2">&quot;123.45.67.89 11.22.33.44&quot;</span>
<span class="n">END</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-7"><span id="index-6"></span><strong>ows_denied_ip_list</strong> (or sos_denied_ip_list)</p>
<ul>
<li><p><em>Description:</em> (Optional) A list of IP addresses that will be denied
access to the service.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">METADATA</span>
  <span class="s2">&quot;ows_denied_ip_list&quot;</span> <span class="s2">&quot;123.45.67.89 11.22.33.44&quot;</span>
<span class="n">END</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-8"><strong>ows_language</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Descriptive narrative for more information about
the server. Identifier of the language used by all included exception text
values. These language identifiers shall be as specified in IETF RFC 1766.
When this attribute is omitted, the language used is not identified.
Examples: “en-CA”, “fr-CA”, “en-US”. Default is “en-US”.</p></li>
</ul>
<p id="index-9"><strong>ows_schemas_location</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) (Note the name ows_schemas_location and not
sos/_… this is because all OGC Web Services (OWS) use the same metadata)
Root of the web tree where the family of OGC SOS XMLSchema files are
located. This must be a valid URL where the actual .xsd files are located if
you want your SOS output to validate in a validating XML parser. Default is
<a class="reference external" href="http://schemas.opengis.net/sos/">http://schemas.opengis.net/sos/</a>.</p></li>
</ul>
<p id="index-10"><strong>ows_updatesequence</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) The updateSequence parameter can be used for
maintaining the consistency of a client cache of the contents of a service
metadata document. The parameter value can be an integer, a timestamp in
[ISO 8601:2000] format, or any other number or string.</p></li>
</ul>
<p id="index-11"><strong>sos_abstract</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Descriptive narrative for more information about
the server.</p></li>
</ul>
<p id="index-12"><strong>sos_accessconstraints</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Text describing any access constraints imposed by
the service provider on the SOS or data retrieved from this service.</p></li>
</ul>
<p id="index-18"><span id="index-17"></span><span id="index-16"></span><span id="index-15"></span><span id="index-14"></span><span id="index-13"></span><strong>sos_addresstype, sos_address, sos_city, sos_country, sos_postcode, sos_stateorprovince</strong></p>
<ul class="simple">
<li><p><em>Description:</em> Optional contact address information. If provided then all
six metadata items are required.</p></li>
</ul>
<p id="index-19"><strong>sos_contactelectronicmailaddress</strong></p>
<ul class="simple">
<li><p><em>Description:</em> Optional contact Email address.</p></li>
</ul>
<p id="index-20"><strong>sos_contactfacsimiletelephone</strong></p>
<ul class="simple">
<li><p><em>Description:</em> Optional contact facsimile telephone number.</p></li>
</ul>
<p id="index-21"><strong>sos_contactinstructions</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Supplemental instructions on how or when
to contact the individual or organization.</p></li>
</ul>
<p id="index-24"><span id="index-23"></span><span id="index-22"></span><strong>sos_contactorganization, sos_contactperson, sos_contactposition</strong></p>
<ul class="simple">
<li><p><em>Description:</em> Optional contact information. If provided then all
three metadata items are required.</p></li>
</ul>
<p id="index-25"><strong>sos_contactvoicetelephone</strong></p>
<ul class="simple">
<li><p><em>Description:</em> Optional contact voice telephone number.</p></li>
</ul>
<p id="index-26"><strong>sos_enable_request</strong> (or <strong>ows_enable_request</strong>)</p>
<ul>
<li><p><em>Description:</em> Space separated list of requests to enable.
The default is none.
The following requests can be enabled:
<cite>GetCapabilities</cite>, <cite>GetObservation</cite> and <cite>DescribeSensor</cite>.
A “!” in front of a request will disable the request.
“*” enables all requests.</p></li>
<li><p><em>Examples:</em></p>
<p>To enable only <cite>GetCapabilities</cite> and <cite>GetObservation</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sos_enable_request&quot;</span> <span class="s2">&quot;GetCapabilities GetObservation&quot;</span>
</pre></div>
</div>
<p>To enable all requests except <cite>GetCapabilities</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sos_enable_request&quot;</span> <span class="s2">&quot;* !GetCapabilities&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-27"><strong>sos_encoding_blockSeparator</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) For GetObservation requests using
resultModel=om:Observation (SWE DataBlock encoding).  Record
separator to be used.  Default is ‘\n’</p></li>
</ul>
<p id="index-28"><strong>sos_encoding_tokenSeparator</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) For GetObservation requests using
resultModel=om:Observation (SWE DataBlock encoding).  Token (field)
separator to be used.  Default is ‘,’</p></li>
</ul>
<p id="index-29"><strong>sos_fees</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Fees information. Use the reserved word
“none” if there are no fees.</p></li>
</ul>
<p id="index-30"><strong>sos_hoursofservice</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Time period (including time zone) when
individuals can contact the organization or individual.</p></li>
</ul>
<p id="index-31"><strong>sos_keywordlist</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) A comma-separated list of keywords or keyword
phrases to help catalog searching.</p></li>
</ul>
<p id="index-32"><strong>sos_maxfeatures</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) The number of elements to be returned by
the SOS server. If the not set all observations are returned</p></li>
</ul>
<p id="index-33"><strong>sos_onlineresource</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Required) The URL that will be used to access this
OGC server.  This value is used in the GetCapabilities response.</p></li>
<li><p>See the section “Onlineresource URL” above for more information.</p></li>
</ul>
<p id="index-34"><strong>sos_role</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Function performed by the responsible
party. Possible values of this Role shall include the values and the
meanings listed in Subclause B.5.5 of ISO 19115:2003.</p></li>
</ul>
<p id="index-35"><strong>sos_service_onlineresource</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Top-level onlineresource URL.</p></li>
</ul>
<p id="index-36"><strong>sos_srs</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Required) Contains a list of EPSG projection codes
that should be advertized as being available for all layers in this
server. The value can contain one or more EPSG:&lt;code&gt; pairs
separated by spaces (e.g. “EPSG:4269 EPSG:4326”) This value should
be upper case (EPSG:3978…..not epsg:3978) to avoid problems with
case sensitive platforms.</p></li>
</ul>
<p id="index-37"><strong>sos_title</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Recommended) A human-readable name for this Layer.</p></li>
</ul>
</section>
<section id="layer-object-metadata">
<span id="index-38"></span><h3>Layer Object Metadata<a class="headerlink" href="#layer-object-metadata" title="Link to this heading">¶</a></h3>
<dl class="simple" id="index-39">
<dt><strong>ows_allowed_ip_list</strong></dt><dd><p>Same as ows_allowed_ip_list in the Web Object.</p>
</dd>
</dl>
<dl class="simple" id="index-40">
<dt><strong>ows_denied_ip_list</strong></dt><dd><p>Same as ows_denied_ip_list in the Web Object.</p>
</dd>
</dl>
<p id="index-41"><strong>sos_describesensor_url</strong></p>
<ul>
<li><p><em>Description:</em> (Required) This metadata item is only a temporary
measure until the describe sensor is generated from MapServer. Right
now when a DescribeSensor request is sent with a procedure
(sensorid), it will redirect it to the url defined by this metadata
item.</p></li>
<li><p>In MapServer 5.0, it is possible to use variable substitution on the
url. For example “sos_describesensor_url”
&quot;http://foo/foo?mysensor=%procedure%&quot;will substitute the
%procedure% in the metadata with the procedure value coming from the
request.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sos_describesensor_url&quot;</span> <span class="s2">&quot;http://some/url/NS01EE0014.xml&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-42"><strong>sos_enable_request</strong> (or <strong>ows_enable_request</strong>)</p>
<ul>
<li><p><em>Description:</em> Space separated list of requests to enable.
The default is none.
The following requests can be enabled:
<cite>GetCapabilities</cite>, <cite>GetObservation</cite> and <cite>DescribeSensor</cite>.
A “!” in front of a request will disable the request.
“*” enables all requests.</p></li>
<li><p><em>Examples:</em></p>
<p>To enable only <cite>GetCapabilities</cite> and <cite>GetObservation</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sos_enable_request&quot;</span> <span class="s2">&quot;GetCapabilities GetObservation&quot;</span>
</pre></div>
</div>
<p>To enable all requests except <cite>GetCapabilities</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sos_enable_request&quot;</span> <span class="s2">&quot;* !GetCapabilities&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-43"><strong>sos_[item name]_alias</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) An alias for an attribute’s name that will
be returned when executing a GetObservation request.</p></li>
</ul>
<p id="index-44"><strong>sos_[item name]_definition</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) An associated definition (usually a URN)
for a component, that will be returned when executing a
GetObservation request.  Default is &quot;urn:ogc:object:definition&quot;</p></li>
</ul>
<p id="index-45"><strong>sos_[item name]_uom</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) An associated unit of measure URN) for a
component, that will be returned when executing a GetObservation
request.  Default is &quot;urn:ogc:object:uom&quot;</p></li>
</ul>
<p id="index-46"><strong>sos_observedproperty_authority</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) An associated authority for a given
component of an observed property</p></li>
</ul>
<p id="index-47"><strong>sos_observedproperty_id</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Required) ID of observed property, possibly in number format.</p></li>
</ul>
<p id="index-48"><strong>sos_observedproperty_name</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Name of observed property, possibly in
string format.</p></li>
</ul>
<p id="index-49"><strong>sos_observedproperty_version</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) An associated version for a given
component of an observed property</p></li>
</ul>
<p id="index-50"><strong>sos_offering_description</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Description of offering.</p></li>
</ul>
<p id="index-51"><strong>sos_offering_extent</strong></p>
<ul>
<li><p><em>Description:</em> (Optional) Spatial extents of offering, in <em>minx,
miny, maxx, maxy</em> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sos_offering_extent&quot;</span> <span class="s2">&quot;-66, 43, -62, 45&quot;</span>
</pre></div>
</div>
<p>The logic for the bounding box returned as part of the offering is
the following:</p>
<ul class="simple">
<li><p>note that it is a mandatory element that needs an espg code and
lower/upper corner coordinates</p></li>
<li><p>looks for the espg parameter in the first layer of the offering
(this could be an ows/sos_srs or a projection object with the
epsg code (mandatory)</p></li>
<li><p>looks for sos_offering_extent. If the metadata is not available,
the extents of all layers in the offering will be used to compute it.</p></li>
</ul>
<p>Here is an example result from a GetCapabilities request:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;gml:boundedBy&gt;</span>
<span class="w">  </span><span class="nt">&lt;gml:Envelope&gt;</span>
<span class="w">    </span><span class="nt">&lt;gml:lowerCorner</span><span class="w"> </span><span class="na">srsName=</span><span class="s">&quot;EPSG:4326&quot;</span><span class="nt">&gt;</span>-66<span class="w"> </span>43<span class="nt">&lt;/gml:lowerCorner&gt;</span>
<span class="w">    </span><span class="nt">&lt;gml:upperCorner</span><span class="w"> </span><span class="na">srsName=</span><span class="s">&quot;EPSG:4326&quot;</span><span class="nt">&gt;</span>-62<span class="w"> </span>45<span class="nt">&lt;/gml:upperCorner&gt;</span>
<span class="w">  </span><span class="nt">&lt;/gml:Envelope&gt;</span>
<span class="nt">&lt;/gml:boundedBy&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-52"><strong>sos_offering_id</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Required) ID of offering, possibly in number format.</p></li>
</ul>
<p id="index-53"><strong>sos_offering_intendedapplication</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) The intended category of use for this offering.</p></li>
</ul>
<p id="index-54"><strong>sos_offering_name</strong></p>
<ul class="simple">
<li><p><em>Description:</em> (Optional) Name of offering, possibly in string format.</p></li>
</ul>
<p id="index-55"><strong>sos_offering_timeextent</strong></p>
<ul>
<li><p><em>Description:</em> (Optional) Time extent of offering, in the format of
“begin/end”.  Here is an example:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;sos_offering_timeextent&quot;</span> <span class="s">&quot;1990/2006&quot;</span>
</pre></div>
</div>
<p>If end is not specified it will be set to now.  Here is an example
result from a GetCapabilities request:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sos:eventTime&gt;</span>
<span class="w">  </span><span class="nt">&lt;gml:TimePeriod&gt;</span>
<span class="w">     </span><span class="nt">&lt;gml:beginPosition&gt;</span>1990<span class="nt">&lt;/gml:beginPosition&gt;</span>
<span class="w">     </span><span class="nt">&lt;gml:endPosition&gt;</span>2006<span class="nt">&lt;/gml:endPosition&gt;</span>
<span class="w">  </span><span class="nt">&lt;/gml:TimePeriod&gt;</span>
<span class="nt">&lt;/sos:eventTime&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-56"><strong>sos_procedure</strong></p>
<ul>
<li><p><em>Description:</em> (Required) Normally a sensor unique id.  One per layer:</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;sos_procedure&quot;</span>  <span class="s">&quot;NS01EE0014&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>sos_procedure can also be a list, separated by spaces, i.e.:</p>
</div>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;sos_procedure&quot;</span> <span class="s">&quot;35 2147 604&quot;</span>
</pre></div>
</div>
<p>All <em>sos_procedure</em> links from layers in the offerings will be
outputed together, such as the following taken from a
GetCapabilities response:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;procedure</span><span class="w"> </span><span class="na">xlink:href=</span><span class="s">&quot;urn:ogc:object:feature:Sensor:3eTI:csi-sensor-1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;procedure</span><span class="w"> </span><span class="na">xlink:href=</span><span class="s">&quot;urn:ogc:object:feature:Sensor:3eTI:csi-sensor-2&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-57"><strong>sos_procedure_item</strong></p>
<ul>
<li><p><em>Description:</em> (Required if sos_procedure is not present): See
section 5 for more details</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;sos_procedure_item&quot;</span>  <span class="s">&quot;attribute_field_name&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p id="index-58"><strong>sos_timeitem</strong></p>
<ul>
<li><p><em>Description:</em> (Optional) Name of the time field. It will be used
for queries when a GetObservation request is called with an
EVENTTIME parameter.  It is layer specific and should be set on all
layers.</p>
<div class="highlight-mapfile notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;sos_timeitem&quot;</span> <span class="s">&quot;TIME&quot;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="layer-metadata-api">
<h3>Layer Metadata API<a class="headerlink" href="#layer-metadata-api" title="Link to this heading">¶</a></h3>
<p>If <cite>sos_metadataurl_href</cite> is not defined, MapServer will provide a link to
the Layer Metadata API for the given layer. See the
<a class="reference internal" href="layer_metadata.html#layer-metadata"><span class="std std-ref">Layer Metadata API</span></a> documentation for more information.</p>
</section>
</section>
<section id="use-of-sos-procedure-and-sos-procedure-item">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Use of sos_procedure and sos_procedure_item</a><a class="headerlink" href="#use-of-sos-procedure-and-sos-procedure-item" title="Link to this heading">¶</a></h2>
<p>In MapServer 5.0 SOS support has been upgraded to use a new metadata called
sos_procedure_item. The value for sos_procedure_item is the field/attribute
name containing the procedure values. The use of this metadata as well as the
sos_procedure is described here per type of request (refer to
<a class="reference external" href="https://github.com/MapServer/MapServer/issues/2050">https://github.com/MapServer/MapServer/issues/2050</a> for more description):</p>
<p>It should be noted that, for very large datasets defined only with
sos_procedure_item, this may result in costly processing, because MapServer
has to process attribute data. It is advised to setup and manage datasets
accordingly if dealing with large observation collections.</p>
<section id="getcapabilities">
<h3>GetCapabilities<a class="headerlink" href="#getcapabilities" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>if sos_procedure is defined, use it</p></li>
<li><p>if not look for sos_procedure_item :  procedure values are extracted
from the layer’s attribute specified by this metadata. Not that this
can be time consuming for layers with a large number of features.</p></li>
<li><p>if none is defined return an exception</p></li>
</ul>
</section>
<section id="describesensor">
<h3>DescribeSensor<a class="headerlink" href="#describesensor" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>if sos_procedure  is defined, use it</p></li>
<li><p>if not look for sos_procedure_item :  procedure values are extracted
from the layer’s attribute specified by this metadata</p></li>
<li><p>if none is defined return an exception</p></li>
</ul>
</section>
<section id="getobservation">
<h3>GetObservation<a class="headerlink" href="#getobservation" title="Link to this heading">¶</a></h3>
<p>Both sos_procedure and sos_procedure_item can be define. Here are the cases:</p>
<ul class="simple">
<li><dl class="simple">
<dt>case 1<span class="classifier">only sos_procedure is defined.</span></dt><dd><ul>
<li><p>Use this metadata to match the layer with the procedure value
sent in the request</p></li>
<li><p>When outputting the &lt;member/procedure&gt; output the value of the metadata</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If more than one procedure is defined per LAYER object, output
observations will have incorrect sos:procedure values, because there is no
way to map procedures to observations. This is where sos_procedure_item
should be used (i.e. when more than one procedure makes up a LAYER
object).</p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>case 2: only procedure_item is defined.</dt><dd><ul>
<li><p>Use the sos_procedure_item and do a query on the layer to match the
procedure with the layer.</p></li>
<li><p>When outputting the &lt;member/procedure&gt; use the procedure_item as a way
to only output the attribute value corresponding to the feature.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>case 3: both are defined.</dt><dd><ul>
<li><p>check in sos_procedure to match the procedure with the layer.</p></li>
<li><p>When outputting the &lt;member/procedure&gt; use the procedure_item as a
way to only output the attribute value corresponding to the feature.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">SOS Server</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#links-to-sos-related-information">Links to SOS-Related Information</a></li>
<li><a class="reference internal" href="#relevant-definitions">Relevant Definitions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-up-an-sos-server-using-mapserver">Setting Up an SOS Server Using MapServer</a><ul>
<li><a class="reference internal" href="#install-the-required-software">Install the Required Software</a></li>
<li><a class="reference internal" href="#configure-a-mapfile-for-sos">Configure a Mapfile For SOS</a><ul>
<li><a class="reference internal" href="#onlineresource-url">Onlineresource URL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-sos-server-mapfile">Example SOS Server Mapfile</a></li>
<li><a class="reference internal" href="#test-your-sos-server">Test Your SOS Server</a><ul>
<li><a class="reference internal" href="#getcapabilities-request">GetCapabilities Request</a></li>
<li><a class="reference internal" href="#getobservation-request">GetObservation Request</a></li>
<li><a class="reference internal" href="#describesensor-request">DescribeSensor Request</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#limitations-todo">Limitations / TODO</a></li>
<li><a class="reference internal" href="#reference-section">Reference Section</a><ul>
<li><a class="reference internal" href="#web-object-metadata">Web Object Metadata</a></li>
<li><a class="reference internal" href="#layer-object-metadata">Layer Object Metadata</a></li>
<li><a class="reference internal" href="#layer-metadata-api">Layer Metadata API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-of-sos-procedure-and-sos-procedure-item">Use of sos_procedure and sos_procedure_item</a><ul>
<li><a class="reference internal" href="#getcapabilities">GetCapabilities</a></li>
<li><a class="reference internal" href="#describesensor">DescribeSensor</a></li>
<li><a class="reference internal" href="#getobservation">GetObservation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="mapscript.html" title="MapScript Wrappers for WxS Services"
             >next</a> |</li>
        <li class="right" >
          <a href="wcs_format.html" title="WCS Use Cases"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >OGC Support and Configuration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">SOS Server</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>