<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Compiling on Win32 &#8212; MapServer 8.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx.css?v=6c7b17ac" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=dd298242" />
    <link rel="stylesheet" type="text/css" href="../_static/ribbon.css?v=ea091bf4" />
    
    <script src="../_static/documentation_options.js?v=521b6f53"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="PHP MapScript Installation" href="php.html" />
    <link rel="prev" title="Compiling on Unix" href="unix.html" /> 
  </head><body>


<!-- for main branch only, do not backport this -->

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        <img src="../_static/flagicons/en.png" alt="en" title="en" border="0" width="18px" height="13px"/>
        
          <a href="../ar/installation/win32.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
        
        
          <a href="../de/installation/win32.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
        
        
          <a href="../el/installation/win32.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
        
        
          <a href="../es/installation/win32.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
        
        
          <a href="../fr/installation/win32.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
        
        
          <a href="../id/installation/win32.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
        
        
          <a href="../it/installation/win32.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
        
        
          <a href="../ja/installation/win32.html"><img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" /></a>
        
        
          <a href="../nl_NL/installation/win32.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
        
        
          <a href="../pl/installation/win32.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
        
        
          <a href="../ru/installation/win32.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
        
        
          <a href="../sq/installation/win32.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
        
        
          <a href="../tr/installation/win32.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="php.html" title="PHP MapScript Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="unix.html" title="Compiling on Unix"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Installation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Compiling on Win32</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="compiling-on-win32">
<span id="win32"></span><span id="index-1"></span><span id="index-0"></span><h1><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Compiling on Win32</a><a class="headerlink" href="#compiling-on-win32" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pericles Nacionales</p>
</dd>
<dt class="field-even">Contact<span class="colon">:</span></dt>
<dd class="field-even"><p>pnaciona at gmail.com</p>
</dd>
</dl>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#compiling-on-win32" id="id1">Compiling on Win32</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#compiler-requirements" id="id3">Compiler Requirements</a></p></li>
<li><p><a class="reference internal" href="#compiling" id="id4">Compiling</a></p></li>
<li><p><a class="reference internal" href="#set-up-a-project-directory" id="id5">Set up a Project Directory</a></p></li>
<li><p><a class="reference internal" href="#download-mapserver-source-code-and-supporting-libraries" id="id6">Download MapServer Source Code and Supporting Libraries</a></p></li>
<li><p><a class="reference internal" href="#the-mapserver-source-code" id="id7">The MapServer source code</a></p></li>
<li><p><a class="reference internal" href="#set-compilation-options" id="id8">Set Compilation Options</a></p></li>
<li><p><a class="reference internal" href="#compile-the-libraries" id="id9">Compile the Libraries</a></p></li>
<li><p><a class="reference internal" href="#compile-mapserver" id="id10">Compile MapServer</a></p></li>
<li><p><a class="reference internal" href="#compiling-mapserver-with-postgis-support" id="id11">Compiling MapServer with PostGIS support</a></p></li>
<li><p><a class="reference internal" href="#common-compiling-errors" id="id12">Common Compiling Errors</a></p></li>
<li><p><a class="reference internal" href="#installation" id="id13">Installation</a></p></li>
<li><p><a class="reference internal" href="#other-helpful-information" id="id14">Other Helpful Information</a></p></li>
<li><p><a class="reference internal" href="#acknowledgements" id="id15">Acknowledgements</a></p></li>
</ul>
</li>
</ul>
</nav>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This part of the documentation is outdated.
<em>nmake</em> is no longer used.
<em>cmake</em> is used also for Win32.
<em>cmake</em> instructions can be found on
<a class="reference external" href="https://github.com/MapServer/MapServer/blob/main/README.WIN32">https://github.com/MapServer/MapServer/blob/main/README.WIN32</a>.
See also <a class="reference external" href="https://github.com/MapServer/MapServer/blob/main/appveyor.yml">https://github.com/MapServer/MapServer/blob/main/appveyor.yml</a>.</p>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>This document provides a simple set of compilation procedures for MapServer
on Win32 platforms.</p>
<p>If you’ve made it this far, chances are you already know about MapServer and
are at least tempted to try compiling it for yourself.
Pre-compiled binaries for MapServer are available from a variety of
sources.  Refer to <a class="reference internal" href="../download.html#windows"><span class="std std-ref">Windows</span></a>.  Building MapServer
for win32 platforms can be a daunting task, so if existing binaries are
sufficient for your needs, it is strongly advised that they be used in
preference to trying to build everything from source.</p>
<p>However, there can be a variety of reasons to want to build MapServer from
source on win32.  Reasons include the need to enable specific options, to
build with alternate versions of support libraries (such as GDAL), the
desire for MapScript support not part of the core builds, the need to debug
and fix bugs or even to implement new features in MapServer.  To make it
easy for users and developers, I’ve made a list of steps to compile
MapServer. Background information is provided in each step, along with
examples. Each example is a continuation of the previous one and in the end
will produce the MapServer DLL (libmap.dll), the CGI program (the
mapserv.exe), and utility programs.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document may refer to older library versions.  You may want to try
to use more recent library versions for your build.</p>
</div>
</section>
<section id="compiler-requirements">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Compiler Requirements</a><a class="headerlink" href="#compiler-requirements" title="Link to this heading">¶</a></h2>
<p>As of MapServer 8.0, a C++11 and C99 capable compiler is required to build
MapServer. This means for example using Microsoft Visual Studio 2015 or more
recent.</p>
</section>
<section id="compiling">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Compiling</a><a class="headerlink" href="#compiling" title="Link to this heading">¶</a></h2>
<p>If you are new to Windows programming, please follow this
document carefully. The compilation steps are fairly simple but I’ve added a
few blurbs in each step to help you understand how MapServer compiles. For
the more experienced programmers, perhaps reading the README.Win32
that accompanies the MapServer source code would be more useful.  For those
who are antsy, compiling MapServer involves download and unpacking the source
codes, editing the make files, and invoking Microsoft’s Visual C++ compiler
from the command prompt. The resulting mapserv.exe is the CGI program that
installs in the cgi-bin directory of your web server.</p>
<p>For those who are willing to take the time, the compilation steps follow.</p>
</section>
<section id="set-up-a-project-directory">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Set up a Project Directory</a><a class="headerlink" href="#set-up-a-project-directory" title="Link to this heading">¶</a></h2>
<p>Before you start to compile MapServer, I recommend creating a directory
called “projects” where you can put the source code for MapServer and its
supporting libraries. Since you will be working with DOS-style commands,
you might as well get used to the Windows command prompt. For Windows 95/98
users the command processor would be called command.com. For Windows
NT/2000/XP, it would be cmd.exe. So fire up the old command prompt and go to
the drive where you want to create the project directory.</p>
<p>Here is an example of how to create a directory called projects on the C: drive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span><span class="o">&gt;</span> <span class="n">mkdir</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>
</pre></div>
</div>
<p>To go to that directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span><span class="o">&gt;</span> <span class="n">cd</span> \<span class="n">Projects</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>From the projects directory, you can extract the source codes for MapServer
and its libraries. Now you’re ready to download the source codes.</p>
</section>
<section id="download-mapserver-source-code-and-supporting-libraries">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Download MapServer Source Code and Supporting Libraries</a><a class="headerlink" href="#download-mapserver-source-code-and-supporting-libraries" title="Link to this heading">¶</a></h2>
<p>After creating a project directory, download the MapServer source code
and the codes for the supporting libraries and save the source code packages
in the newly created “projects” directory. These source codes are usually
packaged as ZIP, or as UNIX TAR and GZIP files.  You’ll need a software that
can unzip these packages. <a class="reference external" href="http://www.7-zip.org/">7-Zip</a> is an example of software that can handle
these files.</p>
<p>Cygwin is a free, open-source software package which is a port of these tools
on Windows. You can use the gzip and tar utilities from this tool collection.
Cygwin is available from
<a class="reference external" href="http://www.cygwin.com">http://www.cygwin.com</a>.</p>
<p>In order to compile the MapServer CGI program, you must download a few
required and optional libraries. At its simplest configuration, MapServer
only requires the GD (to provide the image output) and REGEX (to provide
regular expression support) libraries. This configuration allows the
developer/data provider to use shapefiles as input and, depending on the
version of GD library used, GIF or PNG images as output.  Additional
libraries are needed for input data in alternative formats. The libraries
that work with MapServer are listed below.</p>
</section>
<section id="the-mapserver-source-code">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">The MapServer source code</a><a class="headerlink" href="#the-mapserver-source-code" title="Link to this heading">¶</a></h2>
<p>The MapServer source code can be downloaded from the
<a class="reference internal" href="../download.html#download"><span class="std std-ref">download page</span></a>. If you’d like to get the current development
version of the software, following the nightly snapshot link under the
Interim Builds title. The absolute latest copy of the source code can be
obtained from <a class="reference internal" href="../development/git.html#git"><span class="std std-ref">GitHub</span></a>; however, the GitHub repository does not contain several
important source files (maplexer.c, mapparser.c and
mapparser.h) normally generated on unix, so if possible, using a nightly
snaphot is substantially easier than working directly from <a class="reference internal" href="../development/git.html#git"><span class="std std-ref">GitHub</span></a>.</p>
<section id="required-libraries">
<h3><strong>Required Libraries</strong><a class="headerlink" href="#required-libraries" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><a class="reference external" href="http://www.libgd.org/">GD Library</a>:</dt><dd><p>MapServer uses the GD graphics library for rendering map images in GIF, PNG
and JPEG format. These map images are displayed in web browser clients using
the MapServer CGI. The current official version of GD is 2.0.33.  The
distributed makefiles are setup to use the prebuilt GD Win32 DLL binaries
which include GD, libjpeg, libpng, libz, libgif and FreeType 2 all within one
DLL.  This package is generally listed as “Windows DLL .zip”
and the latest version is normally available at
<a class="reference external" href="http://www.boutell.com/gd/http/gdwin32.zip">http://www.boutell.com/gd/http/gdwin32.zip</a>.</p>
</dd>
<dt>Regex:</dt><dd><p>Regex is the regular expression library used by MapServer. It can be downloaded at
<a class="reference external" href="http://ftp.gnu.org/old-gnu/regex/regex-0.12.tar.gz">http://ftp.gnu.org/old-gnu/regex/regex-0.12.tar.gz</a></p>
</dd>
</dl>
</section>
<section id="optional-libraries">
<h3>Optional Libraries<a class="headerlink" href="#optional-libraries" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><a class="reference external" href="http://www.ijg.org/">JPEG library</a>:</dt><dd><p>This library is required by GD to render JPEG images, if building GD from
source.  You may download this library at
<a class="reference external" href="http://www.ijg.org/files/jpegsrc.v6b.tar.gz">http://www.ijg.org/files/jpegsrc.v6b.tar.gz</a></p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference external" href="http://www.libpng.org/pub/png/">PNG library</a>:</dt><dd><p>This library is required by GD to render PNG images, if building GD from
source.  You may download this library at
<a class="reference external" href="http://sourceforge.net/projects/libpng/">http://sourceforge.net/projects/libpng/</a></p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference external" href="https://zlib.net/">Zlib</a>:</dt><dd><p>This library is required by libpng to provide graphics
compression support.  It can be downloaded at
<a class="reference external" href="https://zlib.net/">https://zlib.net/</a> .</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference external" href="http://www.freetype.org/">FreeType 2</a>:</dt><dd><p>FreeType provides TrueType support in MapServer via GD.  We only need to
build FreeType separately if building GD from source.  It can be downloaded
at <a class="reference external" href="http://gnuwin32.sourceforge.net/packages/freetype.htm">http://gnuwin32.sourceforge.net/packages/freetype.htm</a> .</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference external" href="https://proj.org">PROJ</a>:</dt><dd><p>PROJ provides on-the-fly projection support to MapServer.  Users whose data
are in different projection systems can use this library to reproject into a
common projection.  It is also required for WMS, WFS or WCS services.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference external" href="https://gdal.org/">GDAL/OGR</a>:</dt><dd><p>The GDAL/OGR library allows MapServer to read a variety of geospatial
raster formats (GDAL) and vector formats (OGR).  It can be downloaded at
<a class="reference external" href="https://gdal.org/">https://gdal.org/</a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><a class="reference external" href="http://www.esri.com/software/arcgis/arcsde/">ArcSDE</a>:</dt><dd><p>ArcSDE is an ESRI proprietary spatial database engine.  Most users will not
have access to it but if you have ArcSDE license, you can use its libraries
to give MapServer access to SDE databases.</p>
</dd>
<dt>EPPL7:</dt><dd><dl class="simple">
<dt>This library allows MapServer to read EPPL7 (“Environmental Planning and Programming</dt><dd><p>Language”) datasets, as well as the older Erdas LAN/GIS files. This library is set
as a default library in MapServer so there’s no special source code to download.</p>
</dd>
</dl>
</dd>
</dl>
<p>Now that you have reviewed the libraries that provide support to MapServer, it
is time to decide which ones to compile and use.   We will work with the
pre-built GD distributed on Boutell.com with PNG, GIF, JPEG, and FreeType
“built in”.   If you want to provide OGC Web Services (ie. WMS, WFS) or want to
perform on the fly reprojection then the PROJ library will be needed.  If you
need additional raster and vector data sources consider including GDAL/OGR
support.  GDAL is also required for WCS service.</p>
<p>Our example calls for the required libraries and on-the-fly projection support
so we need to download GD, regex, and PROJ libraries.  Go ahead and get those
libraries.</p>
</section>
</section>
<section id="set-compilation-options">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Set Compilation Options</a><a class="headerlink" href="#set-compilation-options" title="Link to this heading">¶</a></h2>
<p>MapServer, like many of it’s support libraries, comes with a Visual C++
makefile called Makefile.vc.  It includes the file nmake.opt which contains
many of the site specific definitions.  We will only need to edit the nmake.opt
file to configure the build for our local site options, and support libraries.
The Makefile.vc, and nmake.opt template file have been provided by Assefa
Yewondwossen, and the DM Solutions folks.</p>
<p>As of MapServer 4.4, the default MapServer build options only include
GD, and regex.  MapServer is built using the /MD option (which means
MSVCRT.DLL should be used), so if any support libraries are being built
statically (rather than as DLLs) we need to use /MD when building them as
well.  By default modern PROJ builds use /MD so we should be able to
use the default PROJ build without tweaking.</p>
<p>The example will compile with the GDWin32 pre-built DLL as well as regex-0.12,
and PROJ.   The PROJ support will ensure we can enable
MapServer OGC-WMS compatibility.  Use notepad or another text editor to open
the nmake.opt file and make the following changes.</p>
<section id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Link to this heading">¶</a></h3>
<p>Use the pound sign ( # ) to comment out
the lines that you want to disable, or remove the pound sign to enable
an option for NMAKE.</p>
<p>A. Enable PROJ support, and update the path to the PROJ
directory.   Uncomment the PROJ= line, and the PROJ_DIR= line as follows,
and update the PROJ_DIR path to point to your PROJ build.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reprojecting.</span>
<span class="c1"># If you would like MapServer to be able to reproject data from one</span>
<span class="c1"># geographic projection to another, uncomment the following flag</span>
<span class="c1"># PROJ distribution (cartographic projection routines).  PROJ is</span>
<span class="c1"># also required for all OGC services (WMS, WFS, and WCS).</span>
<span class="c1">#</span>
<span class="c1"># For PROJ_DIR use full path to PROJ distribution</span>
<span class="n">PROJ</span><span class="o">=-</span><span class="n">DUSE_PROJ</span> <span class="o">-</span><span class="n">DUSE_PROJ_API_H</span>
<span class="n">PROJ_DIR</span><span class="o">=</span><span class="n">c</span><span class="p">:</span>\<span class="n">projects</span>\<span class="n">proj</span><span class="o">-</span><span class="mf">4.4.9</span>
</pre></div>
</div>
<p>If you look down later in the file, you can see that once PROJ is enabled,
MapServer will be linked with proj_i.lib, the PROJ stub library, meaning
that MapServer will be using the PROJ.DLL as opposed to statically linking
in PROJ.</p>
<ol class="upperalpha simple" start="2">
<li><p>Uncomment the WMS option.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use this flag to compile with WMS Server support.</span>
<span class="c1"># To find out more about the OpenGIS Web Map Server Specification go to</span>
<span class="c1"># http://www.opengis.org/</span>
<span class="n">WMS</span><span class="o">=-</span><span class="n">DUSE_WMS_SVR</span>
</pre></div>
</div>
<ol class="upperalpha simple" start="3">
<li><p>Update to use GD.  Here’s what it should look like in our example.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>GD_DIR=c:/projects/gdwin32
GD_LIB=$(GD_DIR)/bgd.lib
</pre></div>
</div>
<p><strong>Note</strong>: As distributed the GDWin32 binary build does not include the
bgd.lib stub library.  It is necessary to run the <strong>makemsvcimport.bat</strong>
script in the gdwin32 directory first.</p>
<p>D. Make sure the regex path is set correctly.  In order for the
“delete” command in the “nmake /f makefile.vc clean” target to work properly
it is necessary to use backslashes in the REGEX_DIR definition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># REGEX Library
#
# VC++ does not include the REGEX library... so we must provide our one.
# The following definitions will try to build GNU regex-0.12 located in the
# regex-0.12 sub-directory.
# If it was not included in the source distribution, then you can get it from:

#    ftp://ftp.gnu.org/pub/gnu/regex/regex-0.12.tar.gz
# Provide the full path to the REGEX project directory
# You do not need this library if you are compiling for PHP mapscript.
# In that case the PHP regex library will be used instead
!IFNDEF PHP
REGEX_DIR=c:\projects\regex-0.12
!ENDIF
</pre></div>
</div>
<p>Your Makefile is now set.</p>
</section>
</section>
<section id="compile-the-libraries">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Compile the Libraries</a><a class="headerlink" href="#compile-the-libraries" title="Link to this heading">¶</a></h2>
<p>Before compiling MapServer, you must first compile its supporting
libraries.  How this is done varies for each library.  For the PROJ library
a <strong>nmake /f makefile.vc</strong> command in the proj-4.4.9src
directory should be sufficient.  The regex-0.12 code is actually built by
the MapServer build process, so you don’t need to do anything there.</p>
<section id="compiling-libcurl">
<h3>Compiling libcurl<a class="headerlink" href="#compiling-libcurl" title="Link to this heading">¶</a></h3>
<p>Previously, curl libraries can be compiled using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nmake</span> <span class="o">/</span><span class="n">f</span> <span class="n">makefile</span><span class="o">.</span><span class="n">vc6</span> <span class="n">CFG</span><span class="o">=</span><span class="n">release</span>
</pre></div>
</div>
<p>This creates a static library, libcurl.lib, to which you compile against.
Versions newer than version 7.10.x should be compiled as dynamic library.  This
is accomplished using the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nmake</span> <span class="o">/</span><span class="n">f</span> <span class="n">makefile</span><span class="o">.</span><span class="n">vc6</span> <span class="n">CFG</span><span class="o">=</span><span class="n">release</span><span class="o">-</span><span class="n">dll</span>
</pre></div>
</div>
<p>You will then need to edit MapServer’s nmake.opt to replace the CURL_LIB variable with this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CURL_LIB = $(CURL_DIR)/lib/libcurl_imp.lib
</pre></div>
</div>
</section>
</section>
<section id="compile-mapserver">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Compile MapServer</a><a class="headerlink" href="#compile-mapserver" title="Link to this heading">¶</a></h2>
<p>Once you have compiled the supporting libraries successfully, you are ready to
take the final compilation step.  If you have not already done so, open a
command prompt and set the VC++ environment variables by running the
vcvars32.bat usually located in <strong>C:Program FilesMicrosoft Visual StudioVC98binvcvars32.bat</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span><span class="o">&gt;</span> <span class="n">cd</span> \<span class="n">projects</span>\<span class="n">MapServer</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>\<span class="n">MapServer</span><span class="o">&amp;&gt;</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">Visual</span> <span class="n">Studio</span>\<span class="n">VC98</span>\<span class="n">Bin</span>\<span class="n">vcvars32</span><span class="o">.</span><span class="n">bat</span><span class="s2">&quot;</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>\<span class="n">MapServer</span><span class="o">&gt;</span>

<span class="n">Setting</span> <span class="n">environment</span> <span class="k">for</span> <span class="n">using</span> <span class="n">Microsoft</span> <span class="n">Visual</span> <span class="n">C</span><span class="o">++</span> <span class="n">tool</span><span class="o">.</span>
<span class="n">C</span><span class="p">:</span>\<span class="n">Projects</span>\<span class="n">MapServer</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now issue the command: <strong>nmake /f Makefile.vc</strong> and wait
for it to finish compiling. If it compiles successfully, you should get
mapserver.lib, libmap.dll, mapserv.exe, and other .EXE files.  That’s it for
the compilation process. If you run into problems, read section 4 about
compiling errors. You can also ask for help from the helpful folks in the
MapServer-dev e-mail list.</p>
</section>
<section id="compiling-mapserver-with-postgis-support">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Compiling MapServer with PostGIS support</a><a class="headerlink" href="#compiling-mapserver-with-postgis-support" title="Link to this heading">¶</a></h2>
<p>To compile PostGIS support into MapServer, here’s what you need to do:</p>
<ol class="arabic simple">
<li><p>download the PostgreSQL 8.0.1 (or later) source from:
<a class="reference external" href="ftp://ftp.heanet.ie/pub/postgresql/source/">ftp://ftp.heanet.ie/pub/postgresql/source/</a></p></li>
<li><p>I extracted them to C:projectspostgresql-8.0.1</p></li>
<li><p>download the <a class="reference external" href="https://developer.microsoft.com/en-us/windows/downloads">Microsoft Platform SDK</a>
otherwise you get link errors on shfolder.lib.</p></li>
<li><p>compile libpq under C:projectspostgresql-8.0.1srcinterfaceslibpq
using the win32.mak makefile</p></li>
<li><p>copy everything from C:projectspostgresql-8.0.1srcinterfaceslibpqrelease
to C:projectspostgresql-8.0.1srcinterfaceslibpq as the MapServer
makefile will try to find it there</p></li>
<li><p>Define the following in the nmake.opt for MapServer:
POSTGIS =-DUSE_POSTGIS
POSTGIS_DIR =c:/projects/postgresql-8.0.1/src</p></li>
<li><p>nmake /f makefile.vc</p></li>
<li><p>don’t forget to copy libpq.dll (from
C:projectspostgresql-8.0.1srcinterfaceslibpqrelease)
into a location where MapServer can find it.</p></li>
</ol>
</section>
<section id="common-compiling-errors">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Common Compiling Errors</a><a class="headerlink" href="#common-compiling-errors" title="Link to this heading">¶</a></h2>
<p>Following are a few common errors you may encounter while trying to build
MapServer.</p>
<blockquote>
<div><ul>
<li><p>Visual C++ Tools Not Properly Initialized.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">projects</span>\<span class="n">MapServer</span><span class="o">&gt;</span> <span class="n">nmake</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">makefile</span><span class="o">.</span><span class="n">vc</span>
<span class="s1">&#39;nmake&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">recognized</span> <span class="k">as</span> <span class="n">an</span> <span class="n">internal</span> <span class="ow">or</span> <span class="n">external</span> <span class="n">command</span><span class="p">,</span>
<span class="n">operable</span> <span class="n">program</span> <span class="ow">or</span> <span class="n">batch</span> <span class="n">file</span><span class="o">.</span>
</pre></div>
</div>
<p>This occurs if you have not properly defined the path and other environment
variables required to use MS VisualC++ from the command shell.  Invoke the
VCVARS32.BAT script, usually with the command <strong>C:Program FilesMicrosoft
Visual StudioVC98binvcvars32.bat</strong> or something similar if visual studio was
installed in an alternate location.  To test if VC++ is available, just type
“nmake” or “cl” in the command shell and ensure it is found.</p>
</li>
<li><p>Regex Build Problems.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="o">.</span><span class="n">obj</span> <span class="p">:</span> <span class="n">error</span> <span class="n">LNK2001</span><span class="p">:</span> <span class="n">unresolved</span> <span class="n">external</span> <span class="n">symbol</span> <span class="n">_printchar</span>
<span class="n">libmap</span><span class="o">.</span><span class="n">dll</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">LNK1120</span><span class="p">:</span> <span class="mi">1</span> <span class="n">unresolved</span> <span class="n">externals</span>
<span class="n">NMAKE</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">U1077</span><span class="p">:</span> <span class="s1">&#39;link&#39;</span> <span class="p">:</span> <span class="k">return</span> <span class="n">code</span> <span class="s1">&#39;0x460&#39;</span>
<span class="n">Stop</span><span class="o">.</span>
</pre></div>
</div>
<p>This occurs if you use the stock regex-0.12 we referenced.  I work around
this by commenting out the “extern” statement for the printchar() function,
and replacing it with a stub implementation in regex-0.12regex.c.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">extern</span> <span class="n">void</span> <span class="n">printchar</span> <span class="p">();</span>
<span class="n">void</span> <span class="n">printchar</span><span class="p">(</span> <span class="nb">int</span> <span class="n">i</span> <span class="p">)</span> <span class="p">{}</span>
</pre></div>
</div>
</li>
<li><p>GD Import Library Missing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINK</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">LNK1104</span><span class="p">:</span> <span class="n">cannot</span> <span class="nb">open</span> <span class="n">file</span> <span class="s1">&#39;c:/projects/gdwin32/bgd.lib&#39;</span>
<span class="n">NMAKE</span> <span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span> <span class="n">U1077</span><span class="p">:</span> <span class="s1">&#39;link&#39;</span> <span class="p">:</span> <span class="k">return</span> <span class="n">code</span> <span class="s1">&#39;0x450&#39;</span>
<span class="n">Stop</span><span class="o">.</span>
</pre></div>
</div>
<p>If you are using the pre-built GD binaries, you still need to run the
<strong>makemsvcimport.bat</strong> script in the gdwin32 directory to
create a VC++ compatible stub library (bgd.lib).</p>
</li>
</ul>
</div></blockquote>
</section>
<section id="installation">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Installation</a><a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>The file we are most interested in is mapserv.exe. The other executable files are the MapServer utility programs.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../utilities/index.html#utilities"><span class="std std-ref">MapServer Utilities</span></a></p>
</div>
<p>to learn more about these utilities.</p>
<p>To test that the CGI program is working, type mapserv.exe at the command
prompt. You should see the following message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">script</span> <span class="n">can</span> <span class="n">only</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">decode</span> <span class="n">form</span> <span class="n">results</span> <span class="ow">and</span>
<span class="n">should</span> <span class="n">be</span> <span class="n">initiated</span> <span class="k">as</span> <span class="n">a</span> <span class="n">CGI</span> <span class="n">process</span> <span class="n">via</span> <span class="n">a</span> <span class="n">httpd</span> <span class="n">server</span><span class="o">.</span>
</pre></div>
</div>
<p>You may instead get a popup indicating that a DLL (such as bgd.dll) is
missing.  You will need to copy all the required DLLs (ie. bgd.dll, and
proj.dll) to the same directory as the mapserv.exe program.</p>
<p>Now type mapserv -v at the command prompt to get this message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MapServer</span> <span class="n">version</span> <span class="mf">4.4.0</span><span class="o">-</span><span class="n">beta3</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">GIF</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">PNG</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">JPEG</span> <span class="n">OUTPUT</span><span class="o">=</span><span class="n">WBMP</span>
<span class="n">SUPPORTS</span><span class="o">=</span><span class="n">PROJ</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">FREETYPE</span> <span class="n">SUPPORTS</span><span class="o">=</span><span class="n">WMS_SERVER</span> <span class="n">INPUT</span><span class="o">=</span><span class="n">SHAPEFILE</span>
<span class="n">DEBUG</span><span class="o">=</span><span class="n">MSDEBUG</span>
</pre></div>
</div>
<p>This tells us what data formats and other options are supported by
mapserv.exe. Assuming you have your web server set up, copy
mapserv.exe, libmap.dll, bgd.dll, proj.dll and any other required DLLs to the
cgi-bin directory.</p>
<p>You are now ready to download the demo application and try out your own
MapServer CGI program. If you wish, you can also create a directory to store
the utility programs.  I’d suggest making a subdirectory called “bin” under
the directory “projects” and copy the executables to that subdirectory. You
might find these programs useful as you develop MapServer applications.</p>
</section>
<section id="other-helpful-information">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Other Helpful Information</a><a class="headerlink" href="#other-helpful-information" title="Link to this heading">¶</a></h2>
<p>The MapServer Unix Compilation and Installation HOWTO has good descriptions of
some MapServer compilation options and library issues. I will write more about
those options and issues on the next revision of this HOWTO.</p>
<p>The README documents of each of the supporting libraries provide compilation
instructions for Windows.</p>
<p>The MapServer User community has a collective knowledge of the nuances of
MapServer compilation. Seek their advice wisely.</p>
</section>
<section id="acknowledgements">
<h2><a class="toc-backref" href="#table-of-contents" role="doc-backlink">Acknowledgements</a><a class="headerlink" href="#acknowledgements" title="Link to this heading">¶</a></h2>
<p>Thanks to Assefa Yewondwossen for providing the Makefile.vc.
I would not have been able to write this HOWTO without that file.</p>
<p>Thanks to Bart van den Eijnden for the libcurl and PostGIS compilation info.</p>
<p>Thanks to the Steve Lime for developing MapServer and to the many
developers who contribute time and effort in order to keep the MapServer
project successful.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
  <h3>Current Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">Compiling on Win32</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#compiler-requirements">Compiler Requirements</a></li>
<li><a class="reference internal" href="#compiling">Compiling</a></li>
<li><a class="reference internal" href="#set-up-a-project-directory">Set up a Project Directory</a></li>
<li><a class="reference internal" href="#download-mapserver-source-code-and-supporting-libraries">Download MapServer Source Code and Supporting Libraries</a></li>
<li><a class="reference internal" href="#the-mapserver-source-code">The MapServer source code</a><ul>
<li><a class="reference internal" href="#required-libraries"><strong>Required Libraries</strong></a></li>
<li><a class="reference internal" href="#optional-libraries">Optional Libraries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#set-compilation-options">Set Compilation Options</a><ul>
<li><a class="reference internal" href="#comments">Comments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compile-the-libraries">Compile the Libraries</a><ul>
<li><a class="reference internal" href="#compiling-libcurl">Compiling libcurl</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compile-mapserver">Compile MapServer</a></li>
<li><a class="reference internal" href="#compiling-mapserver-with-postgis-support">Compiling MapServer with PostGIS support</a></li>
<li><a class="reference internal" href="#common-compiling-errors">Common Compiling Errors</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#other-helpful-information">Other Helpful Information</a></li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="php.html" title="PHP MapScript Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="unix.html" title="Compiling on Unix"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 8.0.1 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Installation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Compiling on Win32</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; <a href="../copyright.html">Copyright</a> 2023, Open Source Geospatial Foundation.
      Last updated on 2023-12-22.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>