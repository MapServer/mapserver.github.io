
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sample: WFS-T with TinyOWS and OpenLayers &#8212; MapServer 7.6.2 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <link rel="shortcut icon" href="../_static/mapserver.ico"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="Server Tuning: How to speed up your TinyOWS server" href="servertuning.html" />
    <link rel="prev" title="Configuring TinyOWS with a standard Mapfile" href="mapfileconfig.html" /> 
  </head><body>

<table width="100%" style="width: 100%; background-color: white;">
  <tr>
    <td rowspan="2" style="padding: 10px 0px 10px 10px;">
      <a href="../index.html" title="Home"><img src="../_static/banner.png" alt="MapServer banner" border="0" /></a>
    </td>
    <td style="padding: 10px 10px 0px 0px; text-align: right; vertical-align: top;">
      <a href="../index.html" title="Home">Home</a> |
      <a href="../products.html" title="Products (MapServer core, MapCache, TinyOWS">Products</a> |
      <a href="https://github.com/mapserver/mapserver/issues/" title="Issue Tracker (MapServer core)">Issue Tracker</a> |
      <a href="../community/service_providers.html" title="Professional Service Providers">Service Providers</a> |      
      <a href="../faq.html" title="Frequently Asked Questions">FAQ</a> |
      <a href="https://twitter.com/mapserver_osgeo" title="Twitter" target="_blank">Twitter</a> |
      <a href="../download.html" title="Download Source or Binaries">Download </a> |
      <a class="badge" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=KRJ2X44N3HA6U&source=url" target="_blank">
        <img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate to MapServer">
      </a>
    </td>
  </tr>
  <tr>
    <td style="padding: 0px 10px 0px 0px; text-align: right; vertical-align: bottom;">
        
          
            <a href="../../tinyows/openlayershowto.html"><img src="../_static/flagicons/en.png" alt="en" title="en" border="0" /></a>
          
        
        
          
            <a href="../../ar/tinyows/openlayershowto.html"><img src="../_static/flagicons/ar.png" alt="ar" title="ar" border="0" /></a>
          
        
        
          
            <a href="../../de/tinyows/openlayershowto.html"><img src="../_static/flagicons/de.png" alt="de" title="de" border="0" /></a>
          
        
        
          
            <a href="../../el/tinyows/openlayershowto.html"><img src="../_static/flagicons/el.png" alt="el" title="el" border="0" /></a>
          
        
        
          
            <a href="../../es/tinyows/openlayershowto.html"><img src="../_static/flagicons/es.png" alt="es" title="es" border="0" /></a>
          
        
        
          
            <a href="../../fr/tinyows/openlayershowto.html"><img src="../_static/flagicons/fr.png" alt="fr" title="fr" border="0" /></a>
          
        
        
          
            <a href="../../id/tinyows/openlayershowto.html"><img src="../_static/flagicons/id.png" alt="id" title="id" border="0" /></a>
          
        
        
          
            <a href="../../it/tinyows/openlayershowto.html"><img src="../_static/flagicons/it.png" alt="it" title="it" border="0" /></a>
          
        
        <img src="../_static/flagicons/ja.png" alt="ja" title="ja" border="0" width="18px" height="13px"/>
        
          
            <a href="../../nl_NL/tinyows/openlayershowto.html"><img src="../_static/flagicons/nl_NL.png" alt="nl_NL" title="nl_NL" border="0" /></a>
          
        
        
          
            <a href="../../pl/tinyows/openlayershowto.html"><img src="../_static/flagicons/pl.png" alt="pl" title="pl" border="0" /></a>
          
        
        
          
            <a href="../../ru/tinyows/openlayershowto.html"><img src="../_static/flagicons/ru.png" alt="ru" title="ru" border="0" /></a>
          
        
        
          
            <a href="../../sq/tinyows/openlayershowto.html"><img src="../_static/flagicons/sq.png" alt="sq" title="sq" border="0" /></a>
          
        
        
          
            <a href="../../tr/tinyows/openlayershowto.html"><img src="../_static/flagicons/tr.png" alt="tr" title="tr" border="0" /></a>
          
        

    </td>
  </tr>
</table>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="servertuning.html" title="Server Tuning: How to speed up your TinyOWS server"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="mapfileconfig.html" title="Configuring TinyOWS with a standard Mapfile"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.6.2 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">TinyOWS</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sample: WFS-T with TinyOWS and OpenLayers</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sample-wfs-t-with-tinyows-and-openlayers">
<span id="tinyows-openlayershowtotransactional"></span><h1>Sample: WFS-T with TinyOWS and OpenLayers<a class="headerlink" href="#sample-wfs-t-with-tinyows-and-openlayers" title="このヘッドラインへのパーマリンク">¶</a></h1>
<ol class="arabic simple" start="0">
<li><p>Install PostGIS and TinyOWS (<a class="reference internal" href="serverinstallation.html#tinyows-serverinstallation"><span class="std std-ref">TinyOWS Installation</span></a>)</p></li>
<li><p>Within PostGIS, create a spatial database called 'tinyows'</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>createdb -U postgres tinyows
psql -U postgres -d tinyows &lt; <span class="sb">`</span>pg_config --sharedir<span class="sb">`</span>/contrib/postgis-2.0/postgis.sql
psql -U postgres -d tinyows &lt; <span class="sb">`</span>pg_config --sharedir<span class="sb">`</span>/contrib/postgis-2.0/spatial_ref_sys.sql
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Import Frida data (we will use the parks layer) into your PostGIS database</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget ftp://ftp.intevation.de/freegis/frida/frida-1.0.1-shp.tar.gz
tar xvzf frida-1.0.1-shp.tar.gz
<span class="nb">cd</span> frida-1.0.1-shp
shp2pgsql -g geom -s <span class="m">31467</span> -W LATIN1 -I gruenflaechen.shp frida <span class="p">|</span> psql -U postgres -d tinyows
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Configure TinyOWS by editing /usr/local/tinyows/config.xml</p></li>
</ol>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;tinyows</span> <span class="na">online_resource=</span><span class="s">&quot;http://127.0.0.1/cgi-bin/tinyows&quot;</span>
         <span class="na">schema_dir=</span><span class="s">&quot;/usr/local/share/tinyows/schema/&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;pg</span> <span class="na">host=</span><span class="s">&quot;127.0.0.1&quot;</span> <span class="na">user=</span><span class="s">&quot;postgres&quot;</span> <span class="na">password=</span><span class="s">&quot;postgres&quot;</span> <span class="na">dbname=</span><span class="s">&quot;tinyows&quot;</span> <span class="na">port=</span><span class="s">&quot;5432&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;metadata</span> <span class="na">name=</span><span class="s">&quot;TinyOWS Server&quot;</span>
          <span class="na">title=</span><span class="s">&quot;TinyOWS Server - WFS-T Frida Service&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;contact</span> <span class="na">name=</span><span class="s">&quot;TinyOWS Server&quot;</span>
         <span class="na">site=</span><span class="s">&quot;http://www.mapserver.org/tinyows/&quot;</span>
         <span class="na">email=</span><span class="s">&quot;tinyows-users@lists.maptools.org&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;layer</span> <span class="na">retrievable=</span><span class="s">&quot;1&quot;</span>
       <span class="na">writable=</span><span class="s">&quot;1&quot;</span>
       <span class="na">ns_prefix=</span><span class="s">&quot;tows&quot;</span>
       <span class="na">ns_uri=</span><span class="s">&quot;http://www.mapserver.org/tinyows/&quot;</span>
       <span class="na">name=</span><span class="s">&quot;frida&quot;</span>
       <span class="na">title=</span><span class="s">&quot;Frida Parks&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/tinyows&gt;</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Test your installations of TinyOWS and PostGIS</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./YOUR_CGI-BIN_PATH/tinyows --check
TinyOWS version:   <span class="m">1</span>.1.0
FCGI support:      Yes
Config File Path:  /etc/tinyows.xml <span class="o">(</span>TinyOWS XML<span class="o">)</span>
PostGIS Version:   <span class="m">2</span>.0.1
PostGIS dsn:       <span class="nv">host</span><span class="o">=</span><span class="m">127</span>.0.0.1 <span class="nv">user</span><span class="o">=</span>postgres <span class="nv">password</span><span class="o">=</span>postgres <span class="nv">dbname</span><span class="o">=</span>tinyows <span class="nv">port</span><span class="o">=</span><span class="m">5432</span>
Output Encoding:   UTF-8
Database Encoding: UTF8
Schema dir:        /usr/local/share/tinyows/schema/
Display bbox:      Yes
Estimated extent:  No
Check schema:      Yes
Check valid geoms: Yes
Available layers:
 - public.frida <span class="o">(</span><span class="m">31467</span><span class="o">)</span> -&gt; tows:frida <span class="o">[</span>RW<span class="o">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Install OpenLayers</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget http://openlayers.org/download/OpenLayers-2.12.tar.gz
tar xvzf OpenLayers-2.12.tar.gz
sudo mv OpenLayers-2.12  /YOUR/SERVER/HTDOCS/
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Install the OpenLayers proxy (you need the Python interpreter to make it work)</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo cp OpenLayers-2.12/examples/proxy.cgi  /YOUR/SERVER/CGI-BIN/
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Add your server IP to proxy allowedHosts in (/YOUR/SERVER/CGI-BIN/proxy.cgi)</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">allowedHosts</span> <span class="o">=</span> <span class="o">[</span><span class="s1">&#39;127.0.0.1&#39;</span>, <span class="s1">&#39;www.openlayers.org&#39;</span>, <span class="s1">&#39;openlayers.org&#39;</span>, ... <span class="o">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li><p>Create a new file at OpenLayers-2.12/examples/tinyows.html</p></li>
</ol>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;../theme/default/style.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;style.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;../lib/OpenLayers.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="p">#</span><span class="nn">map</span> <span class="p">{</span>
          <span class="k">width</span><span class="p">:</span> <span class="mi">800</span><span class="kt">px</span><span class="p">;</span>
          <span class="k">height</span><span class="p">:</span> <span class="mi">500</span><span class="kt">px</span><span class="p">;</span>
          <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
          <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#ccc</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">#</span><span class="nn">message</span> <span class="p">{</span>
          <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
          <span class="k">left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">#</span><span class="nn">docs</span> <span class="p">{</span>
          <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">customEditingToolbar</span> <span class="p">{</span>
          <span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
          <span class="k">right</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
          <span class="k">height</span><span class="p">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
          <span class="k">width</span><span class="p">:</span> <span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">customEditingToolbar</span> <span class="nt">div</span> <span class="p">{</span>
          <span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
          <span class="k">margin</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
          <span class="k">width</span><span class="p">:</span> <span class="mi">24</span><span class="kt">px</span><span class="p">;</span>
          <span class="k">height</span><span class="p">:</span> <span class="mi">24</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlNavigationItemActive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&quot;../theme/default/img/editing_tool_bar.png&quot;</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">-103</span><span class="kt">px</span> <span class="mi">-23</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlNavigationItemInactive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&quot;../theme/default/img/editing_tool_bar.png&quot;</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">-103</span><span class="kt">px</span> <span class="mi">-0</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlDrawFeaturePolygonItemInactive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&quot;../theme/default/img/editing_tool_bar.png&quot;</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">-26</span><span class="kt">px</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlDrawFeaturePolygonItemActive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&quot;../theme/default/img/editing_tool_bar.png&quot;</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">-26</span><span class="kt">px</span> <span class="mi">-23</span><span class="kt">px</span> <span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlModifyFeatureItemActive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="sx">../theme/default/img/move_feature_on.png</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlModifyFeatureItemInactive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="sx">../theme/default/img/move_feature_off.png</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlDeleteFeatureItemActive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="sx">../theme/default/img/remove_point_on.png</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nc">olControlDeleteFeatureItemInactive</span> <span class="p">{</span>
          <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="sx">../theme/default/img/remove_point_off.png</span><span class="p">);</span>
          <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
          <span class="k">background-position</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;tinyows.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span> <span class="na">onload</span><span class="o">=</span><span class="s">&quot;init()&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;title&quot;</span><span class="p">&gt;</span>WFS Transaction Example, (TinyOWS ans OpenLayers)<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;tags&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;shortdesc&quot;</span><span class="p">&gt;</span>
          Shows the use of the WFS Transactions (WFS-T).
          Parks of Osnabruck (Frida).
      <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
          Base layers is OpenStreetMap from Omniscale WMS Server.
      <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;message&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;docs&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
              The WFS protocol allows for creation of new features and
              reading, updating, or deleting of existing features.
          <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
              Use the tools to create, modify, and delete (in order from left
              to right) features. Use the save tool (picture of a disk) to
              save your changes. Use the navigation tool (hand) to stop
              editing and use the mouse for map navigation.
          <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
              See the <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;tinyows.js&quot;</span> <span class="na">target</span><span class="o">=</span><span class="s">&quot;_blank&quot;</span><span class="p">&gt;</span>
              wfs-protocol-transactions.js source<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> to see how this is done.
          <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<ol class="arabic simple" start="9">
<li><p>Create a new file at OpenLayers-2.12/examples/tinyows.js (and replace all 127.0.0.1 addresses by your IP server if necessary)</p></li>
</ol>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">map</span><span class="p">,</span> <span class="nx">wfs</span><span class="p">;</span>
<span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">ProxyHost</span> <span class="o">=</span> <span class="s2">&quot;/cgi-bin/proxy.cgi?url=&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">DeleteFeature</span> <span class="o">=</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Class</span><span class="p">(</span><span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">layer</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">options</span><span class="p">]);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">layer</span> <span class="o">=</span> <span class="nx">layer</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Handler</span><span class="p">.</span><span class="nx">Feature</span><span class="p">(</span>
          <span class="k">this</span><span class="p">,</span> <span class="nx">layer</span><span class="p">,</span> <span class="p">{</span><span class="nx">click</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">clickFeature</span><span class="p">}</span>
      <span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">clickFeature</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// if feature doesn&#39;t have a fid, destroy it</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">fid</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">destroyFeatures</span><span class="p">([</span><span class="nx">feature</span><span class="p">]);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">feature</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">State</span><span class="p">.</span><span class="nx">DELETE</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">triggerEvent</span><span class="p">(</span><span class="s2">&quot;afterfeaturemodified&quot;</span><span class="p">,</span>
                                         <span class="p">{</span><span class="nx">feature</span><span class="o">:</span> <span class="nx">feature</span><span class="p">});</span>
          <span class="nx">feature</span><span class="p">.</span><span class="nx">renderIntent</span> <span class="o">=</span> <span class="s2">&quot;select&quot;</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">drawFeature</span><span class="p">(</span><span class="nx">feature</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">setMap</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">handler</span><span class="p">.</span><span class="nx">setMap</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
      <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setMap</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">CLASS_NAME</span><span class="o">:</span> <span class="s2">&quot;OpenLayers.Control.DeleteFeature&quot;</span>
<span class="p">});</span>
<span class="kd">function</span> <span class="nx">showMsg</span><span class="p">(</span><span class="nx">szMessage</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">szMessage</span><span class="p">;</span>
  <span class="nx">setTimeout</span><span class="p">(</span>
      <span class="s2">&quot;document.getElementById(&#39;message&#39;).innerHTML = &#39;&#39;&quot;</span><span class="p">,</span><span class="mf">2000</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">showSuccessMsg</span><span class="p">(){</span>
  <span class="nx">showMsg</span><span class="p">(</span><span class="s2">&quot;Transaction successfully completed&quot;</span><span class="p">);</span>
<span class="p">};</span>
<span class="kd">function</span> <span class="nx">showFailureMsg</span><span class="p">(){</span>
  <span class="nx">showMsg</span><span class="p">(</span><span class="s2">&quot;An error occurred while operating the transaction&quot;</span><span class="p">);</span>
<span class="p">};</span>
<span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Map</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">projection</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:31467&quot;</span><span class="p">),</span>
      <span class="nx">units</span><span class="o">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
      <span class="nx">maxResolution</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
      <span class="nx">maxExtent</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Bounds</span><span class="p">(</span><span class="mf">3427000</span><span class="p">,</span><span class="mf">5788000</span><span class="p">,</span><span class="mf">3444000</span><span class="p">,</span><span class="mf">5800000</span><span class="p">),</span>
      <span class="nx">controls</span><span class="o">:</span> <span class="p">[</span>
          <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">PanZoom</span><span class="p">()</span>
      <span class="p">]</span>
  <span class="p">});</span>
  <span class="kd">var</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">WMS</span><span class="p">(</span>
      <span class="s2">&quot;OSM by Omniscale WMS&quot;</span><span class="p">,</span>
      <span class="s2">&quot;http://osm.omniscale.net/proxy/service&quot;</span><span class="p">,</span>
      <span class="p">{</span><span class="nx">layers</span><span class="o">:</span> <span class="s1">&#39;osm&#39;</span><span class="p">,</span> <span class="nx">format</span><span class="o">:</span> <span class="s1">&#39;image/jpeg&#39;</span><span class="p">},</span>
      <span class="p">{</span><span class="nx">projection</span><span class="o">:</span><span class="s2">&quot;EPSG:31467&quot;</span><span class="p">,</span>  <span class="nx">units</span><span class="o">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="nx">maxResolution</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="nx">maxExtent</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Bounds</span><span class="p">(</span><span class="mf">3427000</span><span class="p">,</span><span class="mf">5788000</span><span class="p">,</span><span class="mf">3444000</span><span class="p">,</span><span class="mf">5800000</span><span class="p">)}</span>
  <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">saveStrategy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Strategy</span><span class="p">.</span><span class="nx">Save</span><span class="p">();</span>
  <span class="nx">saveStrategy</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">showSuccessMsg</span><span class="p">);</span>
  <span class="nx">saveStrategy</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s2">&quot;fail&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">showFailureMsg</span><span class="p">);</span>
  <span class="nx">wfs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span><span class="s2">&quot;Editable Features&quot;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">strategies</span><span class="o">:</span> <span class="p">[</span><span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Strategy</span><span class="p">.</span><span class="nx">BBOX</span><span class="p">(),</span> <span class="nx">saveStrategy</span><span class="p">],</span>
      <span class="nx">projection</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:31467&quot;</span><span class="p">),</span>
      <span class="nx">protocol</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Protocol</span><span class="p">.</span><span class="nx">WFS</span><span class="p">({</span>
          <span class="nx">version</span><span class="o">:</span> <span class="s2">&quot;1.1.0&quot;</span><span class="p">,</span>
          <span class="nx">srsName</span><span class="o">:</span> <span class="s2">&quot;EPSG:31467&quot;</span><span class="p">,</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://127.0.0.1/cgi-bin/tinyows&quot;</span><span class="p">,</span>
          <span class="nx">featureNS</span> <span class="o">:</span>  <span class="s2">&quot;http://www.mapserver.org/tinyows/&quot;</span><span class="p">,</span>
          <span class="nx">featureType</span><span class="o">:</span> <span class="s2">&quot;frida&quot;</span><span class="p">,</span>
          <span class="nx">geometryName</span><span class="o">:</span> <span class="s2">&quot;geom&quot;</span><span class="p">,</span>
          <span class="nx">schema</span><span class="o">:</span> <span class="s2">&quot;http://127.0.0.1/cgi-bin/tinyows?service=wfs&amp;request=DescribeFeatureType&amp;version=1.1.0&amp;typename=tows:frida&quot;</span>
      <span class="p">})</span>
  <span class="p">});</span>
  <span class="nx">map</span><span class="p">.</span><span class="nx">addLayers</span><span class="p">([</span><span class="nx">osm</span><span class="p">,</span> <span class="nx">wfs</span><span class="p">]);</span>
  <span class="kd">var</span> <span class="nx">panel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">Panel</span><span class="p">(</span>
      <span class="p">{</span><span class="s1">&#39;displayClass&#39;</span><span class="o">:</span> <span class="s1">&#39;customEditingToolbar&#39;</span><span class="p">}</span>
  <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">navigate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">Navigation</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Pan Map&quot;</span>
  <span class="p">});</span>
  <span class="kd">var</span> <span class="nx">draw</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">DrawFeature</span><span class="p">(</span>
      <span class="nx">wfs</span><span class="p">,</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Handler</span><span class="p">.</span><span class="nx">Polygon</span><span class="p">,</span>
      <span class="p">{</span>
          <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Draw Feature&quot;</span><span class="p">,</span>
          <span class="nx">displayClass</span><span class="o">:</span> <span class="s2">&quot;olControlDrawFeaturePolygon&quot;</span><span class="p">,</span>
          <span class="nx">multi</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">}</span>
  <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">edit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">ModifyFeature</span><span class="p">(</span><span class="nx">wfs</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Modify Feature&quot;</span><span class="p">,</span>
      <span class="nx">displayClass</span><span class="o">:</span> <span class="s2">&quot;olControlModifyFeature&quot;</span>
  <span class="p">});</span>
  <span class="kd">var</span> <span class="nx">del</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DeleteFeature</span><span class="p">(</span><span class="nx">wfs</span><span class="p">,</span> <span class="p">{</span><span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Delete Feature&quot;</span><span class="p">});</span>
  <span class="kd">var</span> <span class="nx">save</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Save Changes&quot;</span><span class="p">,</span>
      <span class="nx">trigger</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">edit</span><span class="p">.</span><span class="nx">feature</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">edit</span><span class="p">.</span><span class="nx">selectControl</span><span class="p">.</span><span class="nx">unselectAll</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="nx">saveStrategy</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
      <span class="p">},</span>
      <span class="nx">displayClass</span><span class="o">:</span> <span class="s2">&quot;olControlSaveFeatures&quot;</span>
  <span class="p">});</span>
  <span class="nx">panel</span><span class="p">.</span><span class="nx">addControls</span><span class="p">([</span><span class="nx">navigate</span><span class="p">,</span> <span class="nx">save</span><span class="p">,</span> <span class="nx">del</span><span class="p">,</span> <span class="nx">edit</span><span class="p">,</span> <span class="nx">draw</span><span class="p">]);</span>
  <span class="nx">panel</span><span class="p">.</span><span class="nx">defaultControl</span> <span class="o">=</span> <span class="nx">navigate</span><span class="p">;</span>
  <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="nx">panel</span><span class="p">);</span>
  <span class="nx">map</span><span class="p">.</span><span class="nx">zoomToMaxExtent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>Navigation</h3>
<p>
<a href="../about.html" title="About">About</a><br>
<a href="../products.html" title="Products">Products</a><br>
<a href="../community/index.html" title="Community">Community</a><br>
<a href="../development/index.html" title="Development">Development</a><br>
<a href="../download.html" title="Downloads">Downloads</a><br>
<a href="../documentation.html" title="Documentation">Documentation</a><br>
<a href="../faq.html" title="FAQ">FAQ</a><br>
<a href="../psc.html" title="PSC">PSC</a><br>
<a href="https://twitter.com/mapserver_osgeo" title="Twitter">Twitter</a>
</p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="servertuning.html" title="Server Tuning: How to speed up your TinyOWS server"
             >次へ</a> |</li>
        <li class="right" >
          <a href="mapfileconfig.html" title="Configuring TinyOWS with a standard Mapfile"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../documentation.html" >MapServer 7.6.2 Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >TinyOWS</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Sample: WFS-T with TinyOWS and OpenLayers</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2021, Open Source Geospatial Foundation.
      最終更新: 2021-04-14
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>
  </body>
</html>